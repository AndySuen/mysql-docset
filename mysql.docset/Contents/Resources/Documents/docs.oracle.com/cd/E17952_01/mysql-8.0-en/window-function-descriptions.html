<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><a class="dashingAutolink" name="autolink-4558"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/12.20.1%C2%A0Window%20Function%20Descriptions"></a><title>12.20.1&nbsp;Window Function Descriptions</title><link rel="stylesheet" type="text/css" href="mvl-otn.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/><link rel="home" href="performance-schema" title="MySQL 8.0 Reference Manual"/><link rel="up" href="window-functions.html" title="12.20&nbsp;Window Functions"/><link rel="prev" href="window-functions.html" title="12.20&nbsp;Window Functions"/><link rel="next" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax"/><script>window.ohcglobal || document.write('<script src="../../../en/dcommon/js/global.js">\x3C/script>')</script></head><body><div class="skip-link"><a href="window-function-descriptions.html#window-function-descriptions">Skip to Main Content</a></div><div class="DocTitle"><p>MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0</p></div><div class="navigation"><ul><li class="navLinkPrevious"><a accesskey="p" title="Go To Previous Page&nbsp;[access key: p]" href="window-functions.html">Previous <span class="navHint"> Window Functions </span></a></li><li class="navLinkHome"><a accesskey="h" title="Go To Home Page&nbsp;[access key: h]" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a accesskey="u" title="Go Up A Level In The Navigation&nbsp;[access key: u]" href="window-functions.html">Up <span class="navHint"> Window Functions </span></a></li><li class="navLinkNext"><a accesskey="n" title="Go To Next Page&nbsp;[access key: n]" href="window-functions-usage.html">Next <span class="navHint"> Window Function Concepts and Syntax </span></a></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="window-function-descriptions"></a>12.20.1&nbsp;Window Function Descriptions</h3></div></div></div><p>
        This section describes nonaggregate window functions that, for
        each row from a query, perform a calculation using rows related
        to that row. Most aggregate functions also can be used as window
        functions; see <a class="xref" href="aggregate-functions.html" title="12.19.1&nbsp;Aggregate Function Descriptions">Section&nbsp;12.19.1, &ldquo;Aggregate Function Descriptions&rdquo;</a>.
      </p><p>
        For window function usage information and examples, and
        definitions of terms such as the <code class="literal">OVER</code> clause,
        window, partition, frame, and peer, see
        <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
      </p><div class="table"><a id="idm45828919069504"></a><p class="title"><strong>Table&nbsp;12.26&nbsp;Window Functions</strong></p><div class="table-contents"><table frame="box" rules="all" summary="A reference that lists window functions."><colgroup><col style="width: 28%"/><col style="width: 71%"/></colgroup><thead><tr><th>Name</th>
<th>Description</th>
</tr></thead><tbody><tr><td><a class="link" href="window-function-descriptions.html#function_cume-dist"><code class="literal">CUME_DIST()</code></a></td>
<td>
      Cumulative distribution value
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a></td>
<td>
      Rank of current row within its partition, without gaps
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a></td>
<td>
      Value of argument from first row of window frame
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_lag"><code class="literal">LAG()</code></a></td>
<td>
      Value of argument from row lagging current row within partition
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_last-value"><code class="literal">LAST_VALUE()</code></a></td>
<td>
      Value of argument from last row of window frame
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_lead"><code class="literal">LEAD()</code></a></td>
<td>
      Value of argument from row leading current row within partition
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a></td>
<td>
      Value of argument from N-th row of window frame
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_ntile"><code class="literal">NTILE()</code></a></td>
<td>
      Bucket number of current row within its partition.
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_percent-rank"><code class="literal">PERCENT_RANK()</code></a></td>
<td>
      Percentage rank value
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_rank"><code class="literal">RANK()</code></a></td>
<td>
      Rank of current row within its partition, with gaps
    </td>
</tr><tr><td><a class="link" href="window-function-descriptions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a></td>
<td>
      Number of current row within its partition
    </td>
</tr></tbody></table></div></div><br class="table-break"/><p>
        In the following function descriptions,
        <em class="replaceable"><code>over_clause</code></em> represents the
        <code class="literal">OVER</code> clause, described in
        <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>. Some window functions
        permit a <em class="replaceable"><code>null_treatment</code></em> clause that
        specifies how to handle <code class="literal">NULL</code> values when
        calculating results. This clause is optional. It is part of the
        SQL standard, but the MySQL implementation permits only
        <code class="literal">RESPECT NULLS</code> (which is also the default).
        This means that <code class="literal">NULL</code> values are considered
        when calculating results. <code class="literal">IGNORE NULLS</code> is
        parsed, but produces an error.
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a id="function_cume-dist"></a><p>
            <a class="link" href="window-function-descriptions.html#function_cume-dist"><code class="literal">CUME_DIST()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828919018736" class="indexterm"></a><p>
            Returns the cumulative distribution of a value within a
            group of values; that is, the percentage of partition values
            less than or equal to the value in the current row. This
            represents the number of rows preceding or peer with the
            current row in the window ordering of the window partition
            divided by the total number of rows in the window partition.
            Return values range from 0 to 1.
          </p><p>
            This function should be used with <code class="literal">ORDER
            BY</code> to sort partition rows into the desired order.
            Without <code class="literal">ORDER BY</code>, all rows are peers and
            have value
            <em class="replaceable"><code>N</code></em>/<em class="replaceable"><code>N</code></em> =
            1, where <em class="replaceable"><code>N</code></em> is the partition size.
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
          </p><p>
            The following query shows, for the set of values in the
            <code class="literal">val</code> column, the
            <code class="literal">CUME_DIST()</code> value for each row, as well
            as the percentage rank value returned by the similar
            <code class="literal">PERCENT_RANK()</code> function. For reference,
            the query also displays row numbers using
            <a class="link" href="window-function-descriptions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a>:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>val,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER()   OVER w AS &#39;row_number&#39;,</code></strong>
         <strong class="userinput"><code>CUME_DIST()    OVER w AS &#39;cume_dist&#39;,</code></strong>
         <strong class="userinput"><code>PERCENT_RANK() OVER w AS &#39;percent_rank&#39;</code></strong>
       <strong class="userinput"><code>FROM numbers</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY val);</code></strong>
+------+------------+--------------------+--------------+
| val  | row_number | cume_dist          | percent_rank |
+------+------------+--------------------+--------------+
|    1 |          1 | 0.2222222222222222 |            0 |
|    1 |          2 | 0.2222222222222222 |            0 |
|    2 |          3 | 0.3333333333333333 |         0.25 |
|    3 |          4 | 0.6666666666666666 |        0.375 |
|    3 |          5 | 0.6666666666666666 |        0.375 |
|    3 |          6 | 0.6666666666666666 |        0.375 |
|    4 |          7 | 0.8888888888888888 |         0.75 |
|    4 |          8 | 0.8888888888888888 |         0.75 |
|    5 |          9 |                  1 |            1 |
+------+------------+--------------------+--------------+
</pre></li><li class="listitem"><a id="function_dense-rank"></a><p>
            <a class="link" href="window-function-descriptions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918995760" class="indexterm"></a><p>
            Returns the rank of the current row within its partition,
            without gaps. Peers are considered ties and receive the same
            rank. This function assigns consecutive ranks to peer
            groups; the result is that groups of size greater than one
            do not produce noncontiguous rank numbers. For an example,
            see the <a class="link" href="window-function-descriptions.html#function_rank"><code class="literal">RANK()</code></a> function
            description.
          </p><p>
            This function should be used with <code class="literal">ORDER
            BY</code> to sort partition rows into the desired order.
            Without <code class="literal">ORDER BY</code>, all rows are peers.
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
          </p></li><li class="listitem"><a id="function_first-value"></a><p>
            <a class="link" href="window-function-descriptions.html#function_first-value"><code class="literal">FIRST_VALUE(<em class="replaceable"><code>expr</code></em>)</code></a>
            [<em class="replaceable"><code>null_treatment</code></em>]
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918982528" class="indexterm"></a><p>
            Returns the value of <em class="replaceable"><code>expr</code></em> from
            the first row of the window frame.
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
            <em class="replaceable"><code>null_treatment</code></em> is as described in
            the section introduction.
          </p><p>
            The following query demonstrates
            <a class="link" href="window-function-descriptions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a>,
            <a class="link" href="window-function-descriptions.html#function_last-value"><code class="literal">LAST_VALUE()</code></a>, and two
            instances of <a class="link" href="window-function-descriptions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a>:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>time, subject, val,</code></strong>
         <strong class="userinput"><code>FIRST_VALUE(val)  OVER w AS &#39;first&#39;,</code></strong>
         <strong class="userinput"><code>LAST_VALUE(val)   OVER w AS &#39;last&#39;,</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 2) OVER w AS &#39;second&#39;,</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 4) OVER w AS &#39;fourth&#39;</code></strong>
       <strong class="userinput"><code>FROM observations</code></strong>
       <strong class="userinput"><code>WINDOW w AS (PARTITION BY subject ORDER BY time</code></strong>
                    <strong class="userinput"><code>ROWS UNBOUNDED PRECEDING);</code></strong>
+----------+---------+------+-------+------+--------+--------+
| time     | subject | val  | first | last | second | fourth |
+----------+---------+------+-------+------+--------+--------+
| 07:00:00 | st113   |   10 |    10 |   10 |   NULL |   NULL |
| 07:15:00 | st113   |    9 |    10 |    9 |      9 |   NULL |
| 07:30:00 | st113   |   25 |    10 |   25 |      9 |   NULL |
| 07:45:00 | st113   |   20 |    10 |   20 |      9 |     20 |
| 07:00:00 | xh458   |    0 |     0 |    0 |   NULL |   NULL |
| 07:15:00 | xh458   |   10 |     0 |   10 |     10 |   NULL |
| 07:30:00 | xh458   |    5 |     0 |    5 |     10 |   NULL |
| 07:45:00 | xh458   |   30 |     0 |   30 |     10 |     30 |
| 08:00:00 | xh458   |   25 |     0 |   25 |     10 |     30 |
+----------+---------+------+-------+------+--------+--------+
</pre><p>
            Each function uses the rows in the current frame, which, per
            the window definition shown, extends from the first
            partition row to the current row. For the
            <a class="link" href="window-function-descriptions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a> calls, the
            current frame does not always include the requested row; in
            such cases, the return value is <code class="literal">NULL</code>.
          </p></li><li class="listitem"><a id="function_lag"></a><p>
            <a class="link" href="window-function-descriptions.html#function_lag"><code class="literal">LAG(<em class="replaceable"><code>expr</code></em> [,
            <em class="replaceable"><code>N</code></em>[,
            <em class="replaceable"><code>default</code></em>]])</code></a>
            [<em class="replaceable"><code>null_treatment</code></em>]
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918955536" class="indexterm"></a><p>
            Returns the value of <em class="replaceable"><code>expr</code></em> from
            the row that lags (precedes) the current row by
            <em class="replaceable"><code>N</code></em> rows within its partition. If
            there is no such row, the return value is
            <em class="replaceable"><code>default</code></em>. For example, if
            <em class="replaceable"><code>N</code></em> is 3, the return value is
            <em class="replaceable"><code>default</code></em> for the first three rows.
            If <em class="replaceable"><code>N</code></em> or
            <em class="replaceable"><code>default</code></em> are missing, the defaults
            are 1 and <code class="literal">NULL</code>, respectively.
          </p><p>
            <em class="replaceable"><code>N</code></em> must be a literal nonnegative
            integer. If <em class="replaceable"><code>N</code></em> is 0,
            <em class="replaceable"><code>expr</code></em> is evaluated for the current
            row.
          </p><p>
            Beginning with MySQL 8.0.22, <em class="replaceable"><code>N</code></em>
            cannot be <code class="literal">NULL</code>. In addition, it must now
            be an integer in the range <code class="literal">1</code> to
            <code class="literal">2<sup>63</sup></code>,
            inclusive, in any of the following forms:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                an unsigned integer constant literal
              </p></li><li class="listitem"><p>
                a positional parameter marker (<code class="literal">?</code>)
              </p></li><li class="listitem"><p>
                a user-defined variable
              </p></li><li class="listitem"><p>
                a local variable in a stored routine
              </p></li></ul></div><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
            <em class="replaceable"><code>null_treatment</code></em> is as described in
            the section introduction.
          </p><p>
            <a class="link" href="window-function-descriptions.html#function_lag"><code class="literal">LAG()</code></a> (and the similar
            <a class="link" href="window-function-descriptions.html#function_lead"><code class="literal">LEAD()</code></a> function) are often
            used to compute differences between rows. The following
            query shows a set of time-ordered observations and, for each
            one, the <a class="link" href="window-function-descriptions.html#function_lag"><code class="literal">LAG()</code></a> and
            <a class="link" href="window-function-descriptions.html#function_lead"><code class="literal">LEAD()</code></a> values from the
            adjoining rows, as well as the differences between the
            current and adjoining rows:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>t, val,</code></strong>
         <strong class="userinput"><code>LAG(val)        OVER w AS &#39;lag&#39;,</code></strong>
         <strong class="userinput"><code>LEAD(val)       OVER w AS &#39;lead&#39;,</code></strong>
         <strong class="userinput"><code>val - LAG(val)  OVER w AS &#39;lag diff&#39;,</code></strong>
         <strong class="userinput"><code>val - LEAD(val) OVER w AS &#39;lead diff&#39;</code></strong>
       <strong class="userinput"><code>FROM series</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY t);</code></strong>
+----------+------+------+------+----------+-----------+
| t        | val  | lag  | lead | lag diff | lead diff |
+----------+------+------+------+----------+-----------+
| 12:00:00 |  100 | NULL |  125 |     NULL |       -25 |
| 13:00:00 |  125 |  100 |  132 |       25 |        -7 |
| 14:00:00 |  132 |  125 |  145 |        7 |       -13 |
| 15:00:00 |  145 |  132 |  140 |       13 |         5 |
| 16:00:00 |  140 |  145 |  150 |       -5 |       -10 |
| 17:00:00 |  150 |  140 |  200 |       10 |       -50 |
| 18:00:00 |  200 |  150 | NULL |       50 |      NULL |
+----------+------+------+------+----------+-----------+
</pre><p>
            In the example, the <a class="link" href="window-function-descriptions.html#function_lag"><code class="literal">LAG()</code></a> and
            <a class="link" href="window-function-descriptions.html#function_lead"><code class="literal">LEAD()</code></a> calls use the default
            <em class="replaceable"><code>N</code></em> and
            <em class="replaceable"><code>default</code></em> values of 1 and
            <code class="literal">NULL</code>, respectively.
          </p><p>
            The first row shows what happens when there is no previous
            row for <a class="link" href="window-function-descriptions.html#function_lag"><code class="literal">LAG()</code></a>: The function
            returns the <em class="replaceable"><code>default</code></em> value (in
            this case, <code class="literal">NULL</code>). The last row shows the
            same thing when there is no next row for
            <a class="link" href="window-function-descriptions.html#function_lead"><code class="literal">LEAD()</code></a>.
          </p><p>
            <a class="link" href="window-function-descriptions.html#function_lag"><code class="literal">LAG()</code></a> and
            <a class="link" href="window-function-descriptions.html#function_lead"><code class="literal">LEAD()</code></a> also serve to compute
            sums rather than differences. Consider this data set, which
            contains the first few numbers of the Fibonacci series:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT n FROM fib ORDER BY n;</code></strong>
+------+
| n    |
+------+
|    1 |
|    1 |
|    2 |
|    3 |
|    5 |
|    8 |
+------+
</pre><p>
            The following query shows the
            <a class="link" href="window-function-descriptions.html#function_lag"><code class="literal">LAG()</code></a> and
            <a class="link" href="window-function-descriptions.html#function_lead"><code class="literal">LEAD()</code></a> values for the rows
            adjacent to the current row. It also uses those functions to
            add to the current row value the values from the preceding
            and following rows. The effect is to generate the next
            number in the Fibonacci series, and the next number after
            that:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>n,</code></strong>
         <strong class="userinput"><code>LAG(n, 1, 0)      OVER w AS &#39;lag&#39;,</code></strong>
         <strong class="userinput"><code>LEAD(n, 1, 0)     OVER w AS &#39;lead&#39;,</code></strong>
         <strong class="userinput"><code>n + LAG(n, 1, 0)  OVER w AS &#39;next_n&#39;,</code></strong>
         <strong class="userinput"><code>n + LEAD(n, 1, 0) OVER w AS &#39;next_next_n&#39;</code></strong>
       <strong class="userinput"><code>FROM fib</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY n);</code></strong>
+------+------+------+--------+-------------+
| n    | lag  | lead | next_n | next_next_n |
+------+------+------+--------+-------------+
|    1 |    0 |    1 |      1 |           2 |
|    1 |    1 |    2 |      2 |           3 |
|    2 |    1 |    3 |      3 |           5 |
|    3 |    2 |    5 |      5 |           8 |
|    5 |    3 |    8 |      8 |          13 |
|    8 |    5 |    0 |     13 |           8 |
+------+------+------+--------+-------------+
</pre><p>
            One way to generate the initial set of Fibonacci numbers is
            to use a recursive common table expression. For an example,
            see
            <a class="xref" href="with.html#common-table-expressions-recursive-fibonacci-series" title="Fibonacci Series Generation">Fibonacci Series Generation</a>.
          </p><p>
            Beginning with MySQL 8.0.22, you cannot use a negative value
            for the rows argument of this function.
          </p></li><li class="listitem"><a id="function_last-value"></a><p>
            <a class="link" href="window-function-descriptions.html#function_last-value"><code class="literal">LAST_VALUE(<em class="replaceable"><code>expr</code></em>)</code></a>
            [<em class="replaceable"><code>null_treatment</code></em>]
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918892688" class="indexterm"></a><p>
            Returns the value of <em class="replaceable"><code>expr</code></em> from
            the last row of the window frame.
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
            <em class="replaceable"><code>null_treatment</code></em> is as described in
            the section introduction.
          </p><p>
            For an example, see the
            <a class="link" href="window-function-descriptions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a> function
            description.
          </p></li><li class="listitem"><a id="function_lead"></a><p>
            <a class="link" href="window-function-descriptions.html#function_lead"><code class="literal">LEAD(<em class="replaceable"><code>expr</code></em> [,
            <em class="replaceable"><code>N</code></em>[,
            <em class="replaceable"><code>default</code></em>]])</code></a>
            [<em class="replaceable"><code>null_treatment</code></em>]
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918879824" class="indexterm"></a><p>
            Returns the value of <em class="replaceable"><code>expr</code></em> from
            the row that leads (follows) the current row by
            <em class="replaceable"><code>N</code></em> rows within its partition. If
            there is no such row, the return value is
            <em class="replaceable"><code>default</code></em>. For example, if
            <em class="replaceable"><code>N</code></em> is 3, the return value is
            <em class="replaceable"><code>default</code></em> for the last three rows.
            If <em class="replaceable"><code>N</code></em> or
            <em class="replaceable"><code>default</code></em> are missing, the defaults
            are 1 and <code class="literal">NULL</code>, respectively.
          </p><p>
            <em class="replaceable"><code>N</code></em> must be a literal nonnegative
            integer. If <em class="replaceable"><code>N</code></em> is 0,
            <em class="replaceable"><code>expr</code></em> is evaluated for the current
            row.
          </p><p>
            Beginning with MySQL 8.0.22, <em class="replaceable"><code>N</code></em>
            cannot be <code class="literal">NULL</code>. In addition, it must now
            be an integer in the range <code class="literal">1</code> to
            <code class="literal">2<sup>63</sup></code>,
            inclusive, in any of the following forms:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                an unsigned integer constant literal
              </p></li><li class="listitem"><p>
                a positional parameter marker (<code class="literal">?</code>)
              </p></li><li class="listitem"><p>
                a user-defined variable
              </p></li><li class="listitem"><p>
                a local variable in a stored routine
              </p></li></ul></div><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
            <em class="replaceable"><code>null_treatment</code></em> is as described in
            the section introduction.
          </p><p>
            For an example, see the <a class="link" href="window-function-descriptions.html#function_lag"><code class="literal">LAG()</code></a>
            function description.
          </p><p>
            In MySQL 8.0.22 and later, use of a negative value for the
            rows argument of this function is not permitted.
          </p></li><li class="listitem"><a id="function_nth-value"></a><p>
            <a class="link" href="window-function-descriptions.html#function_nth-value"><code class="literal">NTH_VALUE(<em class="replaceable"><code>expr</code></em>,
            <em class="replaceable"><code>N</code></em>)</code></a>
            [<em class="replaceable"><code>from_first_last</code></em>]
            [<em class="replaceable"><code>null_treatment</code></em>]
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918853424" class="indexterm"></a><p>
            Returns the value of <em class="replaceable"><code>expr</code></em> from
            the <em class="replaceable"><code>N</code></em>-th row of the window frame.
            If there is no such row, the return value is
            <code class="literal">NULL</code>.
          </p><p>
            <em class="replaceable"><code>N</code></em> must be a literal positive
            integer.
          </p><p>
            <em class="replaceable"><code>from_first_last</code></em> is part of the
            SQL standard, but the MySQL implementation permits only
            <code class="literal">FROM FIRST</code> (which is also the default).
            This means that calculations begin at the first row of the
            window. <code class="literal">FROM LAST</code> is parsed, but produces
            an error. To obtain the same effect as <code class="literal">FROM
            LAST</code> (begin calculations at the last row of the
            window), use <code class="literal">ORDER BY</code> to sort in reverse
            order.
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
            <em class="replaceable"><code>null_treatment</code></em> is as described in
            the section introduction.
          </p><p>
            For an example, see the
            <a class="link" href="window-function-descriptions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a> function
            description.
          </p><p>
            In MySQL 8.0.22 and later, you cannot use
            <code class="literal">NULL</code> for the row argument of this
            function.
          </p></li><li class="listitem"><a id="function_ntile"></a><p>
            <a class="link" href="window-function-descriptions.html#function_ntile"><code class="literal">NTILE(<em class="replaceable"><code>N</code></em>)</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918834704" class="indexterm"></a><p>
            Divides a partition into <em class="replaceable"><code>N</code></em> groups
            (buckets), assigns each row in the partition its bucket
            number, and returns the bucket number of the current row
            within its partition. For example, if
            <em class="replaceable"><code>N</code></em> is 4,
            <code class="literal">NTILE()</code> divides rows into four buckets.
            If <em class="replaceable"><code>N</code></em> is 100,
            <code class="literal">NTILE()</code> divides rows into 100 buckets.
          </p><p>
            <em class="replaceable"><code>N</code></em> must be a literal positive
            integer. Bucket number return values range from 1 to
            <em class="replaceable"><code>N</code></em>.
          </p><p>
            Beginning with MySQL 8.0.22, <em class="replaceable"><code>N</code></em>
            cannot be <code class="literal">NULL</code>. In addition, it must be
            an integer in the range <code class="literal">1</code> to
            <code class="literal">2<sup>63</sup></code>,
            inclusive, in any of the following forms:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                an unsigned integer constant literal
              </p></li><li class="listitem"><p>
                a positional parameter marker (<code class="literal">?</code>)
              </p></li><li class="listitem"><p>
                a user-defined variable
              </p></li><li class="listitem"><p>
                a local variable in a stored routine
              </p></li></ul></div><p>
            This function should be used with <code class="literal">ORDER
            BY</code> to sort partition rows into the desired order.
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
          </p><p>
            The following query shows, for the set of values in the
            <code class="literal">val</code> column, the percentile values
            resulting from dividing the rows into two or four groups.
            For reference, the query also displays row numbers using
            <a class="link" href="window-function-descriptions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a>:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>val,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER w AS &#39;row_number&#39;,</code></strong>
         <strong class="userinput"><code>NTILE(2)     OVER w AS &#39;ntile2&#39;,</code></strong>
         <strong class="userinput"><code>NTILE(4)     OVER w AS &#39;ntile4&#39;</code></strong>
       <strong class="userinput"><code>FROM numbers</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY val);</code></strong>
+------+------------+--------+--------+
| val  | row_number | ntile2 | ntile4 |
+------+------------+--------+--------+
|    1 |          1 |      1 |      1 |
|    1 |          2 |      1 |      1 |
|    2 |          3 |      1 |      1 |
|    3 |          4 |      1 |      2 |
|    3 |          5 |      1 |      2 |
|    3 |          6 |      2 |      3 |
|    4 |          7 |      2 |      3 |
|    4 |          8 |      2 |      4 |
|    5 |          9 |      2 |      4 |
+------+------------+--------+--------+
</pre><p>
            Beginning with MySQL 8.0.22, the construct
            <code class="literal">NTILE(NULL)</code> is no longer permitted.
          </p></li><li class="listitem"><a id="function_percent-rank"></a><p>
            <a class="link" href="window-function-descriptions.html#function_percent-rank"><code class="literal">PERCENT_RANK()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918801984" class="indexterm"></a><p>
            Returns the percentage of partition values less than the
            value in the current row, excluding the highest value.
            Return values range from 0 to 1 and represent the row
            relative rank, calculated as the result of this formula,
            where <em class="replaceable"><code>rank</code></em> is the row rank and
            <em class="replaceable"><code>rows</code></em> is the number of partition
            rows:
          </p><pre class="programlisting">(<em class="replaceable"><code>rank</code></em> - 1) / (<em class="replaceable"><code>rows</code></em> - 1)
</pre><p>
            This function should be used with <code class="literal">ORDER
            BY</code> to sort partition rows into the desired order.
            Without <code class="literal">ORDER BY</code>, all rows are peers.
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
          </p><p>
            For an example, see the
            <a class="link" href="window-function-descriptions.html#function_cume-dist"><code class="literal">CUME_DIST()</code></a> function
            description.
          </p></li><li class="listitem"><a id="function_rank"></a><p>
            <a class="link" href="window-function-descriptions.html#function_rank"><code class="literal">RANK()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918786880" class="indexterm"></a><p>
            Returns the rank of the current row within its partition,
            with gaps. Peers are considered ties and receive the same
            rank. This function does not assign consecutive ranks to
            peer groups if groups of size greater than one exist; the
            result is noncontiguous rank numbers.
          </p><p>
            This function should be used with <code class="literal">ORDER
            BY</code> to sort partition rows into the desired order.
            Without <code class="literal">ORDER BY</code>, all rows are peers.
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
          </p><p>
            The following query shows the difference between
            <a class="link" href="window-function-descriptions.html#function_rank"><code class="literal">RANK()</code></a>, which produces ranks
            with gaps, and <a class="link" href="window-function-descriptions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a>,
            which produces ranks without gaps. The query shows rank
            values for each member of a set of values in the
            <code class="literal">val</code> column, which contains some
            duplicates. <a class="link" href="window-function-descriptions.html#function_rank"><code class="literal">RANK()</code></a> assigns
            peers (the duplicates) the same rank value, and the next
            greater value has a rank higher by the number of peers minus
            one. <a class="link" href="window-function-descriptions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a> also
            assigns peers the same rank value, but the next higher value
            has a rank one greater. For reference, the query also
            displays row numbers using
            <a class="link" href="window-function-descriptions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a>:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>val,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER w AS &#39;row_number&#39;,</code></strong>
         <strong class="userinput"><code>RANK()       OVER w AS &#39;rank&#39;,</code></strong>
         <strong class="userinput"><code>DENSE_RANK() OVER w AS &#39;dense_rank&#39;</code></strong>
       <strong class="userinput"><code>FROM numbers</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY val);</code></strong>
+------+------------+------+------------+
| val  | row_number | rank | dense_rank |
+------+------------+------+------------+
|    1 |          1 |    1 |          1 |
|    1 |          2 |    1 |          1 |
|    2 |          3 |    3 |          2 |
|    3 |          4 |    4 |          3 |
|    3 |          5 |    4 |          3 |
|    3 |          6 |    4 |          3 |
|    4 |          7 |    7 |          4 |
|    4 |          8 |    7 |          4 |
|    5 |          9 |    9 |          5 |
+------+------------+------+------------+
</pre></li><li class="listitem"><a id="function_row-number"></a><p>
            <a class="link" href="window-function-descriptions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a id="idm45828918760944" class="indexterm"></a><p>
            Returns the number of the current row within its partition.
            Rows numbers range from 1 to the number of partition rows.
          </p><p>
            <code class="literal">ORDER BY</code> affects the order in which rows
            are numbered. Without <code class="literal">ORDER BY</code>, row
            numbering is nondeterministic.
          </p><p>
            <a class="link" href="window-function-descriptions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a> assigns peers
            different row numbers. To assign peers the same value, use
            <a class="link" href="window-function-descriptions.html#function_rank"><code class="literal">RANK()</code></a> or
            <a class="link" href="window-function-descriptions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a>. For an example,
            see the <a class="link" href="window-function-descriptions.html#function_rank"><code class="literal">RANK()</code></a> function
            description.
          </p><p>
            <em class="replaceable"><code>over_clause</code></em> is as described in
            <a class="xref" href="window-functions-usage.html" title="12.20.2&nbsp;Window Function Concepts and Syntax">Section&nbsp;12.20.2, &ldquo;Window Function Concepts and Syntax&rdquo;</a>.
          </p></li></ul></div></div><div class="navigation"><ul><li class="navLinkPrevious"><a title="Go To Previous Page" href="window-functions.html">Previous <span class="navHint"> Window Functions </span></a></li><li class="navLinkHome"><a title="Go To Home Page" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a title="Go Up A Level In The Navigation" href="window-functions.html">Up <span class="navHint"> Window Functions </span></a></li><li class="navLinkNext"><a title="Go To Next Page" href="window-functions-usage.html">Next <span class="navHint"> Window Function Concepts and Syntax </span></a></li></ul></div><div class="dochomelink-footer"><a title="Go to MySQL Doc Library" href="https://docs.oracle.com/cd/E17952_01/index.html">
        MySQL Documentation Library
      </a></div><div class="copyright-footer"></div></body></html>