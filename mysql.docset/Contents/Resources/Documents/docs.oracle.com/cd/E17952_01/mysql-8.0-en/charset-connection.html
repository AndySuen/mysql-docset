<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><a class="dashingAutolink" name="autolink-231"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/10.4%C2%A0Connection%20Character%20Sets%20and%20Collations"></a><title>10.4&nbsp;Connection Character Sets and Collations</title><link rel="stylesheet" type="text/css" href="mvl-otn.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/><link rel="home" href="performance-schema" title="MySQL 8.0 Reference Manual"/><link rel="up" href="charset.html" title="Chapter&nbsp;10&nbsp;Character Sets, Collations, Unicode"/><link rel="prev" href="charset-compatibility.html" title="10.3.10&nbsp;Compatibility with Other DBMSs"/><link rel="next" href="charset-applications.html" title="10.5&nbsp;Configuring Application Character Set and Collation"/><script>window.ohcglobal || document.write('<script src="../../../en/dcommon/js/global.js">\x3C/script>')</script></head><body><div class="skip-link"><a href="charset-connection.html#charset-connection">Skip to Main Content</a></div><div class="DocTitle"><p>MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0</p></div><div class="navigation"><ul><li class="navLinkPrevious"><a accesskey="p" title="Go To Previous Page&nbsp;[access key: p]" href="charset-compatibility.html">Previous <span class="navHint"> Compatibility with Other DBMSs </span></a></li><li class="navLinkHome"><a accesskey="h" title="Go To Home Page&nbsp;[access key: h]" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a accesskey="u" title="Go Up A Level In The Navigation&nbsp;[access key: u]" href="charset.html">Up <span class="navHint"> Character Sets, Collations, Unicode </span></a></li><li class="navLinkNext"><a accesskey="n" title="Go To Next Page&nbsp;[access key: n]" href="charset-applications.html">Next <span class="navHint"> Configuring Application Character Set and Collation </span></a></li></ul></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="charset-connection"></a>10.4&nbsp;Connection Character Sets and Collations</h2></div></div></div><a id="idm45828944356112" class="indexterm"></a><a id="idm45828944354688" class="indexterm"></a><p>
      A <span class="quote">&ldquo;<span class="quote">connection</span>&rdquo;</span> is what a client program makes when it
      connects to the server, to begin a session within which it
      interacts with the server. The client sends SQL statements, such
      as queries, over the session connection. The server sends
      responses, such as result sets or error messages, over the
      connection back to the client.
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="charset-connection.html#charset-connection-system-variables" title="Connection Character Set and Collation System Variables">Connection Character Set and Collation System Variables</a></p></li><li class="listitem"><p><a class="xref" href="charset-connection.html#charset-connection-impermissible-client-charset" title="Impermissible Client Character Sets">Impermissible Client Character Sets</a></p></li><li class="listitem"><p><a class="xref" href="charset-connection.html#charset-connection-client-configuration" title="Client Program Connection Character Set Configuration">Client Program Connection Character Set Configuration</a></p></li><li class="listitem"><p><a class="xref" href="charset-connection.html#charset-connection-sql-statements" title="SQL Statements for Connection Character Set Configuration">SQL Statements for Connection Character Set Configuration</a></p></li><li class="listitem"><p><a class="xref" href="charset-connection.html#charset-connection-error-handling" title="Connection Character Set Error Handling">Connection Character Set Error Handling</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="charset-connection-system-variables"></a>Connection Character Set and Collation System Variables</h3></div></div></div><p>
        Several character set and collation system variables relate to a
        client&#39;s interaction with the server. Some of these have been
        mentioned in earlier sections:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The <a class="link" href="server-system-variables.html#sysvar_character_set_server"><code class="literal">character_set_server</code></a>
            and <a class="link" href="server-system-variables.html#sysvar_collation_server"><code class="literal">collation_server</code></a> system
            variables indicate the server character set and collation.
            See <a class="xref" href="charset-server.html" title="10.3.2&nbsp;Server Character Set and Collation">Section&nbsp;10.3.2, &ldquo;Server Character Set and Collation&rdquo;</a>.
          </p></li><li class="listitem"><p>
            The <a class="link" href="server-system-variables.html#sysvar_character_set_database"><code class="literal">character_set_database</code></a>
            and <a class="link" href="server-system-variables.html#sysvar_collation_database"><code class="literal">collation_database</code></a>
            system variables indicate the character set and collation of
            the default database. See
            <a class="xref" href="charset-database.html" title="10.3.3&nbsp;Database Character Set and Collation">Section&nbsp;10.3.3, &ldquo;Database Character Set and Collation&rdquo;</a>.
          </p></li></ul></div><p>
        Additional character set and collation system variables are
        involved in handling traffic for the connection between a client
        and the server. Every client has session-specific
        connection-related character set and collation system variables.
        These session system variable values are initialized at connect
        time, but can be changed within the session.
      </p><p>
        Several questions about character set and collation handling for
        client connections can be answered in terms of system variables:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            What character set are statements in when they leave the
            client?
          </p><p>
            The server takes the
            <a class="link" href="server-system-variables.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
            variable to be the character set in which statements are
            sent by the client.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
              Some character sets cannot be used as the client character
              set. See
              <a class="xref" href="charset-connection.html#charset-connection-impermissible-client-charset" title="Impermissible Client Character Sets">Impermissible Client Character Sets</a>.
            </p></div></li><li class="listitem"><p>
            What character set should the server translate statements to
            after receiving them?
          </p><p>
            To determine this, the server uses the
            <a class="link" href="server-system-variables.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a>
            and <a class="link" href="server-system-variables.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a>
            system variables:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                The server converts statements sent by the client from
                <a class="link" href="server-system-variables.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> to
                <a class="link" href="server-system-variables.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a>.
                Exception: For string literals that have an introducer
                such as <code class="literal">_utf8mb4</code> or
                <code class="literal">_latin2</code>, the introducer determines
                the character set. See
                <a class="xref" href="charset-introducer.html" title="10.3.8&nbsp;Character Set Introducers">Section&nbsp;10.3.8, &ldquo;Character Set Introducers&rdquo;</a>.
              </p></li><li class="listitem"><p>
                <a class="link" href="server-system-variables.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> is
                important for comparisons of literal strings. For
                comparisons of strings with column values,
                <a class="link" href="server-system-variables.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a>
                does not matter because columns have their own
                collation, which has a higher collation precedence (see
                <a class="xref" href="charset-collation-coercibility.html" title="10.8.4&nbsp;Collation Coercibility in Expressions">Section&nbsp;10.8.4, &ldquo;Collation Coercibility in Expressions&rdquo;</a>).
              </p></li></ul></div></li><li class="listitem"><p>
            What character set should the server translate query results
            to before shipping them back to the client?
          </p><p>
            The <a class="link" href="server-system-variables.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a>
            system variable indicates the character set in which the
            server returns query results to the client. This includes
            result data such as column values, result metadata such as
            column names, and error messages.
          </p><p>
            To tell the server to perform no conversion of result sets
            or error messages, set
            <a class="link" href="server-system-variables.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a> to
            <code class="literal">NULL</code> or <code class="literal">binary</code>:
          </p><pre class="programlisting">SET character_set_results = NULL;
SET character_set_results = binary;
</pre><p>
            For more information about character sets and error
            messages, see <a class="xref" href="charset-errors.html" title="10.6&nbsp;Error Message Character Set">Section&nbsp;10.6, &ldquo;Error Message Character Set&rdquo;</a>.
          </p></li></ul></div><p>
        To see the values of the character set and collation system
        variables that apply to the current session, use this statement:
      </p><pre class="programlisting">SELECT * FROM performance_schema.session_variables
WHERE VARIABLE_NAME IN (
  &#39;character_set_client&#39;, &#39;character_set_connection&#39;,
  &#39;character_set_results&#39;, &#39;collation_connection&#39;
) ORDER BY VARIABLE_NAME;
</pre><p>
        The following simpler statements also display the connection
        variables, but include other related variables as well. They can
        be useful to see <span class="emphasis"><em>all</em></span> character set and
        collation system variables:
      </p><pre class="programlisting">SHOW SESSION VARIABLES LIKE &#39;character\_set\_%&#39;;
SHOW SESSION VARIABLES LIKE &#39;collation\_%&#39;;
</pre><p>
        Clients can fine-tune the settings for these variables, or
        depend on the defaults (in which case, you can skip the rest of
        this section). If you do not use the defaults, you must change
        the character settings <span class="emphasis"><em>for each connection to the
        server</em></span>.
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="charset-connection-impermissible-client-charset"></a>Impermissible Client Character Sets</h3></div></div></div><a id="idm45828944301456" class="indexterm"></a><a id="idm45828944299968" class="indexterm"></a><a id="idm45828944298480" class="indexterm"></a><a id="idm45828944296992" class="indexterm"></a><p>
        The <a class="link" href="server-system-variables.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
        variable cannot be set to certain character sets:
      </p><pre class="programlisting">ucs2
utf16
utf16le
utf32
</pre><p>
        Attempting to use any of those character sets as the client
        character set produces an error:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET character_set_client = &#39;ucs2&#39;;</code></strong>
ERROR 1231 (42000): Variable &#39;character_set_client&#39;
can&#39;t be set to the value of &#39;ucs2&#39;
</pre><p>
        The same error occurs if any of those character sets are used in
        the following contexts, all of which result in an attempt to set
        <a class="link" href="server-system-variables.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> to the
        named character set:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The
            <a class="link" href="mysql-command-options.html#option_mysql_default-character-set"><code class="option">--default-character-set=<em class="replaceable"><code>charset_name</code></em></code></a>
            command option used by MySQL client programs such as
            <a class="link" href="mysql.html" title="4.5.1&nbsp;mysql &mdash; The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> and <a class="link" href="mysqladmin.html" title="4.5.2&nbsp;mysqladmin &mdash; A MySQL Server Administration Program"><span class="command"><strong>mysqladmin</strong></span></a>.
          </p></li><li class="listitem"><p>
            The <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES
            &#39;<em class="replaceable"><code>charset_name</code></em>&#39;</code></a>
            statement.
          </p></li><li class="listitem"><p>
            The <a class="link" href="set-character-set.html" title="13.7.6.2&nbsp;SET CHARACTER SET Statement"><code class="literal">SET
            CHARACTER SET
            &#39;<em class="replaceable"><code>charset_name</code></em>&#39;</code></a>
            statement.
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="charset-connection-client-configuration"></a>Client Program Connection Character Set Configuration</h3></div></div></div><p>
        When a client connects to the server, it indicates which
        character set it wants to use for communication with the server.
        (Actually, the client indicates the default collation for that
        character set, from which the server can determine the character
        set.) The server uses this information to set the
        <a class="link" href="server-system-variables.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a>,
        <a class="link" href="server-system-variables.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a>,
        <a class="link" href="server-system-variables.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a> system
        variables to the character set, and
        <a class="link" href="server-system-variables.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> to the
        character set default collation. In effect, the server performs
        the equivalent of a <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES</code></a>
        operation.
      </p><p>
        If the server does not support the requested character set or
        collation, it falls back to using the server character set and
        collation to configure the connection. For additional detail
        about this fallback behavior, see
        <a class="xref" href="charset-connection.html#charset-connection-error-handling" title="Connection Character Set Error Handling">Connection Character Set Error Handling</a>.
      </p><p>
        The <a class="link" href="mysql.html" title="4.5.1&nbsp;mysql &mdash; The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>, <a class="link" href="mysqladmin.html" title="4.5.2&nbsp;mysqladmin &mdash; A MySQL Server Administration Program"><span class="command"><strong>mysqladmin</strong></span></a>,
        <a class="link" href="mysqlcheck.html" title="4.5.3&nbsp;mysqlcheck &mdash; A Table Maintenance Program"><span class="command"><strong>mysqlcheck</strong></span></a>, <a class="link" href="mysqlimport.html" title="4.5.5&nbsp;mysqlimport &mdash; A Data Import Program"><span class="command"><strong>mysqlimport</strong></span></a>,
        and <a class="link" href="mysqlshow.html" title="4.5.7&nbsp;mysqlshow &mdash; Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow</strong></span></a> client programs determine the
        default character set to use as follows:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            In the absence of other information, each client uses the
            compiled-in default character set, usually
            <code class="literal">utf8mb4</code>.
          </p></li><li class="listitem"><p>
            Each client can autodetect which character set to use based
            on the operating system setting, such as the value of the
            <code class="literal">LANG</code> or <code class="literal">LC_ALL</code> locale
            environment variable on Unix systems or the code page
            setting on Windows systems. For systems on which the locale
            is available from the OS, the client uses it to set the
            default character set rather than using the compiled-in
            default. For example, setting <code class="literal">LANG</code> to
            <code class="literal">ru_RU.KOI8-R</code> causes the
            <code class="literal">koi8r</code> character set to be used. Thus,
            users can configure the locale in their environment for use
            by MySQL clients.
          </p><p>
            The OS character set is mapped to the closest MySQL
            character set if there is no exact match. If the client does
            not support the matching character set, it uses the
            compiled-in default. For example, <code class="literal">utf8</code>
            and <code class="literal">utf-8</code> map to
            <code class="literal">utf8mb4</code>, and <code class="literal">ucs2</code> is
            not supported as a connection character set, so it maps to
            the compiled-in default.
          </p><p>
            C applications can use character set autodetection based on
            the OS setting by invoking
            <a class="ulink" href="https://docs.oracle.com/cd/E17952_01/c-api-8.0-en/mysql-options.html" target="_top"><code class="literal">mysql_options()</code></a> as follows
            before connecting to the server:
          </p><pre class="programlisting">mysql_options(mysql,
              MYSQL_SET_CHARSET_NAME,
              MYSQL_AUTODETECT_CHARSET_NAME);
</pre></li><li class="listitem"><p>
            Each client supports a
            <a class="link" href="mysql-command-options.html#option_mysql_default-character-set"><code class="option">--default-character-set</code></a>
            option, which enables users to specify the character set
            explicitly to override whatever default the client otherwise
            determines.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
              Some character sets cannot be used as the client character
              set. Attempting to use them with
              <a class="link" href="mysql-command-options.html#option_mysql_default-character-set"><code class="option">--default-character-set</code></a>
              produces an error. See
              <a class="xref" href="charset-connection.html#charset-connection-impermissible-client-charset" title="Impermissible Client Character Sets">Impermissible Client Character Sets</a>.
            </p></div></li></ul></div><p>
        With the <a class="link" href="mysql.html" title="4.5.1&nbsp;mysql &mdash; The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client, to use a character set
        different from the default, you could explicitly execute a
        <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES</code></a> statement every time
        you connect to the server (see
        <a class="xref" href="charset-connection.html#charset-connection-client-configuration" title="Client Program Connection Character Set Configuration">Client Program Connection Character Set Configuration</a>). To
        accomplish the same result more easily, specify the character
        set in your option file. For example, the following option file
        setting changes the three connection-related character set
        system variables set to <code class="literal">koi8r</code> each time you
        invoke <a class="link" href="mysql.html" title="4.5.1&nbsp;mysql &mdash; The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>:
      </p><pre class="programlisting">[mysql]
default-character-set=koi8r
</pre><p>
        If you are using the <a class="link" href="mysql.html" title="4.5.1&nbsp;mysql &mdash; The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client with
        auto-reconnect enabled (which is not recommended), it is
        preferable to use the <code class="literal">charset</code> command rather
        than <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES</code></a>. For example:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>charset koi8r</code></strong>
Charset changed
</pre><p>
        The <code class="literal">charset</code> command issues a
        <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES</code></a> statement, and also
        changes the default character set that <a class="link" href="mysql.html" title="4.5.1&nbsp;mysql &mdash; The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>
        uses when it reconnects after the connection has dropped.
      </p><p>
        When configuration client programs, you must also consider the
        environment within which they execute. See
        <a class="xref" href="charset-applications.html" title="10.5&nbsp;Configuring Application Character Set and Collation">Section&nbsp;10.5, &ldquo;Configuring Application Character Set and Collation&rdquo;</a>.
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="charset-connection-sql-statements"></a>SQL Statements for Connection Character Set Configuration</h3></div></div></div><p>
        After a connection has been established, clients can change the
        character set and collation system variables for the current
        session. These variables can be changed individually using
        <a class="link" href="set-statement.html" title="13.7.6&nbsp;SET Statements"><code class="literal">SET</code></a>
        statements, but two more convenient statements affect the
        connection-related character set system variables as a group:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">SET NAMES &#39;<em class="replaceable"><code>charset_name</code></em>&#39;
            [COLLATE
            &#39;<em class="replaceable"><code>collation_name</code></em>&#39;]</code>
          </p><p>
            <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES</code></a> indicates what
            character set the client uses to send SQL statements to the
            server. Thus, <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET
            NAMES &#39;cp1251&#39;</code></a> tells the server, <span class="quote">&ldquo;<span class="quote">future
            incoming messages from this client are in character set
            <code class="literal">cp1251</code>.</span>&rdquo;</span> It also specifies the
            character set that the server should use for sending results
            back to the client. (For example, it indicates what
            character set to use for column values if you use a
            <a class="link" href="select.html" title="13.2.13&nbsp;SELECT Statement"><code class="literal">SELECT</code></a> statement that
            produces a result set.)
          </p><p>
            A <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES
            &#39;<em class="replaceable"><code>charset_name</code></em>&#39;</code></a>
            statement is equivalent to these three statements:
          </p><pre class="programlisting">SET character_set_client = <em class="replaceable"><code>charset_name</code></em>;
SET character_set_results = <em class="replaceable"><code>charset_name</code></em>;
SET character_set_connection = <em class="replaceable"><code>charset_name</code></em>;
</pre><p>
            Setting
            <a class="link" href="server-system-variables.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a> to
            <em class="replaceable"><code>charset_name</code></em> also implicitly sets
            <a class="link" href="server-system-variables.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> to the
            default collation for
            <em class="replaceable"><code>charset_name</code></em>. It is unnecessary
            to set that collation explicitly. To specify a particular
            collation to use for
            <a class="link" href="server-system-variables.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a>, add a
            <code class="literal">COLLATE</code> clause:
          </p><pre class="programlisting">SET NAMES &#39;<em class="replaceable"><code>charset_name</code></em>&#39; COLLATE &#39;<em class="replaceable"><code>collation_name</code></em>&#39;
</pre></li><li class="listitem"><p>
            <code class="literal">SET CHARACTER SET
            &#39;<em class="replaceable"><code>charset_name</code></em></code>&#39;
          </p><p>
            <a class="link" href="set-character-set.html" title="13.7.6.2&nbsp;SET CHARACTER SET Statement"><code class="literal">SET CHARACTER SET</code></a> is similar
            to <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES</code></a> but sets
            <a class="link" href="server-system-variables.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a>
            and <a class="link" href="server-system-variables.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> to
            <a class="link" href="server-system-variables.html#sysvar_character_set_database"><code class="literal">character_set_database</code></a> and
            <a class="link" href="server-system-variables.html#sysvar_collation_database"><code class="literal">collation_database</code></a> (which,
            as mentioned previously, indicate the character set and
            collation of the default database).
          </p><p>
            A <a class="link" href="set-character-set.html" title="13.7.6.2&nbsp;SET CHARACTER SET Statement"><code class="literal">SET
            CHARACTER SET
            <em class="replaceable"><code>charset_name</code></em></code></a> statement
            is equivalent to these three statements:
          </p><pre class="programlisting">SET character_set_client = <em class="replaceable"><code>charset_name</code></em>;
SET character_set_results = <em class="replaceable"><code>charset_name</code></em>;
SET collation_connection = @@collation_database;
</pre><p>
            Setting
            <a class="link" href="server-system-variables.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> also
            implicitly sets
            <a class="link" href="server-system-variables.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a> to
            the character set associated with the collation (equivalent
            to executing <code class="literal">SET character_set_connection =
            @@character_set_database</code>). It is unnecessary to
            set
            <a class="link" href="server-system-variables.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a>
            explicitly.
          </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          Some character sets cannot be used as the client character
          set. Attempting to use them with <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET
          NAMES</code></a> or <a class="link" href="set-character-set.html" title="13.7.6.2&nbsp;SET CHARACTER SET Statement"><code class="literal">SET CHARACTER
          SET</code></a> produces an error. See
          <a class="xref" href="charset-connection.html#charset-connection-impermissible-client-charset" title="Impermissible Client Character Sets">Impermissible Client Character Sets</a>.
        </p></div><p>
        Example: Suppose that <code class="literal">column1</code> is defined as
        <code class="literal">CHAR(5) CHARACTER SET latin2</code>. If you do not
        say <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES</code></a> or
        <a class="link" href="set-character-set.html" title="13.7.6.2&nbsp;SET CHARACTER SET Statement"><code class="literal">SET CHARACTER SET</code></a>, then for
        <code class="literal">SELECT column1 FROM t</code>, the server sends back
        all the values for <code class="literal">column1</code> using the
        character set that the client specified when it connected. On
        the other hand, if you say <code class="literal">SET NAMES &#39;latin1&#39;</code>
        or <code class="literal">SET CHARACTER SET &#39;latin1&#39;</code> before issuing
        the <a class="link" href="select.html" title="13.2.13&nbsp;SELECT Statement"><code class="literal">SELECT</code></a> statement, the server
        converts the <code class="literal">latin2</code> values to
        <code class="literal">latin1</code> just before sending results back.
        Conversion may be lossy for characters that are not in both
        character sets.
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="charset-connection-error-handling"></a>Connection Character Set Error Handling</h3></div></div></div><p>
        Attempts to use an inappropriate connection character set or
        collation can produce an error, or cause the server to fall back
        to its default character set and collation for a given
        connection. This section describes problems that can occur when
        configuring the connection character set. These problems can
        occur when establishing a connection or when changing the
        character set within an established connection.
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="charset-connection.html#charset-connection-error-handling-connect-time" title="Connect-Time Error Handling">Connect-Time Error Handling</a></p></li><li class="listitem"><p><a class="xref" href="charset-connection.html#charset-connection-error-handling-runtime" title="Runtime Error Handling">Runtime Error Handling</a></p></li></ul></div><a class="dashingAutolink" name="autolink-232"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Connect-Time%20Error%20Handling"></a><h4><a id="charset-connection-error-handling-connect-time"></a>Connect-Time Error Handling</h4><p>
        Some character sets cannot be used as the client character set;
        see
        <a class="xref" href="charset-connection.html#charset-connection-impermissible-client-charset" title="Impermissible Client Character Sets">Impermissible Client Character Sets</a>.
        If you specify a character set that is valid but not permitted
        as a client character set, the server returns an error:
      </p><pre class="programlisting">$&gt; <strong class="userinput"><code>mysql --default-character-set=ucs2</code></strong>
ERROR 1231 (42000): Variable &#39;character_set_client&#39; can&#39;t be set to
the value of &#39;ucs2&#39;
</pre><p>
        If you specify a character set that the client does not
        recognize, it produces an error:
      </p><pre class="programlisting">$&gt; <strong class="userinput"><code>mysql --default-character-set=bogus</code></strong>
mysql: Character set &#39;bogus&#39; is not a compiled character set and is
not specified in the &#39;/usr/local/mysql/share/charsets/Index.xml&#39; file
ERROR 2019 (HY000): Can&#39;t initialize character set bogus
(path: /usr/local/mysql/share/charsets/)
</pre><p>
        If you specify a character set that the client recognizes but
        the server does not, the server falls back to its default
        character set and collation. Suppose that the server is
        configured to use <code class="literal">latin1</code> and
        <code class="literal">latin1_swedish_ci</code> as its defaults, and that
        it does not recognize <code class="literal">gb18030</code> as a valid
        character set. A client that specifies
        <a class="link" href="mysql-command-options.html#option_mysql_default-character-set"><code class="option">--default-character-set=gb18030</code></a> is
        able to connect to the server, but the resulting character set
        is not what the client wants:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW SESSION VARIABLES LIKE &#39;character\_set\_%&#39;;</code></strong>
+--------------------------+--------+
| Variable_name            | Value  |
+--------------------------+--------+
| character_set_client     | latin1 |
| character_set_connection | latin1 |
...
| character_set_results    | latin1 |
...
+--------------------------+--------+
mysql&gt; <strong class="userinput"><code>SHOW SESSION VARIABLES LIKE &#39;collation_connection&#39;;</code></strong>
+----------------------+-------------------+
| Variable_name        | Value             |
+----------------------+-------------------+
| collation_connection | latin1_swedish_ci |
+----------------------+-------------------+
</pre><p>
        You can see that the connection system variables have been set
        to reflect a character set and collation of
        <code class="literal">latin1</code> and
        <code class="literal">latin1_swedish_ci</code>. This occurs because the
        server cannot satisfy the client character set request and falls
        back to its defaults.
      </p><p>
        In this case, the client cannot use the character set that it
        wants because the server does not support it. The client must
        either be willing to use a different character set, or connect
        to a different server that supports the desired character set.
      </p><p>
        The same problem occurs in a more subtle context: When the
        client tells the server to use a character set that the server
        recognizes, but the default collation for that character set on
        the client side is not known on the server side. This occurs,
        for example, when a MySQL 8.0 client wants to connect to a MySQL
        5.7 server using <code class="literal">utf8mb4</code> as the client
        character set. A client that specifies
        <a class="link" href="mysql-command-options.html#option_mysql_default-character-set"><code class="option">--default-character-set=utf8mb4</code></a> is
        able to connect to the server. However, as in the previous
        example, the server falls back to its default character set and
        collation, not what the client requested:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW SESSION VARIABLES LIKE &#39;character\_set\_%&#39;;</code></strong>
+--------------------------+--------+
| Variable_name            | Value  |
+--------------------------+--------+
| character_set_client     | latin1 |
| character_set_connection | latin1 |
...
| character_set_results    | latin1 |
...
+--------------------------+--------+
mysql&gt; <strong class="userinput"><code>SHOW SESSION VARIABLES LIKE &#39;collation_connection&#39;;</code></strong>
+----------------------+-------------------+
| Variable_name        | Value             |
+----------------------+-------------------+
| collation_connection | latin1_swedish_ci |
+----------------------+-------------------+
</pre><p>
        Why does this occur? After all, <code class="literal">utf8mb4</code> is
        known to the 8.0 client and the 5.7 server, so both of them
        recognize it. To understand this behavior, it is necessary to
        understand that when the client tells the server which character
        set it wants to use, it really tells the server the default
        collation for that character set. Therefore, the aforementioned
        behavior occurs due to a combination of factors:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The default collation for <code class="literal">utf8mb4</code> differs
            between MySQL 5.7 and 8.0
            (<code class="literal">utf8mb4_general_ci</code> for 5.7,
            <code class="literal">utf8mb4_0900_ai_ci</code> for 8.0).
          </p></li><li class="listitem"><p>
            When the 8.0 client requests a character set of
            <code class="literal">utf8mb4</code>, what it sends to the server is
            the default 8.0 <code class="literal">utf8mb4</code> collation; that
            is, the <code class="literal">utf8mb4_0900_ai_ci</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">utf8mb4_0900_ai_ci</code> is implemented only as
            of MySQL 8.0, so the 5.7 server does not recognize it.
          </p></li><li class="listitem"><p>
            Because the 5.7 server does not recognize
            <code class="literal">utf8mb4_0900_ai_ci</code>, it cannot satisfy the
            client character set request, and falls back to its default
            character set and collation (<code class="literal">latin1</code> and
            <code class="literal">latin1_swedish_ci</code>).
          </p></li></ul></div><p>
        In this case, the client can still use
        <code class="literal">utf8mb4</code> by issuing a <code class="literal">SET NAMES
        &#39;utf8mb4&#39;</code> statement after connecting. The resulting
        collation is the 5.7 default <code class="literal">utf8mb4</code>
        collation; that is, <code class="literal">utf8mb4_general_ci</code>. If
        the client additionally wants a collation of
        <code class="literal">utf8mb4_0900_ai_ci</code>, it cannot achieve that
        because the server does not recognize that collation. The client
        must either be willing to use a different
        <code class="literal">utf8mb4</code> collation, or connect to a server
        from MySQL 8.0 or higher.
      </p><a class="dashingAutolink" name="autolink-233"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Runtime%20Error%20Handling"></a><h4><a id="charset-connection-error-handling-runtime"></a>Runtime Error Handling</h4><p>
        Within an established connection, the client can request a
        change of connection character set and collation with
        <a class="link" href="set-names.html" title="13.7.6.3&nbsp;SET NAMES Statement"><code class="literal">SET NAMES</code></a> or
        <a class="link" href="set-character-set.html" title="13.7.6.2&nbsp;SET CHARACTER SET Statement"><code class="literal">SET CHARACTER SET</code></a>.
      </p><p>
        Some character sets cannot be used as the client character set;
        see
        <a class="xref" href="charset-connection.html#charset-connection-impermissible-client-charset" title="Impermissible Client Character Sets">Impermissible Client Character Sets</a>.
        If you specify a character set that is valid but not permitted
        as a client character set, the server returns an error:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET NAMES &#39;ucs2&#39;;</code></strong>
ERROR 1231 (42000): Variable &#39;character_set_client&#39; can&#39;t be set to
the value of &#39;ucs2&#39;
</pre><p>
        If the server does not recognize the character set (or the
        collation), it produces an error:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET NAMES &#39;bogus&#39;;</code></strong>
ERROR 1115 (42000): Unknown character set: &#39;bogus&#39;

mysql&gt; <strong class="userinput"><code>SET NAMES &#39;utf8mb4&#39; COLLATE &#39;bogus&#39;;</code></strong>
ERROR 1273 (HY000): Unknown collation: &#39;bogus&#39;
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Tip</div><p>
          A client that wants to verify whether its requested character
          set was honored by the server can execute the following
          statement after connecting and checking that the result is the
          expected character set:
        </p><pre class="programlisting">SELECT @@character_set_client;
</pre></div></div></div><div class="navigation"><ul><li class="navLinkPrevious"><a title="Go To Previous Page" href="charset-compatibility.html">Previous <span class="navHint"> Compatibility with Other DBMSs </span></a></li><li class="navLinkHome"><a title="Go To Home Page" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a title="Go Up A Level In The Navigation" href="charset.html">Up <span class="navHint"> Character Sets, Collations, Unicode </span></a></li><li class="navLinkNext"><a title="Go To Next Page" href="charset-applications.html">Next <span class="navHint"> Configuring Application Character Set and Collation </span></a></li></ul></div><div class="dochomelink-footer"><a title="Go to MySQL Doc Library" href="https://docs.oracle.com/cd/E17952_01/index.html">
        MySQL Documentation Library
      </a></div><div class="copyright-footer"></div></body></html>