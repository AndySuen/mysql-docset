<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><a class="dashingAutolink" name="autolink-3094"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/6.2.15%C2%A0Password%20Management"></a><title>6.2.15&nbsp;Password Management</title><link rel="stylesheet" type="text/css" href="mvl-otn.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/><link rel="home" href="performance-schema" title="MySQL 8.0 Reference Manual"/><link rel="up" href="access-control.html" title="6.2&nbsp;Access Control and Account Management"/><link rel="prev" href="assigning-passwords.html" title="6.2.14&nbsp;Assigning Account Passwords"/><link rel="next" href="expired-password-handling.html" title="6.2.16&nbsp;Server Handling of Expired Passwords"/><script>window.ohcglobal || document.write('<script src="../../../en/dcommon/js/global.js">\x3C/script>')</script></head><body><div class="skip-link"><a href="password-management.html#password-management">Skip to Main Content</a></div><div class="DocTitle"><p>MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0</p></div><div class="navigation"><ul><li class="navLinkPrevious"><a accesskey="p" title="Go To Previous Page&nbsp;[access key: p]" href="assigning-passwords.html">Previous <span class="navHint"> Assigning Account Passwords </span></a></li><li class="navLinkHome"><a accesskey="h" title="Go To Home Page&nbsp;[access key: h]" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a accesskey="u" title="Go Up A Level In The Navigation&nbsp;[access key: u]" href="access-control.html">Up <span class="navHint"> Access Control and Account Management </span></a></li><li class="navLinkNext"><a accesskey="n" title="Go To Next Page&nbsp;[access key: n]" href="expired-password-handling.html">Next <span class="navHint"> Server Handling of Expired Passwords </span></a></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="password-management"></a>6.2.15&nbsp;Password Management</h3></div></div></div><a id="idm45828976368704" class="indexterm"></a><p>
      MySQL supports these password-management capabilities:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Password expiration, to require passwords to be changed
          periodically.
        </p></li><li class="listitem"><p>
          Password reuse restrictions, to prevent old passwords from
          being chosen again.
        </p></li><li class="listitem"><p>
          Password verification, to require that password changes also
          specify the current password to be replaced.
        </p></li><li class="listitem"><p>
          Dual passwords, to enable clients to connect using either a
          primary or secondary password.
        </p></li><li class="listitem"><p>
          Password strength assessment, to require strong passwords.
        </p></li><li class="listitem"><p>
          Random password generation, as an alternative to requiring
          explicit administrator-specified literal passwords.
        </p></li><li class="listitem"><p>
          Password failure tracking, to enable temporary account locking
          after too many consecutive incorrect-password login failures.
        </p></li></ul></div><p>
      The following sections describe these capabilities, except
      password strength assessment, which is implemented using the
      <code class="literal">validate_password</code> component and is described in
      <a class="xref" href="validate-password.html" title="6.4.3&nbsp;The Password Validation Component">Section&nbsp;6.4.3, &ldquo;The Password Validation Component&rdquo;</a>.
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="password-management.html#internal-versus-external-credentials" title="Internal Versus External Credentials Storage">Internal Versus External Credentials Storage</a></p></li><li class="listitem"><p><a class="xref" href="password-management.html#password-expiration-policy" title="Password Expiration Policy">Password Expiration Policy</a></p></li><li class="listitem"><p><a class="xref" href="password-management.html#password-reuse-policy" title="Password Reuse Policy">Password Reuse Policy</a></p></li><li class="listitem"><p><a class="xref" href="password-management.html#password-reverification-policy" title="Password Verification-Required Policy">Password Verification-Required Policy</a></p></li><li class="listitem"><p><a class="xref" href="password-management.html#dual-passwords" title="Dual Password Support">Dual Password Support</a></p></li><li class="listitem"><p><a class="xref" href="password-management.html#random-password-generation" title="Random Password Generation">Random Password Generation</a></p></li><li class="listitem"><p><a class="xref" href="password-management.html#failed-login-tracking" title="Failed-Login Tracking and Temporary Account Locking">Failed-Login Tracking and Temporary Account Locking</a></p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Important</div><p>
        MySQL implements password-management capabilities using tables
        in the <code class="literal">mysql</code> system database. If you upgrade
        MySQL from an earlier version, your system tables might not be
        up to date. In that case, the server writes messages similar to
        these to the error log during the startup process (the exact
        numbers may vary):
      </p><pre class="programlisting">[ERROR] Column count of mysql.user is wrong. Expected
49, found 47. The table is probably corrupted
[Warning] ACL table mysql.password_history missing.
Some operations may fail.
</pre><p>
        To correct the issue, perform the MySQL upgrade procedure. See
        <a class="xref" href="upgrading.html" title="2.10&nbsp;Upgrading MySQL">Section&nbsp;2.10, &ldquo;Upgrading MySQL&rdquo;</a>. Until this is done,
        <span class="emphasis"><em>password changes are not possible.</em></span>
      </p></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-3087"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Internal%20Versus%20External%20Credentials%20Storage"></a><h4 class="title"><a id="internal-versus-external-credentials"></a>Internal Versus External Credentials Storage</h4></div></div></div><p>
        Some authentication plugins store account credentials internally
        to MySQL, in the <code class="literal">mysql.user</code> system table:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">mysql_native_password</code>
          </p></li><li class="listitem"><p>
            <code class="literal">caching_sha2_password</code>
          </p></li><li class="listitem"><p>
            <code class="literal">sha256_password</code>
          </p></li></ul></div><p>
        Most discussion in this section applies to such authentication
        plugins because most password-management capabilities described
        here are based on internal credentials storage handled by MySQL
        itself. Other authentication plugins store account credentials
        externally to MySQL. For accounts that use plugins that perform
        authentication against an external credentials system, password
        management must be handled externally against that system as
        well.
      </p><p>
        The exception is that the options for failed-login tracking and
        temporary account locking apply to all accounts, not just
        accounts that use internal credentials storage, because MySQL is
        able to assess the status of login attempts for any account no
        matter whether it uses internal or external credentials storage.
      </p><p>
        For information about individual authentication plugins, see
        <a class="xref" href="authentication-plugins.html" title="6.4.1&nbsp;Authentication Plugins">Section&nbsp;6.4.1, &ldquo;Authentication Plugins&rdquo;</a>.
      </p></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-3088"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Password%20Expiration%20Policy"></a><h4 class="title"><a id="password-expiration-policy"></a>Password Expiration Policy</h4></div></div></div><p>
        MySQL enables database administrators to expire account
        passwords manually, and to establish a policy for automatic
        password expiration. Expiration policy can be established
        globally, and individual accounts can be set to either defer to
        the global policy or override the global policy with specific
        per-account behavior.
      </p><p>
        To expire an account password manually, use the
        <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a> statement:
      </p><pre class="programlisting">ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD EXPIRE;
</pre><p>
        This operation marks the password expired in the corresponding
        row in the <code class="literal">mysql.user</code> system table.
      </p><p>
        Password expiration according to policy is automatic and is
        based on password age, which for a given account is assessed
        from the date and time of its most recent password change. The
        <code class="literal">mysql.user</code> system table indicates for each
        account when its password was last changed, and the server
        automatically treats the password as expired at client
        connection time if its age is greater than its permitted
        lifetime. This works with no explicit manual password
        expiration.
      </p><p>
        To establish automatic password-expiration policy globally, use
        the <a class="link" href="server-system-variables.html#sysvar_default_password_lifetime"><code class="literal">default_password_lifetime</code></a>
        system variable. Its default value is 0, which disables
        automatic password expiration. If the value of
        <a class="link" href="server-system-variables.html#sysvar_default_password_lifetime"><code class="literal">default_password_lifetime</code></a> is a
        positive integer <em class="replaceable"><code>N</code></em>, it indicates the
        permitted password lifetime, such that passwords must be changed
        every <em class="replaceable"><code>N</code></em> days.
      </p><p>
        Examples:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To establish a global policy that passwords have a lifetime
            of approximately six months, start the server with these
            lines in a server <code class="filename">my.cnf</code> file:
          </p><pre class="programlisting">[mysqld]
default_password_lifetime=180
</pre></li><li class="listitem"><p>
            To establish a global policy such that passwords never
            expire, set
            <a class="link" href="server-system-variables.html#sysvar_default_password_lifetime"><code class="literal">default_password_lifetime</code></a>
            to 0:
          </p><pre class="programlisting">[mysqld]
default_password_lifetime=0
</pre></li><li class="listitem"><p>
            <a class="link" href="server-system-variables.html#sysvar_default_password_lifetime"><code class="literal">default_password_lifetime</code></a>
            can also be set and persisted at runtime:
          </p><pre class="programlisting">SET PERSIST default_password_lifetime = 180;
SET PERSIST default_password_lifetime = 0;
</pre><p>
            <a class="link" href="set-variable.html" title="13.7.6.1&nbsp;SET Syntax for Variable Assignment"><code class="literal">SET
            PERSIST</code></a> sets a value for the running MySQL
            instance. It also saves the value to carry over to
            subsequent server restarts; see
            <a class="xref" href="set-variable.html" title="13.7.6.1&nbsp;SET Syntax for Variable Assignment">Section&nbsp;13.7.6.1, &ldquo;SET Syntax for Variable Assignment&rdquo;</a>. To change the value for the
            running MySQL instance without having it carry over to
            subsequent restarts, use the <code class="literal">GLOBAL</code>
            keyword rather than <code class="literal">PERSIST</code>.
          </p></li></ul></div><p>
        The global password-expiration policy applies to all accounts
        that have not been set to override it. To establish policy for
        individual accounts, use the <code class="literal">PASSWORD EXPIRE</code>
        option of the <a class="link" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement"><code class="literal">CREATE USER</code></a> and
        <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a> statements. See
        <a class="xref" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement">Section&nbsp;13.7.1.3, &ldquo;CREATE USER Statement&rdquo;</a>, and <a class="xref" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement">Section&nbsp;13.7.1.1, &ldquo;ALTER USER Statement&rdquo;</a>.
      </p><p>
        Example account-specific statements:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Require the password to be changed every 90 days:
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD EXPIRE INTERVAL 90 DAY;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD EXPIRE INTERVAL 90 DAY;
</pre><p>
            This expiration option overrides the global policy for all
            accounts named by the statement.
          </p></li><li class="listitem"><p>
            Disable password expiration:
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD EXPIRE NEVER;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD EXPIRE NEVER;
</pre><p>
            This expiration option overrides the global policy for all
            accounts named by the statement.
          </p></li><li class="listitem"><p>
            Defer to the global expiration policy for all accounts named
            by the statement:
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD EXPIRE DEFAULT;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD EXPIRE DEFAULT;
</pre></li></ul></div><p>
        When a client successfully connects, the server determines
        whether the account password has expired:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The server checks whether the password has been manually
            expired.
          </p></li><li class="listitem"><p>
            Otherwise, the server checks whether the password age is
            greater than its permitted lifetime according to the
            automatic password expiration policy. If so, the server
            considers the password expired.
          </p></li></ul></div><p>
        If the password is expired (whether manually or automatically),
        the server either disconnects the client or restricts the
        operations permitted to it (see
        <a class="xref" href="expired-password-handling.html" title="6.2.16&nbsp;Server Handling of Expired Passwords">Section&nbsp;6.2.16, &ldquo;Server Handling of Expired Passwords&rdquo;</a>). Operations
        performed by a restricted client result in an error until the
        user establishes a new account password:
      </p><a id="idm45828976294464" class="indexterm"></a><a id="idm45828976293424" class="indexterm"></a><a id="idm45828976291936" class="indexterm"></a><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1;</code></strong>
ERROR 1820 (HY000): You must reset your password using ALTER USER
statement before executing this statement.

mysql&gt; <strong class="userinput"><code>ALTER USER USER() IDENTIFIED BY &#39;<em class="replaceable"><code>password</code></em>&#39;;</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SELECT 1;</code></strong>
+---+
| 1 |
+---+
| 1 |
+---+
1 row in set (0.00 sec)
</pre><p>
        After the client resets the password, the server restores normal
        access for the session, as well as for subsequent connections
        that use the account. It is also possible for an administrative
        user to reset the account password, but any existing restricted
        sessions for that account remain restricted. A client using the
        account must disconnect and reconnect before statements can be
        executed successfully.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          Although it is possible to <span class="quote">&ldquo;<span class="quote">reset</span>&rdquo;</span> an expired
          password by setting it to its current value, it is preferable,
          as a matter of good policy, to choose a different password.
          DBAs can enforce non-reuse by establishing an appropriate
          password-reuse policy. See
          <a class="xref" href="password-management.html#password-reuse-policy" title="Password Reuse Policy">Password Reuse Policy</a>.
        </p></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-3089"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Password%20Reuse%20Policy"></a><h4 class="title"><a id="password-reuse-policy"></a>Password Reuse Policy</h4></div></div></div><p>
        MySQL enables restrictions to be placed on reuse of previous
        passwords. Reuse restrictions can be established based on number
        of password changes, time elapsed, or both. Reuse policy can be
        established globally, and individual accounts can be set to
        either defer to the global policy or override the global policy
        with specific per-account behavior.
      </p><p>
        The password history for an account consists of passwords it has
        been assigned in the past. MySQL can restrict new passwords from
        being chosen from this history:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If an account is restricted on the basis of number of
            password changes, a new password cannot be chosen from a
            specified number of the most recent passwords. For example,
            if the minimum number of password changes is set to 3, a new
            password cannot be the same as any of the most recent 3
            passwords.
          </p></li><li class="listitem"><p>
            If an account is restricted based on time elapsed, a new
            password cannot be chosen from passwords in the history that
            are newer than a specified number of days. For example, if
            the password reuse interval is set to 60, a new password
            must not be among those previously chosen within the last 60
            days.
          </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          The empty password does not count in the password history and
          is subject to reuse at any time.
        </p></div><p>
        To establish password-reuse policy globally, use the
        <a class="link" href="server-system-variables.html#sysvar_password_history"><code class="literal">password_history</code></a> and
        <a class="link" href="server-system-variables.html#sysvar_password_reuse_interval"><code class="literal">password_reuse_interval</code></a> system
        variables.
      </p><p>
        Examples:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To prohibit reusing any of the last 6 passwords or passwords
            newer than 365 days, put these lines in the server
            <code class="filename">my.cnf</code> file:
          </p><pre class="programlisting">[mysqld]
password_history=6
password_reuse_interval=365
</pre></li><li class="listitem"><p>
            To set and persist the variables at runtime, use statements
            like this:
          </p><pre class="programlisting">SET PERSIST password_history = 6;
SET PERSIST password_reuse_interval = 365;
</pre><p>
            <a class="link" href="set-variable.html" title="13.7.6.1&nbsp;SET Syntax for Variable Assignment"><code class="literal">SET
            PERSIST</code></a> sets a value for the running MySQL
            instance. It also saves the value to carry over to
            subsequent server restarts; see
            <a class="xref" href="set-variable.html" title="13.7.6.1&nbsp;SET Syntax for Variable Assignment">Section&nbsp;13.7.6.1, &ldquo;SET Syntax for Variable Assignment&rdquo;</a>. To change the value for the
            running MySQL instance without having it carry over to
            subsequent restarts, use the <code class="literal">GLOBAL</code>
            keyword rather than <code class="literal">PERSIST</code>.
          </p></li></ul></div><p>
        The global password-reuse policy applies to all accounts that
        have not been set to override it. To establish policy for
        individual accounts, use the <code class="literal">PASSWORD HISTORY</code>
        and <code class="literal">PASSWORD REUSE INTERVAL</code> options of the
        <a class="link" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement"><code class="literal">CREATE USER</code></a> and
        <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a> statements. See
        <a class="xref" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement">Section&nbsp;13.7.1.3, &ldquo;CREATE USER Statement&rdquo;</a>, and <a class="xref" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement">Section&nbsp;13.7.1.1, &ldquo;ALTER USER Statement&rdquo;</a>.
      </p><p>
        Example account-specific statements:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Require a minimum of 5 password changes before permitting
            reuse:
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD HISTORY 5;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD HISTORY 5;
</pre><p>
            This history-length option overrides the global policy for
            all accounts named by the statement.
          </p></li><li class="listitem"><p>
            Require a minimum of 365 days elapsed before permitting
            reuse:
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD REUSE INTERVAL 365 DAY;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD REUSE INTERVAL 365 DAY;
</pre><p>
            This time-elapsed option overrides the global policy for all
            accounts named by the statement.
          </p></li><li class="listitem"><p>
            To combine both types of reuse restrictions, use
            <code class="literal">PASSWORD HISTORY</code> and <code class="literal">PASSWORD
            REUSE INTERVAL</code> together:
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39;
  PASSWORD HISTORY 5
  PASSWORD REUSE INTERVAL 365 DAY;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39;
  PASSWORD HISTORY 5
  PASSWORD REUSE INTERVAL 365 DAY;
</pre><p>
            These options override both global policy reuse restrictions
            for all accounts named by the statement.
          </p></li><li class="listitem"><p>
            Defer to the global policy for both types of reuse
            restrictions:
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39;
  PASSWORD HISTORY DEFAULT
  PASSWORD REUSE INTERVAL DEFAULT;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39;
  PASSWORD HISTORY DEFAULT
  PASSWORD REUSE INTERVAL DEFAULT;
</pre></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-3090"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Password%20Verification-Required%20Policy"></a><h4 class="title"><a id="password-reverification-policy"></a>Password Verification-Required Policy</h4></div></div></div><p>
        As of MySQL 8.0.13, it is possible to require that attempts to
        change an account password be verified by specifying the current
        password to be replaced. This enables DBAs to prevent users from
        changing a password without proving that they know the current
        password. Such changes could otherwise occur, for example, if
        one user walks away from a terminal session temporarily without
        logging out, and a malicious user uses the session to change the
        original user&#39;s MySQL password. This can have unfortunate
        consequences:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The original user becomes unable to access MySQL until the
            account password is reset by an administrator.
          </p></li><li class="listitem"><p>
            Until the password reset occurs, the malicious user can
            access MySQL with the benign user&#39;s changed credentials.
          </p></li></ul></div><p>
        Password-verification policy can be established globally, and
        individual accounts can be set to either defer to the global
        policy or override the global policy with specific per-account
        behavior.
      </p><p>
        For each account, its <code class="literal">mysql.user</code> row
        indicates whether there is an account-specific setting requiring
        verification of the current password for password change
        attempts. The setting is established by the <code class="literal">PASSWORD
        REQUIRE</code> option of the <a class="link" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement"><code class="literal">CREATE
        USER</code></a> and <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a>
        statements:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If the account setting is <code class="literal">PASSWORD REQUIRE
            CURRENT</code>, password changes must specify the current
            password.
          </p></li><li class="listitem"><p>
            If the account setting is <code class="literal">PASSWORD REQUIRE CURRENT
            OPTIONAL</code>, password changes may but need not
            specify the current password.
          </p></li><li class="listitem"><p>
            If the account setting is <code class="literal">PASSWORD REQUIRE CURRENT
            DEFAULT</code>, the
            <a class="link" href="server-system-variables.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a>
            system variable determines the verification-required policy
            for the account:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                If
                <a class="link" href="server-system-variables.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a>
                is enabled, password changes must specify the current
                password.
              </p></li><li class="listitem"><p>
                If
                <a class="link" href="server-system-variables.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a>
                is disabled, password changes may but need not specify
                the current password.
              </p></li></ul></div></li></ul></div><p>
        In other words, if the account setting is not <code class="literal">PASSWORD
        REQUIRE CURRENT DEFAULT</code>, the account setting takes
        precedence over the global policy established by the
        <a class="link" href="server-system-variables.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a> system
        variable. Otherwise, the account defers to the
        <a class="link" href="server-system-variables.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a>
        setting.
      </p><p>
        By default, password verification is optional:
        <a class="link" href="server-system-variables.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a> is
        disabled and accounts created with no <code class="literal">PASSWORD
        REQUIRE</code> option default to <code class="literal">PASSWORD REQUIRE
        CURRENT DEFAULT</code>.
      </p><p>
        The following table shows how per-account settings interact with
        <a class="link" href="server-system-variables.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a> system
        variable values to determine account password
        verification-required policy.
      </p><div class="table"><a id="password-verification-policy-table"></a><p class="title"><strong>Table&nbsp;6.10&nbsp;Password-Verification Policy</strong></p><div class="table-contents"><table summary="Interaction of mysql.user table and password_require_current system variable for password-verification policy."><colgroup><col style="width: 40%"/><col style="width: 30%"/><col style="width: 30%"/></colgroup><thead><tr>
            <th scope="col">Per-Account Setting</th>
            <th scope="col">password_require_current System Variable</th>
            <th scope="col">Password Changes Require Current Password?</th>
          </tr></thead><tbody><tr>
            <th scope="row"><code class="literal">PASSWORD REQUIRE CURRENT</code></th>
            <td><code class="literal">OFF</code></td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row"><code class="literal">PASSWORD REQUIRE CURRENT</code></th>
            <td><code class="literal">ON</code></td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row"><code class="literal">PASSWORD REQUIRE CURRENT OPTIONAL</code></th>
            <td><code class="literal">OFF</code></td>
            <td>No</td>
          </tr><tr>
            <th scope="row"><code class="literal">PASSWORD REQUIRE CURRENT OPTIONAL</code></th>
            <td><code class="literal">ON</code></td>
            <td>No</td>
          </tr><tr>
            <th scope="row"><code class="literal">PASSWORD REQUIRE CURRENT DEFAULT</code></th>
            <td><code class="literal">OFF</code></td>
            <td>No</td>
          </tr><tr>
            <th scope="row"><code class="literal">PASSWORD REQUIRE CURRENT DEFAULT</code></th>
            <td><code class="literal">ON</code></td>
            <td>Yes</td>
          </tr></tbody></table></div></div><br class="table-break"/><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          Privileged users can change any account password without
          specifying the current password, regardless of the
          verification-required policy. A privileged user is one who has
          the global <a class="link" href="privileges-provided.html#priv_create-user"><code class="literal">CREATE USER</code></a>
          privilege or the <a class="link" href="privileges-provided.html#priv_update"><code class="literal">UPDATE</code></a>
          privilege for the <code class="literal">mysql</code> system database.
        </p></div><p>
        To establish password-verification policy globally, use the
        <a class="link" href="server-system-variables.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a> system
        variable. Its default value is <code class="literal">OFF</code>, so it is
        not required that account password changes specify the current
        password.
      </p><p>
        Examples:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To establish a global policy that password changes must
            specify the current password, start the server with these
            lines in a server <code class="filename">my.cnf</code> file:
          </p><pre class="programlisting">[mysqld]
password_require_current=ON
</pre></li><li class="listitem"><p>
            To set and persist
            <a class="link" href="server-system-variables.html#sysvar_password_require_current"><code class="literal">password_require_current</code></a> at
            runtime, use a statement such as one of these:
          </p><pre class="programlisting">SET PERSIST password_require_current = ON;
SET PERSIST password_require_current = OFF;
</pre><p>
            <a class="link" href="set-variable.html" title="13.7.6.1&nbsp;SET Syntax for Variable Assignment"><code class="literal">SET
            PERSIST</code></a> sets a value for the running MySQL
            instance. It also saves the value to carry over to
            subsequent server restarts; see
            <a class="xref" href="set-variable.html" title="13.7.6.1&nbsp;SET Syntax for Variable Assignment">Section&nbsp;13.7.6.1, &ldquo;SET Syntax for Variable Assignment&rdquo;</a>. To change the value for the
            running MySQL instance without having it carry over to
            subsequent restarts, use the <code class="literal">GLOBAL</code>
            keyword rather than <code class="literal">PERSIST</code>.
          </p></li></ul></div><p>
        The global password verification-required policy applies to all
        accounts that have not been set to override it. To establish
        policy for individual accounts, use the <code class="literal">PASSWORD
        REQUIRE</code> options of the <a class="link" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement"><code class="literal">CREATE
        USER</code></a> and <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a>
        statements. See <a class="xref" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement">Section&nbsp;13.7.1.3, &ldquo;CREATE USER Statement&rdquo;</a>, and
        <a class="xref" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement">Section&nbsp;13.7.1.1, &ldquo;ALTER USER Statement&rdquo;</a>.
      </p><p>
        Example account-specific statements:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Require that password changes specify the current password:
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD REQUIRE CURRENT;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD REQUIRE CURRENT;
</pre><p>
            This verification option overrides the global policy for all
            accounts named by the statement.
          </p></li><li class="listitem"><p>
            Do not require that password changes specify the current
            password (the current password may but need not be given):
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD REQUIRE CURRENT OPTIONAL;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD REQUIRE CURRENT OPTIONAL;
</pre><p>
            This verification option overrides the global policy for all
            accounts named by the statement.
          </p></li><li class="listitem"><p>
            Defer to the global password verification-required policy
            for all accounts named by the statement:
          </p><pre class="programlisting">CREATE USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD REQUIRE CURRENT DEFAULT;
ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; PASSWORD REQUIRE CURRENT DEFAULT;
</pre></li></ul></div><p>
        Verification of the current password comes into play when a user
        changes a password using the <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER
        USER</code></a> or <a class="link" href="set-password.html" title="13.7.1.10&nbsp;SET PASSWORD Statement"><code class="literal">SET PASSWORD</code></a>
        statement. The examples use <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER
        USER</code></a>, which is preferred over <a class="link" href="set-password.html" title="13.7.1.10&nbsp;SET PASSWORD Statement"><code class="literal">SET
        PASSWORD</code></a>, but the principles described here are the
        same for both statements.
      </p><p>
        In password-change statements, a <code class="literal">REPLACE</code>
        clause specifies the current password to be replaced. Examples:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Change the current user&#39;s password:
          </p><pre class="programlisting">ALTER USER USER() IDENTIFIED BY &#39;<em class="replaceable"><code>auth_string</code></em>&#39; REPLACE &#39;<em class="replaceable"><code>current_auth_string</code></em>&#39;;
</pre></li><li class="listitem"><p>
            Change a named user&#39;s password:
          </p><pre class="programlisting">ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39;
  IDENTIFIED BY &#39;<em class="replaceable"><code>auth_string</code></em>&#39;
  REPLACE &#39;<em class="replaceable"><code>current_auth_string</code></em>&#39;;
</pre></li><li class="listitem"><p>
            Change a named user&#39;s authentication plugin and password:
          </p><pre class="programlisting">ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39;
  IDENTIFIED WITH caching_sha2_password BY &#39;<em class="replaceable"><code>auth_string</code></em>&#39;
  REPLACE &#39;<em class="replaceable"><code>current_auth_string</code></em>&#39;;
</pre></li></ul></div><p>
        The <code class="literal">REPLACE</code> clause works like this:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">REPLACE</code> must be given if password changes
            for the account are required to specify the current
            password, as verification that the user attempting to make
            the change actually knows the current password.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLACE</code> is optional if password changes
            for the account may but need not specify the current
            password.
          </p></li><li class="listitem"><p>
            If <code class="literal">REPLACE</code> is specified, it must specify
            the correct current password, or an error occurs. This is
            true even if <code class="literal">REPLACE</code> is optional.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLACE</code> can be specified only when
            changing the account password for the current user. (This
            means that in the examples just shown, the statements that
            explicitly name the account for <code class="literal">jeffrey</code>
            fail unless the current user is <code class="literal">jeffrey</code>.)
            This is true even if the change is attempted for another
            user by a privileged user; however, such a user can change
            any password without specifying <code class="literal">REPLACE</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">REPLACE</code> is omitted from the binary log to
            avoid writing cleartext passwords to it.
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-3091"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Dual%20Password%20Support"></a><h4 class="title"><a id="dual-passwords"></a>Dual Password Support</h4></div></div></div><a id="idm45828976124416" class="indexterm"></a><a id="idm45828976122928" class="indexterm"></a><a id="idm45828976121856" class="indexterm"></a><a id="idm45828976120784" class="indexterm"></a><p>
        As of MySQL 8.0.14, user accounts are permitted to have dual
        passwords, designated as primary and secondary passwords.
        Dual-password capability makes it possible to seamlessly perform
        credential changes in scenarios like this:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A system has a large number of MySQL servers, possibly
            involving replication.
          </p></li><li class="listitem"><p>
            Multiple applications connect to different MySQL servers.
          </p></li><li class="listitem"><p>
            Periodic credential changes must be made to the account or
            accounts used by the applications to connect to the servers.
          </p></li></ul></div><p>
        Consider how a credential change must be performed in the
        preceding type of scenario when an account is permitted only a
        single password. In this case, there must be close cooperation
        in the timing of when the account password change is made and
        propagated throughout all servers, and when all applications
        that use the account are updated to use the new password. This
        process may involve downtime during which servers or
        applications are unavailable.
      </p><p>
        With dual passwords, credential changes can be made more easily,
        in phases, without requiring close cooperation, and without
        downtime:
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            For each affected account, establish a new primary password
            on the servers, retaining the current password as the
            secondary password. This enables servers to recognize either
            the primary or secondary password for each account, while
            applications can continue to connect to the servers using
            the same password as previously (which is now the secondary
            password).
          </p></li><li class="listitem"><p>
            After the password change has propagated to all servers,
            modify applications that use any affected account to connect
            using the account primary password.
          </p></li><li class="listitem"><p>
            After all applications have been migrated from the secondary
            passwords to the primary passwords, the secondary passwords
            are no longer needed and can be discarded. After this change
            has propagated to all servers, only the primary password for
            each account can be used to connect. The credential change
            is now complete.
          </p></li></ol></div><p>
        MySQL implements dual-password capability with syntax that saves
        and discards secondary passwords:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The <code class="literal">RETAIN CURRENT PASSWORD</code> clause for
            the <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a> and
            <a class="link" href="set-password.html" title="13.7.1.10&nbsp;SET PASSWORD Statement"><code class="literal">SET PASSWORD</code></a> statements saves
            an account current password as its secondary password when
            you assign a new primary password.
          </p></li><li class="listitem"><p>
            The <code class="literal">DISCARD OLD PASSWORD</code> clause for
            <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a> discards an
            account secondary password, leaving only the primary
            password.
          </p></li></ul></div><p>
        Suppose that, for the previously described credential-change
        scenario, an account named
        <code class="literal">&#39;appuser1&#39;@&#39;host1.example.com&#39;</code> is used by
        applications to connect to servers, and that the account
        password is to be changed from
        <code class="literal">&#39;<em class="replaceable"><code>password_a</code></em>&#39;</code> to
        <code class="literal">&#39;<em class="replaceable"><code>password_b</code></em>&#39;</code>.
      </p><p>
        To perform this change of credentials, use <code class="literal">ALTER
        USER</code> as follows:
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            On each server that is not a replica, establish
            <code class="literal">&#39;<em class="replaceable"><code>password_b</code></em>&#39;</code>
            as the new <code class="literal">appuser1</code> primary password,
            retaining the current password as the secondary password:
          </p><pre class="programlisting">ALTER USER &#39;appuser1&#39;@&#39;host1.example.com&#39;
  IDENTIFIED BY &#39;<em class="replaceable"><code>password_b</code></em>&#39;
  RETAIN CURRENT PASSWORD;
</pre></li><li class="listitem"><p>
            Wait for the password change to replicate throughout the
            system to all replicas.
          </p></li><li class="listitem"><p>
            Modify each application that uses the
            <code class="literal">appuser1</code> account so that it connects to
            the servers using a password of
            <code class="literal">&#39;<em class="replaceable"><code>password_b</code></em>&#39;</code>
            rather than
            <code class="literal">&#39;<em class="replaceable"><code>password_a</code></em>&#39;</code>.
          </p></li><li class="listitem"><p>
            At this point, the secondary password is no longer needed.
            On each server that is not a replica, discard the secondary
            password:
          </p><pre class="programlisting">ALTER USER &#39;appuser1&#39;@&#39;host1.example.com&#39;
  DISCARD OLD PASSWORD;
</pre></li><li class="listitem"><p>
            After the discard-password change has replicated to all
            replicas, the credential change is complete.
          </p></li></ol></div><p>
        The <code class="literal">RETAIN CURRENT PASSWORD</code> and
        <code class="literal">DISCARD OLD PASSWORD</code> clauses have the
        following effects:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">RETAIN CURRENT PASSWORD</code> retains an
            account current password as its secondary password,
            replacing any existing secondary password. The new password
            becomes the primary password, but clients can use the
            account to connect to the server using either the primary or
            secondary password. (Exception: If the new password
            specified by the <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a>
            or <a class="link" href="set-password.html" title="13.7.1.10&nbsp;SET PASSWORD Statement"><code class="literal">SET PASSWORD</code></a> statement is
            empty, the secondary password becomes empty as well, even if
            <code class="literal">RETAIN CURRENT PASSWORD</code> is given.)
          </p></li><li class="listitem"><p>
            If you specify <code class="literal">RETAIN CURRENT PASSWORD</code>
            for an account that has an empty primary password, the
            statement fails.
          </p></li><li class="listitem"><p>
            If an account has a secondary password and you change its
            primary password without specifying <code class="literal">RETAIN CURRENT
            PASSWORD</code>, the secondary password remains
            unchanged.
          </p></li><li class="listitem"><p>
            For <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a>, if you change
            the authentication plugin assigned to the account, the
            secondary password is discarded. If you change the
            authentication plugin and also specify <code class="literal">RETAIN
            CURRENT PASSWORD</code>, the statement fails.
          </p></li><li class="listitem"><p>
            For <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a>,
            <code class="literal">DISCARD OLD PASSWORD</code> discards the
            secondary password, if one exists. The account retains only
            its primary password, and clients can use the account to
            connect to the server only with the primary password.
          </p></li></ul></div><p>
        Statements that modify secondary passwords require these
        privileges:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The
            <a class="link" href="privileges-provided.html#priv_application-password-admin"><code class="literal">APPLICATION_PASSWORD_ADMIN</code></a>
            privilege is required to use the <code class="literal">RETAIN CURRENT
            PASSWORD</code> or <code class="literal">DISCARD OLD
            PASSWORD</code> clause for <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER
            USER</code></a> and <a class="link" href="set-password.html" title="13.7.1.10&nbsp;SET PASSWORD Statement"><code class="literal">SET
            PASSWORD</code></a> statements that apply to your own
            account. The privilege is required to manipulate your own
            secondary password because most users require only one
            password.
          </p></li><li class="listitem"><p>
            If an account is to be permitted to manipulate secondary
            passwords for all accounts, it should be granted the
            <a class="link" href="privileges-provided.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege rather
            than
            <a class="link" href="privileges-provided.html#priv_application-password-admin"><code class="literal">APPLICATION_PASSWORD_ADMIN</code></a>.
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-3092"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Random%20Password%20Generation"></a><h4 class="title"><a id="random-password-generation"></a>Random Password Generation</h4></div></div></div><p>
        As of MySQL 8.0.18, the <a class="link" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement"><code class="literal">CREATE
        USER</code></a>, <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a>, and
        <a class="link" href="set-password.html" title="13.7.1.10&nbsp;SET PASSWORD Statement"><code class="literal">SET PASSWORD</code></a> statements have the
        capability of generating random passwords for user accounts, as
        an alternative to requiring explicit administrator-specified
        literal passwords. See the description of each statement for
        details about the syntax. This section describes the
        characteristics common to generated random passwords.
      </p><p>
        By default, generated random passwords have a length of 20
        characters. This length is controlled by the
        <a class="link" href="server-system-variables.html#sysvar_generated_random_password_length"><code class="literal">generated_random_password_length</code></a>
        system variable, which has a range from 5 to 255.
      </p><p>
        For each account for which a statement generates a random
        password, the statement stores the password in the
        <code class="literal">mysql.user</code> system table, hashed appropriately
        for the account authentication plugin. The statement also
        returns the cleartext password in a row of a result set to make
        it available to the user or application executing the statement.
        The result set columns are named <code class="literal">user</code>,
        <code class="literal">host</code>, <code class="literal">generated password</code>,
        and <code class="literal">auth_factor</code> indicating the user name and
        host name values that identify the affected row in the
        <code class="literal">mysql.user</code> system table, the cleartext
        generated password, and the authentication factor the displayed
        password value applies to.
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE USER</code></strong>
       <strong class="userinput"><code>&#39;u1&#39;@&#39;localhost&#39; IDENTIFIED BY RANDOM PASSWORD,</code></strong>
       <strong class="userinput"><code>&#39;u2&#39;@&#39;%.example.com&#39; IDENTIFIED BY RANDOM PASSWORD,</code></strong>
       <strong class="userinput"><code>&#39;u3&#39;@&#39;%.org&#39; IDENTIFIED BY RANDOM PASSWORD;</code></strong>
+------+---------------+----------------------+-------------+
| user | host          | generated password   | auth_factor |
+------+---------------+----------------------+-------------+
| u1   | localhost     | iOeqf&gt;Mh9:;XD&amp;qn(Hl} |           1 |
| u2   | %.example.com | sXTSAEvw3St-R+_-C3Vb |           1 |
| u3   | %.org         | nEVe%Ctw/U/*Md)Exc7&amp; |           1 |
+------+---------------+----------------------+-------------+
mysql&gt; <strong class="userinput"><code>ALTER USER</code></strong>
       <strong class="userinput"><code>&#39;u1&#39;@&#39;localhost&#39; IDENTIFIED BY RANDOM PASSWORD,</code></strong>
       <strong class="userinput"><code>&#39;u2&#39;@&#39;%.example.com&#39; IDENTIFIED BY RANDOM PASSWORD;</code></strong>
+------+---------------+----------------------+-------------+
| user | host          | generated password   | auth_factor |
+------+---------------+----------------------+-------------+
| u1   | localhost     | Seiei:&amp;cw}8]@3OA64vh |           1 |
| u2   | %.example.com | j@&amp;diTX80l8}(NiHXSae |           1 |
+------+---------------+----------------------+-------------+
mysql&gt; <strong class="userinput"><code>SET PASSWORD FOR &#39;u3&#39;@&#39;%.org&#39; TO RANDOM;</code></strong>
+------+-------+----------------------+-------------+
| user | host  | generated password   | auth_factor |
+------+-------+----------------------+-------------+
| u3   | %.org | n&amp;cz2xF;P3!U)+]Vw52H |           1 |
+------+-------+----------------------+-------------+
</pre><p>
        A <a class="link" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement"><code class="literal">CREATE USER</code></a>,
        <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a>, or
        <a class="link" href="set-password.html" title="13.7.1.10&nbsp;SET PASSWORD Statement"><code class="literal">SET PASSWORD</code></a> statement that
        generates a random password for an account is written to the
        binary log as a <a class="link" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement"><code class="literal">CREATE USER</code></a> or
        <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a> statement with an
        <code class="literal">IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em>
        AS &#39;<em class="replaceable"><code>auth_string</code></em>&#39;</code>, clause,
        where <em class="replaceable"><code>auth_plugin</code></em> is the account
        authentication plugin and
        <code class="literal">&#39;<em class="replaceable"><code>auth_string</code></em>&#39;</code> is
        the account hashed password value.
      </p><p>
        If the <code class="literal">validate_password</code> component is
        installed, the policy that it implements has no effect on
        generated passwords. (The purpose of password validation is to
        help humans create better passwords.)
      </p></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-3093"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Failed-Login%20Tracking%20and%20Temporary%20Account%20Locking"></a><h4 class="title"><a id="failed-login-tracking"></a>Failed-Login Tracking and Temporary Account Locking</h4></div></div></div><p>
        As of MySQL 8.0.19, administrators can configure user accounts
        such that too many consecutive login failures cause temporary
        account locking.
      </p><p>
        <span class="quote">&ldquo;<span class="quote">Login failure</span>&rdquo;</span> in this context means failure of
        the client to provide a correct password during a connection
        attempt. It does not include failure to connect for reasons such
        as unknown user or network issues. For accounts that have dual
        passwords (see <a class="xref" href="password-management.html#dual-passwords" title="Dual Password Support">Dual Password Support</a>), either account
        password counts as correct.
      </p><p>
        The required number of login failures and the lock time are
        configurable per account, using the
        <code class="literal">FAILED_LOGIN_ATTEMPTS</code> and
        <code class="literal">PASSWORD_LOCK_TIME</code> options of the
        <a class="link" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement"><code class="literal">CREATE USER</code></a> and
        <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a> statements. Examples:
      </p><pre class="programlisting">CREATE USER &#39;u1&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;<em class="replaceable"><code>password</code></em>&#39;
  FAILED_LOGIN_ATTEMPTS 3 PASSWORD_LOCK_TIME 3;

ALTER USER &#39;u2&#39;@&#39;localhost&#39;
  FAILED_LOGIN_ATTEMPTS 4 PASSWORD_LOCK_TIME UNBOUNDED;
</pre><p>
        When too many consecutive login failures occur, the client
        receives an error that looks like this:
      </p><pre class="programlisting">ERROR 3957 (HY000): Access denied for user <em class="replaceable"><code>user</code></em>.
Account is blocked for <em class="replaceable"><code>D</code></em> day(s) (<em class="replaceable"><code>R</code></em> day(s) remaining)
due to <em class="replaceable"><code>N</code></em> consecutive failed logins.
</pre><p>
        Use the options as follows:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">FAILED_LOGIN_ATTEMPTS
            <em class="replaceable"><code>N</code></em></code>
          </p><p>
            This option indicates whether to track account login
            attempts that specify an incorrect password. The number
            <em class="replaceable"><code>N</code></em> specifies how many consecutive
            incorrect passwords cause temporary account locking.
          </p></li><li class="listitem"><p>
            <code class="literal">PASSWORD_LOCK_TIME {<em class="replaceable"><code>N</code></em> |
            UNBOUNDED}</code>
          </p><p>
            This option indicates how long to lock the account after too
            many consecutive login attempts provide an incorrect
            password. The value is a number <em class="replaceable"><code>N</code></em>
            to specify the number of days the account remains locked, or
            <code class="literal">UNBOUNDED</code> to specify that when an account
            enters the temporarily locked state, the duration of that
            state is unbounded and does not end until the account is
            unlocked. The conditions under which unlocking occurs are
            described later.
          </p></li></ul></div><p>
        Permitted values of <em class="replaceable"><code>N</code></em> for each option
        are in the range from 0 to 32767. A value of 0 disables the
        option.
      </p><p>
        Failed-login tracking and temporary account locking have these
        characteristics:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For failed-login tracking and temporary locking to occur for
            an account, its <code class="literal">FAILED_LOGIN_ATTEMPTS</code> and
            <code class="literal">PASSWORD_LOCK_TIME</code> options both must be
            nonzero.
          </p></li><li class="listitem"><p>
            For <a class="link" href="create-user.html" title="13.7.1.3&nbsp;CREATE USER Statement"><code class="literal">CREATE USER</code></a>, if
            <code class="literal">FAILED_LOGIN_ATTEMPTS</code> or
            <code class="literal">PASSWORD_LOCK_TIME</code> is not specified, its
            implicit default value is 0 for all accounts named by the
            statement. This means that failed-login tracking and
            temporary account locking are disabled. (These implicit
            defaults also apply to accounts created prior to the
            introduction of failed-login tracking.)
          </p></li><li class="listitem"><p>
            For <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a>, if
            <code class="literal">FAILED_LOGIN_ATTEMPTS</code> or
            <code class="literal">PASSWORD_LOCK_TIME</code> is not specified, its
            value remains unchanged for all accounts named by the
            statement.
          </p></li><li class="listitem"><p>
            For temporary account locking to occur, password failures
            must be consecutive. Any successful login that occurs prior
            to reaching the <code class="literal">FAILED_LOGIN_ATTEMPTS</code>
            value for failed logins causes failure counting to reset.
            For example, if <code class="literal">FAILED_LOGIN_ATTEMPTS</code> is
            4 and three consecutive password failures have occurred, one
            more failure is necessary for locking to begin. But if the
            next login succeeds, failed-login counting for the account
            is reset so that four consecutive failures are again
            required for locking.
          </p></li><li class="listitem"><p>
            Once temporary locking begins, successful login cannot occur
            even with the correct password until either the lock
            duration has passed or the account is unlocked by one of the
            account-reset methods listed in the following discussion.
          </p></li></ul></div><p>
        When the server reads the grant tables, it initializes state
        information for each account regarding whether failed-login
        tracking is enabled, whether the account is currently
        temporarily locked and when locking began if so, and the number
        of failures before temporary locking occurs if the account is
        not locked.
      </p><p>
        An account&#39;s state information can be reset, which means that
        failed-login counting is reset, and the account is unlocked if
        currently temporarily locked. Account resets can be global for
        all accounts or per account:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A global reset of all accounts occurs for any of these
            conditions:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                A server restart.
              </p></li><li class="listitem"><p>
                Execution of <a class="link" href="flush.html#flush-privileges"><code class="literal">FLUSH
                PRIVILEGES</code></a>. (Starting the server with
                <a class="link" href="server-options.html#option_mysqld_skip-grant-tables"><code class="option">--skip-grant-tables</code></a>
                causes the grant tables not to be read, which disables
                failed-login tracking. In this case, the first execution
                of <a class="link" href="flush.html#flush-privileges"><code class="literal">FLUSH PRIVILEGES</code></a>
                causes the server to read the grant tables and enable
                failed-login tracking, in addition to resetting all
                accounts.)
              </p></li></ul></div></li><li class="listitem"><p>
            A per-account reset occurs for any of these conditions:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                Successful login for the account.
              </p></li><li class="listitem"><p>
                The lock duration passes. In this case, failed-login
                counting resets at the time of the next login attempt.
              </p></li><li class="listitem"><p>
                Execution of an <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER
                USER</code></a> statement for the account that sets
                either <code class="literal">FAILED_LOGIN_ATTEMPTS</code> or
                <code class="literal">PASSWORD_LOCK_TIME</code> (or both) to any
                value (including the current option value), or execution
                of an <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER
                USER ... UNLOCK</code></a> statement for the account.
              </p><p>
                Other <a class="link" href="alter-user.html" title="13.7.1.1&nbsp;ALTER USER Statement"><code class="literal">ALTER USER</code></a>
                statements for the account have no effect on its current
                failed-login count or its locking state.
              </p></li></ul></div></li></ul></div><p>
        Failed-login tracking is tied to the login account that is used
        to check credentials. If user proxying is in use, tracking
        occurs for the proxy user, not the proxied user. That is,
        tracking is tied to the account indicated by
        <a class="link" href="information-functions.html#function_user"><code class="literal">USER()</code></a>, not the account indicated
        by <a class="link" href="information-functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. For
        information about the distinction between proxy and proxied
        users, see <a class="xref" href="proxy-users.html" title="6.2.19&nbsp;Proxy Users">Section&nbsp;6.2.19, &ldquo;Proxy Users&rdquo;</a>.
      </p></div></div><div class="navigation"><ul><li class="navLinkPrevious"><a title="Go To Previous Page" href="assigning-passwords.html">Previous <span class="navHint"> Assigning Account Passwords </span></a></li><li class="navLinkHome"><a title="Go To Home Page" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a title="Go Up A Level In The Navigation" href="access-control.html">Up <span class="navHint"> Access Control and Account Management </span></a></li><li class="navLinkNext"><a title="Go To Next Page" href="expired-password-handling.html">Next <span class="navHint"> Server Handling of Expired Passwords </span></a></li></ul></div><div class="dochomelink-footer"><a title="Go to MySQL Doc Library" href="https://docs.oracle.com/cd/E17952_01/index.html">
        MySQL Documentation Library
      </a></div><div class="copyright-footer"></div></body></html>