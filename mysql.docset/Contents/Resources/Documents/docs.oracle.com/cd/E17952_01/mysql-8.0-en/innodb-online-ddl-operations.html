<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><a class="dashingAutolink" name="autolink-1585"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/15.12.1%C2%A0Online%20DDL%20Operations"></a><title>15.12.1&nbsp;Online DDL Operations</title><link rel="stylesheet" type="text/css" href="mvl-otn.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/><link rel="home" href="performance-schema" title="MySQL 8.0 Reference Manual"/><link rel="up" href="innodb-online-ddl.html" title="15.12&nbsp;InnoDB and Online DDL"/><link rel="prev" href="innodb-online-ddl.html" title="15.12&nbsp;InnoDB and Online DDL"/><link rel="next" href="innodb-online-ddl-performance.html" title="15.12.2&nbsp;Online DDL Performance and Concurrency"/><script>window.ohcglobal || document.write('<script src="../../../en/dcommon/js/global.js">\x3C/script>')</script></head><body><div class="skip-link"><a href="innodb-online-ddl-operations.html#innodb-online-ddl-operations">Skip to Main Content</a></div><div class="DocTitle"><p>MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0</p></div><div class="navigation"><ul><li class="navLinkPrevious"><a accesskey="p" title="Go To Previous Page&nbsp;[access key: p]" href="innodb-online-ddl.html">Previous <span class="navHint"> InnoDB and Online DDL </span></a></li><li class="navLinkHome"><a accesskey="h" title="Go To Home Page&nbsp;[access key: h]" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a accesskey="u" title="Go Up A Level In The Navigation&nbsp;[access key: u]" href="innodb-online-ddl.html">Up <span class="navHint"> InnoDB and Online DDL </span></a></li><li class="navLinkNext"><a accesskey="n" title="Go To Next Page&nbsp;[access key: n]" href="innodb-online-ddl-performance.html">Next <span class="navHint"> Online DDL Performance and Concurrency </span></a></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="innodb-online-ddl-operations"></a>15.12.1&nbsp;Online DDL Operations</h3></div></div></div><a id="idm45828885530720" class="indexterm"></a><p>
      Online support details, syntax examples, and usage notes for DDL
      operations are provided under the following topics in this
      section.
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="innodb-online-ddl-operations.html#online-ddl-index-operations" title="Index Operations">Index Operations</a></p></li><li class="listitem"><p><a class="xref" href="innodb-online-ddl-operations.html#online-ddl-primary-key-operations" title="Primary Key Operations">Primary Key Operations</a></p></li><li class="listitem"><p><a class="xref" href="innodb-online-ddl-operations.html#online-ddl-column-operations" title="Column Operations">Column Operations</a></p></li><li class="listitem"><p><a class="xref" href="innodb-online-ddl-operations.html#online-ddl-generated-column-operations" title="Generated Column Operations">Generated Column Operations</a></p></li><li class="listitem"><p><a class="xref" href="innodb-online-ddl-operations.html#online-ddl-foreign-key-operations" title="Foreign Key Operations">Foreign Key Operations</a></p></li><li class="listitem"><p><a class="xref" href="innodb-online-ddl-operations.html#online-ddl-table-operations" title="Table Operations">Table Operations</a></p></li><li class="listitem"><p><a class="xref" href="innodb-online-ddl-operations.html#online-ddl-tablespace-operations" title="Tablespace Operations">Tablespace Operations</a></p></li><li class="listitem"><p><a class="xref" href="innodb-online-ddl-operations.html#online-ddl-partitioning" title="Partitioning Operations">Partitioning Operations</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-1586"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Index%20Operations"></a><h4 class="title"><a id="online-ddl-index-operations"></a>Index Operations</h4></div></div></div><p>
        The following table provides an overview of online DDL support
        for index operations. An asterisk indicates additional
        information, an exception, or a dependency. For details, see
        <a class="xref" href="innodb-online-ddl-operations.html#online-ddl-index-syntax-notes" title="Syntax and Usage Notes">Syntax and Usage Notes</a>.
      </p><div class="table"><a id="online-ddl-index-operations-table"></a><p class="title"><strong>Table&nbsp;15.16&nbsp;Online DDL Support for Index Operations</strong></p><div class="table-contents"><table summary="Online DDL support for index operations indicating whether the operation is performed in place, rebuilds the table, permits concurrent DML, or only modifies metadata."><colgroup><col style="width: 16%" align="left"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/></colgroup><thead><tr>
            <th scope="col">Operation</th>
            <th scope="col">Instant</th>
            <th scope="col">In Place</th>
            <th scope="col">Rebuilds Table</th>
            <th scope="col">Permits Concurrent DML</th>
            <th scope="col">Only Modifies Metadata</th>
          </tr></thead><tbody><tr>
            <th scope="row">Creating or adding a secondary index</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Dropping an index</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Renaming an index</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Adding a <code class="literal">FULLTEXT</code> index</th>
            <td>No</td>
            <td>Yes*</td>
            <td>No*</td>
            <td>No</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Adding a <code class="literal">SPATIAL</code> index</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>No</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Changing the index type</th>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr></tbody></table></div></div><br class="table-break"/><h5><a id="online-ddl-index-syntax-notes"></a>Syntax and Usage Notes</h5><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Creating or adding a secondary index
          </p><pre class="programlisting">CREATE INDEX <em class="replaceable"><code>name</code></em> ON <em class="replaceable"><code>table</code></em> (<em class="replaceable"><code>col_list</code></em>);
</pre><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ADD INDEX <em class="replaceable"><code>name</code></em> (<em class="replaceable"><code>col_list</code></em>);
</pre><p>
            The table remains available for read and write operations
            while the index is being created. The
            <a class="link" href="create-index.html" title="13.1.15&nbsp;CREATE INDEX Statement"><code class="literal">CREATE INDEX</code></a> statement only
            finishes after all transactions that are accessing the table
            are completed, so that the initial state of the index
            reflects the most recent contents of the table.
          </p><p>
            Online DDL support for adding secondary indexes means that
            you can generally speed the overall process of creating and
            loading a table and associated indexes by creating the table
            without secondary indexes, then adding secondary indexes
            after the data is loaded.
          </p><p>
            A newly created secondary index contains only the committed
            data in the table at the time the
            <a class="link" href="create-index.html" title="13.1.15&nbsp;CREATE INDEX Statement"><code class="literal">CREATE INDEX</code></a> or
            <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> statement
            finishes executing. It does not contain any uncommitted
            values, old versions of values, or values marked for
            deletion but not yet removed from the old index.
          </p><p>
            Some factors affect the performance, space usage, and
            semantics of this operation. For details, see
            <a class="xref" href="innodb-online-ddl-limitations.html" title="15.12.8&nbsp;Online DDL Limitations">Section&nbsp;15.12.8, &ldquo;Online DDL Limitations&rdquo;</a>.
          </p></li><li class="listitem"><p>
            Dropping an index
          </p><pre class="programlisting">DROP INDEX <em class="replaceable"><code>name</code></em> ON <em class="replaceable"><code>table</code></em>;
</pre><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DROP INDEX <em class="replaceable"><code>name</code></em>;
</pre><p>
            The table remains available for read and write operations
            while the index is being dropped. The
            <a class="link" href="drop-index.html" title="13.1.27&nbsp;DROP INDEX Statement"><code class="literal">DROP INDEX</code></a> statement only
            finishes after all transactions that are accessing the table
            are completed, so that the initial state of the index
            reflects the most recent contents of the table.
          </p></li><li class="listitem"><p>
            Renaming an index
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> RENAME INDEX <em class="replaceable"><code>old_index_name</code></em> TO <em class="replaceable"><code>new_index_name</code></em>, ALGORITHM=INPLACE, LOCK=NONE;
</pre></li><li class="listitem"><p>
            Adding a <code class="literal">FULLTEXT</code> index
          </p><pre class="programlisting">CREATE FULLTEXT INDEX <em class="replaceable"><code>name</code></em> ON table(<em class="replaceable"><code>column</code></em>);
</pre><p>
            Adding the first <code class="literal">FULLTEXT</code> index rebuilds
            the table if there is no user-defined
            <code class="literal">FTS_DOC_ID</code> column. Additional
            <code class="literal">FULLTEXT</code> indexes may be added without
            rebuilding the table.
          </p></li><li class="listitem"><p>
            Adding a <code class="literal">SPATIAL</code> index
          </p><pre class="programlisting">CREATE TABLE geom (g GEOMETRY NOT NULL);
ALTER TABLE geom ADD SPATIAL INDEX(g), ALGORITHM=INPLACE, LOCK=SHARED;
</pre></li><li class="listitem"><p>
            Changing the index type (<code class="literal">USING {BTREE |
            HASH}</code>)
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DROP INDEX i1, ADD INDEX i1(<em class="replaceable"><code>key_part,...</code></em>) USING BTREE, ALGORITHM=INSTANT;
</pre></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-1587"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Primary%20Key%20Operations"></a><h4 class="title"><a id="online-ddl-primary-key-operations"></a>Primary Key Operations</h4></div></div></div><p>
        The following table provides an overview of online DDL support
        for primary key operations. An asterisk indicates additional
        information, an exception, or a dependency. See
        <a class="xref" href="innodb-online-ddl-operations.html#online-ddl-primary-key-syntax-notes" title="Syntax and Usage Notes">Syntax and Usage Notes</a>.
      </p><div class="table"><a id="online-ddl-primary-key-operations-table"></a><p class="title"><strong>Table&nbsp;15.17&nbsp;Online DDL Support for Primary Key Operations</strong></p><div class="table-contents"><table summary="Online DDL support for primary key operations indicating whether the operation is performed in place, rebuilds the table, permits concurrent DML, or only modifies metadata."><colgroup><col style="width: 16%" align="left"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/></colgroup><thead><tr>
            <th scope="col">Operation</th>
            <th scope="col">Instant</th>
            <th scope="col">In Place</th>
            <th scope="col">Rebuilds Table</th>
            <th scope="col">Permits Concurrent DML</th>
            <th scope="col">Only Modifies Metadata</th>
          </tr></thead><tbody><tr>
            <th scope="row">Adding a primary key</th>
            <td>No</td>
            <td>Yes*</td>
            <td>Yes*</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Dropping a primary key</th>
            <td>No</td>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Dropping a primary key and adding another</th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
          </tr></tbody></table></div></div><br class="table-break"/><h5><a id="online-ddl-primary-key-syntax-notes"></a>Syntax and Usage Notes</h5><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Adding a primary key
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ADD PRIMARY KEY (<em class="replaceable"><code>column</code></em>), ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Rebuilds the table in place. Data is reorganized
            substantially, making it an expensive operation.
            <code class="literal">ALGORITHM=INPLACE</code> is not permitted under
            certain conditions if columns have to be converted to
            <code class="literal">NOT NULL</code>.
          </p><p>
            Restructuring the
            <a class="link" href="glossary.html#glos_clustered_index" title="clustered index">clustered index</a>
            always requires copying of table data. Thus, it is best to
            define the <a class="link" href="glossary.html#glos_primary_key" title="primary key">primary
            key</a> when you create a table, rather than issuing
            <code class="literal">ALTER TABLE ... ADD PRIMARY KEY</code> later.
          </p><p>
            When you create a <code class="literal">UNIQUE</code> or
            <code class="literal">PRIMARY KEY</code> index, MySQL must do some
            extra work. For <code class="literal">UNIQUE</code> indexes, MySQL
            checks that the table contains no duplicate values for the
            key. For a <code class="literal">PRIMARY KEY</code> index, MySQL also
            checks that none of the <code class="literal">PRIMARY KEY</code>
            columns contains a <code class="literal">NULL</code>.
          </p><p>
            

            When you add a primary key using the
            <code class="literal">ALGORITHM=COPY</code> clause, MySQL converts
            <code class="literal">NULL</code> values in the associated columns to
            default values: 0 for numbers, an empty string for
            character-based columns and BLOBs, and 0000-00-00 00:00:00
            for <code class="literal">DATETIME</code>. This is a non-standard
            behavior that Oracle recommends you not rely on. Adding a
            primary key using <code class="literal">ALGORITHM=INPLACE</code> is
            only permitted when the
            <a class="link" href="server-system-variables.html#sysvar_sql_mode"><code class="literal">SQL_MODE</code></a> setting includes
            the <code class="literal">strict_trans_tables</code> or
            <code class="literal">strict_all_tables</code> flags; when the
            <code class="literal">SQL_MODE</code> setting is strict,
            <code class="literal">ALGORITHM=INPLACE</code> is permitted, but the
            statement can still fail if the requested primary key
            columns contain <code class="literal">NULL</code> values. The
            <code class="literal">ALGORITHM=INPLACE</code> behavior is more
            standard-compliant.
          </p><p>
            If you create a table without a primary key,
            <code class="literal">InnoDB</code> chooses one for you, which can be
            the first <code class="literal">UNIQUE</code> key defined on
            <code class="literal">NOT NULL</code> columns, or a system-generated
            key. To avoid uncertainty and the potential space
            requirement for an extra hidden column, specify the
            <code class="literal">PRIMARY KEY</code> clause as part of the
            <a class="link" href="create-table.html" title="13.1.20&nbsp;CREATE TABLE Statement"><code class="literal">CREATE TABLE</code></a> statement.
          </p><p>
            MySQL creates a new clustered index by copying the existing
            data from the original table to a temporary table that has
            the desired index structure. Once the data is completely
            copied to the temporary table, the original table is renamed
            with a different temporary table name. The temporary table
            comprising the new clustered index is renamed with the name
            of the original table, and the original table is dropped
            from the database.
          </p><p>
            The online performance enhancements that apply to operations
            on secondary indexes do not apply to the primary key index.
            The rows of an InnoDB table are stored in a
            <a class="link" href="glossary.html#glos_clustered_index" title="clustered index">clustered index</a>
            organized based on the
            <a class="link" href="glossary.html#glos_primary_key" title="primary key">primary key</a>, forming
            what some database systems call an <span class="quote">&ldquo;<span class="quote">index-organized
            table</span>&rdquo;</span>. Because the table structure is closely tied
            to the primary key, redefining the primary key still
            requires copying the data.
          </p><p>
            When an operation on the primary key uses
            <code class="literal">ALGORITHM=INPLACE</code>, even though the data
            is still copied, it is more efficient than using
            <code class="literal">ALGORITHM=COPY</code> because:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                No undo logging or associated redo logging is required
                for <code class="literal">ALGORITHM=INPLACE</code>. These
                operations add overhead to DDL statements that use
                <code class="literal">ALGORITHM=COPY</code>.
              </p></li><li class="listitem"><p>
                The secondary index entries are pre-sorted, and so can
                be loaded in order.
              </p></li><li class="listitem"><p>
                The change buffer is not used, because there are no
                random-access inserts into the secondary indexes.
              </p></li></ul></div></li><li class="listitem"><p>
            Dropping a primary key
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DROP PRIMARY KEY, ALGORITHM=COPY;
</pre><p>
            Only <code class="literal">ALGORITHM=COPY</code> supports dropping a
            primary key without adding a new one in the same
            <code class="literal">ALTER TABLE</code> statement.
          </p></li><li class="listitem"><p>
            Dropping a primary key and adding another
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DROP PRIMARY KEY, ADD PRIMARY KEY (<em class="replaceable"><code>column</code></em>), ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Data is reorganized substantially, making it an expensive
            operation.
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-1588"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Column%20Operations"></a><h4 class="title"><a id="online-ddl-column-operations"></a>Column Operations</h4></div></div></div><p>
        The following table provides an overview of online DDL support
        for column operations. An asterisk indicates additional
        information, an exception, or a dependency. For details, see
        <a class="xref" href="innodb-online-ddl-operations.html#online-ddl-column-syntax-notes" title="Syntax and Usage Notes">Syntax and Usage Notes</a>.
      </p><div class="table"><a id="online-ddl-column-operations-table"></a><p class="title"><strong>Table&nbsp;15.18&nbsp;Online DDL Support for Column Operations</strong></p><div class="table-contents"><table summary="Online DDL support for column operations indicating whether the operation is performed in place, rebuilds the table, permits concurrent DML, or only modifies metadata."><colgroup><col style="width: 16%" align="left"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/></colgroup><thead><tr>
            <th scope="col">Operation</th>
            <th scope="col">Instant</th>
            <th scope="col">In Place</th>
            <th scope="col">Rebuilds Table</th>
            <th scope="col">Permits Concurrent DML</th>
            <th scope="col">Only Modifies Metadata</th>
          </tr></thead><tbody><tr>
            <th scope="row">Adding a column</th>
            <td>Yes*</td>
            <td>Yes</td>
            <td>No*</td>
            <td>Yes*</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Dropping a column</th>
            <td>Yes*</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Renaming a column</th>
            <td>Yes*</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes*</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Reordering columns</th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Setting a column default value</th>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Changing the column data type</th>
            <td>No</td>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Extending <code class="literal">VARCHAR</code> column size</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Dropping the column default value</th>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Changing the auto-increment value</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>No*</td>
          </tr><tr>
            <th scope="row">Making a column <code class="literal">NULL</code></th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes*</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Making a column <code class="literal">NOT NULL</code></th>
            <td>No</td>
            <td>Yes*</td>
            <td>Yes*</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Modifying the definition of an <code class="literal">ENUM</code> or
              <code class="literal">SET</code> column</th>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr></tbody></table></div></div><br class="table-break"/><h5><a id="online-ddl-column-syntax-notes"></a>Syntax and Usage Notes</h5><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Adding a column
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ADD COLUMN <em class="replaceable"><code>column_name</code></em> <em class="replaceable"><code>column_definition</code></em>, ALGORITHM=INSTANT;
</pre><p>
            <code class="literal">INSTANT</code> is the default algorithm as of
            MySQL 8.0.12, and <code class="literal">INPLACE</code> before that.
          </p><p>
            The following limitations apply when the
            <code class="literal">INSTANT</code> algorithm adds a column:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                A statement cannot combine the addition of a column with
                other <code class="literal">ALTER TABLE</code> actions that do not
                support the <code class="literal">INSTANT</code> algorithm.
              </p></li><li class="listitem"><p>
                The <code class="literal">INSTANT</code> algorithm can add a
                column at any position in the table. Before MySQL
                8.0.29, the <code class="literal">INSTANT</code> algorithm could
                only add a column as the last column of the table.
              </p></li><li class="listitem"><p>
                Columns cannot be added to tables that use
                <code class="literal">ROW_FORMAT=COMPRESSED</code>, tables with a
                <code class="literal">FULLTEXT</code> index, tables that reside in
                the data dictionary tablespace, or temporary tables.
                Temporary tables only support
                <code class="literal">ALGORITHM=COPY</code>.
              </p></li><li class="listitem"><p>
                MySQL checks the row size when the
                <code class="literal">INSTANT</code> algorithm adds a column, and
                throws the following error if the addition exceeds the
                limit.
              </p><p>
                <span class="errortext">ERROR 4092 (HY000): Column can&#39;t be added
                with ALGORITHM=INSTANT as after this max possible row
                size crosses max permissible row size. Try
                ALGORITHM=INPLACE/COPY.</span>
              </p><p>
                Before MySQL 8.0.29, MySQL does not check the row size
                when the <code class="literal">INSTANT</code> algorithm adds a
                column. However, MySQL does check the row size during
                DML operations that insert and update rows in the table.
              </p></li><li class="listitem"><p>
                The maximum number of columns in the internal
                representation of the table cannot exceed 1022 after
                column addition with the <code class="literal">INSTANT</code>
                algorithm. The error message is:
              </p><p>
                <span class="errortext">ERROR 4158 (HY000): Column can&#39;t be added to
                <em class="replaceable"><code>tbl_name</code></em> with
                ALGORITHM=INSTANT anymore. Please try
                ALGORITHM=INPLACE/COPY</span>
              </p></li></ul></div><p>
            Multiple columns may be added in the same
            <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> statement. For
            example:
          </p><pre class="programlisting">ALTER TABLE t1 ADD COLUMN c2 INT, ADD COLUMN c3 INT, ALGORITHM=INSTANT;
</pre><p>
            A new row version is created after each
            <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE ...
            ALGORITHM=INSTANT</code></a> operation that adds one or more
            columns, drops one or more columns, or adds and drops one or
            more columns in the same operation. The
            <code class="literal">INFORMATION_SCHEMA.INNODB_TABLES.TOTAL_ROW_VERSIONS</code>
            column tracks the number of row versions for a table. The
            value is incremented each time a column is instantly added
            or dropped. The initial value is 0.
          </p><pre class="programlisting">mysql&gt;  SELECT NAME, TOTAL_ROW_VERSIONS FROM INFORMATION_SCHEMA.INNODB_TABLES 
        WHERE NAME LIKE &#39;test/t1&#39;;
+---------+--------------------+
| NAME    | TOTAL_ROW_VERSIONS |
+---------+--------------------+
| test/t1 |                  0 |
+---------+--------------------+
</pre><p>
            When a table with instantly added or dropped columns is
            rebuilt by table-rebuilding <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE
            </code></a> or <a class="link" href="optimize-table.html" title="13.7.3.4&nbsp;OPTIMIZE TABLE Statement"><code class="literal">OPTIMIZE TABLE</code></a>
            operation, the <code class="literal">TOTAL_ROW_VERSIONS</code> value
            is reset to 0. The maximum number of row versions permitted
            is 64, as each row version requires additional space for
            table metadata. When the row version limit is reached,
            <code class="literal">ADD COLUMN</code> and <code class="literal">DROP
            COLUMN</code> operations using
            <code class="literal">ALGORITHM=INSTANT</code> are rejected with an
            error message that recommends rebuilding the table using the
            <code class="literal">COPY</code> or <code class="literal">INPLACE</code>
            algorithm.
          </p><p>
            <span class="errortext">ERROR 4080 (HY000): Maximum row versions reached
            for table test/t1. No more columns can be added or dropped
            instantly. Please use COPY/INPLACE.</span>
          </p><p>
            The following
            <a class="link" href="information-schema.html" title="Chapter&nbsp;26&nbsp;INFORMATION_SCHEMA Tables"><code class="literal">INFORMATION_SCHEMA</code></a> columns
            provide additional metadata for instantly added columns.
            Refer to the descriptions of those columns for more
            information. See
            <a class="xref" href="information-schema-innodb-columns-table.html" title="26.4.9&nbsp;The INFORMATION_SCHEMA INNODB_COLUMNS Table">Section&nbsp;26.4.9, &ldquo;The INFORMATION_SCHEMA INNODB_COLUMNS Table&rdquo;</a>,
            and
            <a class="xref" href="information-schema-innodb-tables-table.html" title="26.4.23&nbsp;The INFORMATION_SCHEMA INNODB_TABLES Table">Section&nbsp;26.4.23, &ldquo;The INFORMATION_SCHEMA INNODB_TABLES Table&rdquo;</a>.
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">INNODB_COLUMNS.DEFAULT_VALUE</code>
              </p></li><li class="listitem"><p>
                <code class="literal">INNODB_COLUMNS.HAS_DEFAULT</code>
              </p></li><li class="listitem"><p>
                <code class="literal">INNODB_TABLES.INSTANT_COLS</code>
              </p></li></ul></div><p>
            Concurrent DML is not permitted when adding an
            <a class="link" href="glossary.html#glos_auto_increment" title="auto-increment">auto-increment</a>
            column. Data is reorganized substantially, making it an
            expensive operation. At a minimum,
            <code class="literal">ALGORITHM=INPLACE, LOCK=SHARED</code> is
            required.
          </p><p>
            The table is rebuilt if <code class="literal">ALGORITHM=INPLACE</code>
            is used to add a column.
          </p></li><li class="listitem"><p>
            Dropping a column
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DROP COLUMN <em class="replaceable"><code>column_name</code></em>, ALGORITHM=INSTANT;
</pre><p>
            <code class="literal">INSTANT</code> is the default algorithm as of
            MySQL 8.0.29, and <code class="literal">INPLACE</code> before that.
          </p><p>
            The following limitations apply when the
            <code class="literal">INSTANT</code> algorithm is used to drop a
            column:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                Dropping a column cannot be combined in the same
                statement with other <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER
                TABLE</code></a> actions that do not support
                <code class="literal">ALGORITHM=INSTANT</code>.
              </p></li><li class="listitem"><p>
                Columns cannot be dropped from tables that use
                <code class="literal">ROW_FORMAT=COMPRESSED</code>, tables with a
                <code class="literal">FULLTEXT</code> index, tables that reside in
                the data dictionary tablespace, or temporary tables.
                Temporary tables only support
                <code class="literal">ALGORITHM=COPY</code>.
              </p></li></ul></div><p>
            Multiple columns may be dropped in the same
            <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> statement; for
            example:
          </p><pre class="programlisting">ALTER TABLE t1 DROP COLUMN c4, DROP COLUMN c5, ALGORITHM=INSTANT;
</pre><p>
            Each time a column is added or dropped using
            <code class="literal">ALGORITHM=INSTANT</code>, a new row version is
            created. The
            <code class="literal">INFORMATION_SCHEMA.INNODB_TABLES.TOTAL_ROW_VERSIONS</code>
            column tracks the number of row versions for a table. The
            value is incremented each time a column is instantly added
            or dropped. The initial value is 0.
          </p><pre class="programlisting">mysql&gt;  SELECT NAME, TOTAL_ROW_VERSIONS FROM INFORMATION_SCHEMA.INNODB_TABLES 
        WHERE NAME LIKE &#39;test/t1&#39;;
+---------+--------------------+
| NAME    | TOTAL_ROW_VERSIONS |
+---------+--------------------+
| test/t1 |                  0 |
+---------+--------------------+
</pre><p>
            When a table with instantly added or dropped columns is
            rebuilt by table-rebuilding <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE
            </code></a> or <a class="link" href="optimize-table.html" title="13.7.3.4&nbsp;OPTIMIZE TABLE Statement"><code class="literal">OPTIMIZE TABLE</code></a>
            operation, the <code class="literal">TOTAL_ROW_VERSIONS</code> value
            is reset to 0. The maximum number of row versions permitted
            is 64, as each row version requires additional space for
            table metadata. When the row version limit is reached,
            <code class="literal">ADD COLUMN</code> and <code class="literal">DROP
            COLUMN</code> operations using
            <code class="literal">ALGORITHM=INSTANT</code> are rejected with an
            error message that recommends rebuilding the table using the
            <code class="literal">COPY</code> or <code class="literal">INPLACE</code>
            algorithm.
          </p><p>
            <span class="errortext">ERROR 4080 (HY000): Maximum row versions reached
            for table test/t1. No more columns can be added or dropped
            instantly. Please use COPY/INPLACE.</span>
          </p><p>
            If an algorithm other than
            <code class="literal">ALGORITHM=INSTANT</code> is used, data is
            reorganized substantially, making it an expensive operation.
          </p></li><li class="listitem"><p>
            Renaming a column
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl</code></em> CHANGE <em class="replaceable"><code>old_col_name</code></em> <em class="replaceable"><code>new_col_name</code></em> <em class="replaceable"><code>data_type</code></em>, ALGORITHM=INSTANT, LOCK=NONE;
</pre><p>
            <code class="literal">ALGORITHM=INSTANT</code> support for renaming a
            column was added in MySQL 8.0.28. Earlier MySQL Server
            releases support only <code class="literal">ALGORITHM=INPLACE</code>
            and <code class="literal">ALGORITHM=COPY</code> when renaming a
            column.
          </p><p>
            To permit concurrent DML, keep the same data type and only
            change the column name.
          </p><p>
            When you keep the same data type and <code class="literal">[NOT]
            NULL</code> attribute, only changing the column name, the
            operation can always be performed online.
          </p><p>
            Renaming a column referenced from another table is only
            permitted with <code class="literal">ALGORITHM=INPLACE</code>. If you
            use <code class="literal">ALGORITHM=INSTANT</code>,
            <code class="literal">ALGORITHM=COPY</code>, or some other condition
            that causes the operation to use those algorithms, the
            <code class="literal">ALTER TABLE</code> statement fails.
          </p><p>
            <code class="literal">ALGORITHM=INSTANT</code> supports renaming a
            virtual column; <code class="literal">ALGORITHM=INPLACE</code> does
            not.
          </p><p>
            <code class="literal">ALGORITHM=INSTANT</code> and
            <code class="literal">ALGORITHM=INPLACE</code> do not support renaming
            a column when adding or dropping a virtual column in the
            same statement. In this case, only
            <code class="literal">ALGORITHM=COPY</code> is supported.
          </p></li><li class="listitem"><p>
            Reordering columns
          </p><p>
            To reorder columns, use <code class="literal">FIRST</code> or
            <code class="literal">AFTER</code> in <code class="literal">CHANGE</code> or
            <code class="literal">MODIFY</code> operations.
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> MODIFY COLUMN <em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definition</code></em> FIRST, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Data is reorganized substantially, making it an expensive
            operation.
          </p></li><li class="listitem"><p>
            Changing the column data type
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> CHANGE c1 c1 BIGINT, ALGORITHM=COPY;
</pre><p>
            Changing the column data type is only supported with
            <code class="literal">ALGORITHM=COPY</code>.
          </p></li><li class="listitem"><p>
            Extending <code class="literal">VARCHAR</code> column size
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> CHANGE COLUMN c1 c1 VARCHAR(255), ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            The number of length bytes required by a
            <a class="link" href="char.html" title="11.3.2&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> column must remain
            the same. For <a class="link" href="char.html" title="11.3.2&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> columns
            of 0 to 255 bytes in size, one length byte is required to
            encode the value. For <a class="link" href="char.html" title="11.3.2&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>
            columns of 256 bytes in size or more, two length bytes are
            required. As a result, in-place <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER
            TABLE</code></a> only supports increasing
            <a class="link" href="char.html" title="11.3.2&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> column size from 0 to
            255 bytes, or from 256 bytes to a greater size. In-place
            <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> does not support
            increasing the size of a
            <a class="link" href="char.html" title="11.3.2&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> column from less than
            256 bytes to a size equal to or greater than 256 bytes. In
            this case, the number of required length bytes changes from
            1 to 2, which is only supported by a table copy
            (<code class="literal">ALGORITHM=COPY</code>). For example, attempting
            to change <a class="link" href="char.html" title="11.3.2&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> column size
            for a single byte character set from VARCHAR(255) to
            VARCHAR(256) using in-place <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER
            TABLE</code></a> returns this error:
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ALGORITHM=INPLACE, CHANGE COLUMN c1 c1 VARCHAR(256);
ERROR 0A000: ALGORITHM=INPLACE is not supported. Reason: Cannot change
column type INPLACE. Try ALGORITHM=COPY.
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
              The byte length of a <code class="literal">VARCHAR</code> column is
              dependant on the byte length of the character set.
            </p></div><p>
            Decreasing <a class="link" href="char.html" title="11.3.2&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> size using
            in-place <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> is not
            supported. Decreasing <a class="link" href="char.html" title="11.3.2&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>
            size requires a table copy
            (<code class="literal">ALGORITHM=COPY</code>).
          </p></li><li class="listitem"><p>
            Setting a column default value
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ALTER COLUMN <em class="replaceable"><code>col</code></em> SET DEFAULT <em class="replaceable"><code>literal</code></em>, ALGORITHM=INSTANT;
</pre><p>
            Only modifies table metadata. Default column values are
            stored in the <a class="link" href="glossary.html#glos_data_dictionary" title="data dictionary">data
            dictionary</a>.
          </p></li><li class="listitem"><p>
            Dropping a column default value
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl</code></em> ALTER COLUMN <em class="replaceable"><code>col</code></em> DROP DEFAULT, ALGORITHM=INSTANT;
</pre></li><li class="listitem"><p>
            Changing the auto-increment value
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>table</code></em> AUTO_INCREMENT=<em class="replaceable"><code>next_value</code></em>, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Modifies a value stored in memory, not the data file.
          </p><p>
            In a distributed system using replication or sharding, you
            sometimes reset the auto-increment counter for a table to a
            specific value. The next row inserted into the table uses
            the specified value for its auto-increment column. You might
            also use this technique in a data warehousing environment
            where you periodically empty all the tables and reload them,
            and restart the auto-increment sequence from 1.
          </p></li><li class="listitem"><p>
            Making a column <code class="literal">NULL</code>
          </p><pre class="programlisting">ALTER TABLE tbl_name MODIFY COLUMN <em class="replaceable"><code>column_name</code></em> <em class="replaceable"><code>data_type</code></em> NULL, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Rebuilds the table in place. Data is reorganized
            substantially, making it an expensive operation.
          </p></li><li class="listitem"><p>
            Making a column <code class="literal">NOT NULL</code>
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> MODIFY COLUMN <em class="replaceable"><code>column_name</code></em> <em class="replaceable"><code>data_type</code></em> NOT NULL, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Rebuilds the table in place.
            <code class="literal">STRICT_ALL_TABLES</code> or
            <code class="literal">STRICT_TRANS_TABLES</code>
            <a class="link" href="server-system-variables.html#sysvar_sql_mode"><code class="literal">SQL_MODE</code></a> is required for
            the operation to succeed. The operation fails if the column
            contains NULL values. The server prohibits changes to
            foreign key columns that have the potential to cause loss of
            referential integrity. See <a class="xref" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement">Section&nbsp;13.1.9, &ldquo;ALTER TABLE Statement&rdquo;</a>.
            Data is reorganized substantially, making it an expensive
            operation.
          </p></li><li class="listitem"><p>
            Modifying the definition of an <code class="literal">ENUM</code> or
            <code class="literal">SET</code> column
          </p><pre class="programlisting">CREATE TABLE t1 (c1 ENUM(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;));
ALTER TABLE t1 MODIFY COLUMN c1 ENUM(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;), ALGORITHM=INSTANT;
</pre><p>
            Modifying the definition of an
            <a class="link" href="enum.html" title="11.3.5&nbsp;The ENUM Type"><code class="literal">ENUM</code></a> or
            <a class="link" href="set.html" title="11.3.6&nbsp;The SET Type"><code class="literal">SET</code></a> column by adding new
            enumeration or set members to the <span class="emphasis"><em>end</em></span>
            of the list of valid member values may be performed
            instantly or in place, as long as the storage size of the
            data type does not change. For example, adding a member to a
            <a class="link" href="set.html" title="11.3.6&nbsp;The SET Type"><code class="literal">SET</code></a> column that has 8 members
            changes the required storage per value from 1 byte to 2
            bytes; this requires a table copy. Adding members in the
            middle of the list causes renumbering of existing members,
            which requires a table copy.
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-1589"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Generated%20Column%20Operations"></a><h4 class="title"><a id="online-ddl-generated-column-operations"></a>Generated Column Operations</h4></div></div></div><p>
        The following table provides an overview of online DDL support
        for generated column operations. For details, see
        <a class="xref" href="innodb-online-ddl-operations.html#online-ddl-generated-column-syntax-notes" title="Syntax and Usage Notes">Syntax and Usage Notes</a>.
      </p><div class="table"><a id="online-ddl-generated-column-operations-table"></a><p class="title"><strong>Table&nbsp;15.19&nbsp;Online DDL Support for Generated Column Operations</strong></p><div class="table-contents"><table summary="Online DDL support for generated column operations indicating whether the operation is performed in place, rebuilds the table, permits concurrent DML, or only modifies metadata."><colgroup><col style="width: 16%" align="left"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/></colgroup><thead><tr>
            <th scope="col">Operation</th>
            <th scope="col">Instant</th>
            <th scope="col">In Place</th>
            <th scope="col">Rebuilds Table</th>
            <th scope="col">Permits Concurrent DML</th>
            <th scope="col">Only Modifies Metadata</th>
          </tr></thead><tbody><tr>
            <th scope="row">Adding a <code class="literal">STORED</code> column</th>
            <td>No</td>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Modifying <code class="literal">STORED</code> column order</th>
            <td>No</td>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Dropping a <code class="literal">STORED</code> column</th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Adding a <code class="literal">VIRTUAL</code> column</th>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Modifying <code class="literal">VIRTUAL</code> column order</th>
            <td>No</td>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Dropping a <code class="literal">VIRTUAL</code> column</th>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr></tbody></table></div></div><br class="table-break"/><h5><a id="online-ddl-generated-column-syntax-notes"></a>Syntax and Usage Notes</h5><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Adding a <code class="literal">STORED</code> column
          </p><pre class="programlisting">ALTER TABLE t1 ADD COLUMN (c2 INT GENERATED ALWAYS AS (c1 + 1) STORED), ALGORITHM=COPY;
</pre><p>
            <code class="literal">ADD COLUMN</code> is not an in-place operation
            for stored columns (done without using a temporary table)
            because the expression must be evaluated by the server.
          </p></li><li class="listitem"><p>
            Modifying <code class="literal">STORED</code> column order
          </p><pre class="programlisting">ALTER TABLE t1 MODIFY COLUMN c2 INT GENERATED ALWAYS AS (c1 + 1) STORED FIRST, ALGORITHM=COPY;
</pre><p>
            Rebuilds the table in place.
          </p></li><li class="listitem"><p>
            Dropping a <code class="literal">STORED</code> column
          </p><pre class="programlisting">ALTER TABLE t1 DROP COLUMN c2, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Rebuilds the table in place.
          </p></li><li class="listitem"><p>
            Adding a <code class="literal">VIRTUAL</code> column
          </p><pre class="programlisting">ALTER TABLE t1 ADD COLUMN (c2 INT GENERATED ALWAYS AS (c1 + 1) VIRTUAL), ALGORITHM=INSTANT;
</pre><p>
            Adding a virtual column can be performed instantly or in
            place for non-partitioned tables.
          </p><p>
            Adding a <code class="literal">VIRTUAL</code> is not an in-place
            operation for partitioned tables.
          </p></li><li class="listitem"><p>
            Modifying <code class="literal">VIRTUAL</code> column order
          </p><pre class="programlisting">ALTER TABLE t1 MODIFY COLUMN c2 INT GENERATED ALWAYS AS (c1 + 1) VIRTUAL FIRST, ALGORITHM=COPY;
</pre></li><li class="listitem"><p>
            Dropping a <code class="literal">VIRTUAL</code> column
          </p><pre class="programlisting">ALTER TABLE t1 DROP COLUMN c2, ALGORITHM=INSTANT;
</pre><p>
            Dropping a <code class="literal">VIRTUAL</code> column can be
            performed instantly or in place for non-partitioned tables.
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-1590"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Foreign%20Key%20Operations"></a><h4 class="title"><a id="online-ddl-foreign-key-operations"></a>Foreign Key Operations</h4></div></div></div><p>
        The following table provides an overview of online DDL support
        for foreign key operations. An asterisk indicates additional
        information, an exception, or a dependency. For details, see
        <a class="xref" href="innodb-online-ddl-operations.html#online-ddl-foreign-key-syntax-notes" title="Syntax and Usage Notes">Syntax and Usage Notes</a>.
      </p><div class="table"><a id="online-ddl-foreign-key-operations-table"></a><p class="title"><strong>Table&nbsp;15.20&nbsp;Online DDL Support for Foreign Key Operations</strong></p><div class="table-contents"><table summary="Online DDL support for foreign key operations indicating whether the operation is performed in place, rebuilds the table, permits concurrent DML, or only modifies metadata."><colgroup><col style="width: 16%" align="left"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/></colgroup><thead><tr>
            <th scope="col">Operation</th>
            <th scope="col">Instant</th>
            <th scope="col">In Place</th>
            <th scope="col">Rebuilds Table</th>
            <th scope="col">Permits Concurrent DML</th>
            <th scope="col">Only Modifies Metadata</th>
          </tr></thead><tbody><tr>
            <th scope="row">Adding a foreign key constraint</th>
            <td>No</td>
            <td>Yes*</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Dropping a foreign key constraint</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr></tbody></table></div></div><br class="table-break"/><h5><a id="online-ddl-foreign-key-syntax-notes"></a>Syntax and Usage Notes</h5><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Adding a foreign key constraint
          </p><p>
            The <code class="literal">INPLACE</code> algorithm is supported when
            <a class="link" href="server-system-variables.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a> is
            disabled. Otherwise, only the <code class="literal">COPY</code>
            algorithm is supported.
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl1</code></em> ADD CONSTRAINT <em class="replaceable"><code>fk_name</code></em> FOREIGN KEY <em class="replaceable"><code>index</code></em> (<em class="replaceable"><code>col1</code></em>)
  REFERENCES <em class="replaceable"><code>tbl2</code></em>(<em class="replaceable"><code>col2</code></em>) <em class="replaceable"><code>referential_actions</code></em>;
</pre></li><li class="listitem"><p>
            Dropping a foreign key constraint
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl</code></em> DROP FOREIGN KEY <em class="replaceable"><code>fk_name</code></em>;
</pre><p>
            Dropping a foreign key can be performed online with the
            <a class="link" href="server-system-variables.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a> option
            enabled or disabled.
          </p><p>
            If you do not know the names of the foreign key constraints
            on a particular table, issue the following statement and
            find the constraint name in the
            <code class="literal">CONSTRAINT</code> clause for each foreign key:
          </p><pre class="programlisting">SHOW CREATE TABLE <em class="replaceable"><code>table</code></em>\G
</pre><p>
            Or, query the Information Schema
            <a class="link" href="information-schema-table-constraints-table.html" title="26.3.42&nbsp;The INFORMATION_SCHEMA TABLE_CONSTRAINTS Table"><code class="literal">TABLE_CONSTRAINTS</code></a> table and use
            the <code class="literal">CONSTRAINT_NAME</code> and
            <code class="literal">CONSTRAINT_TYPE</code> columns to identify the
            foreign key names.
          </p><p>
            You can also drop a foreign key and its associated index in
            a single statement:
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>table</code></em> DROP FOREIGN KEY <em class="replaceable"><code>constraint</code></em>, DROP INDEX <em class="replaceable"><code>index</code></em>;
</pre></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          If <a class="link" href="glossary.html#glos_foreign_key" title="foreign key">foreign keys</a> are
          already present in the table being altered (that is, it is a
          <a class="link" href="glossary.html#glos_child_table" title="child table">child table</a> containing
          a <code class="literal">FOREIGN KEY ... REFERENCE</code> clause),
          additional restrictions apply to online DDL operations, even
          those not directly involving the foreign key columns:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              An <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> on the child
              table could wait for another transaction to commit, if a
              change to the parent table causes associated changes in
              the child table through an <code class="literal">ON UPDATE</code> or
              <code class="literal">ON DELETE</code> clause using the
              <code class="literal">CASCADE</code> or <code class="literal">SET NULL</code>
              parameters.
            </p></li><li class="listitem"><p>
              In the same way, if a table is the
              <a class="link" href="glossary.html#glos_parent_table" title="parent table">parent table</a> in a
              foreign key relationship, even though it does not contain
              any <code class="literal">FOREIGN KEY</code> clauses, it could wait
              for the <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> to
              complete if an <a class="link" href="insert.html" title="13.2.7&nbsp;INSERT Statement"><code class="literal">INSERT</code></a>,
              <a class="link" href="update.html" title="13.2.17&nbsp;UPDATE Statement"><code class="literal">UPDATE</code></a>, or
              <a class="link" href="delete.html" title="13.2.2&nbsp;DELETE Statement"><code class="literal">DELETE</code></a> statement causes an
              <code class="literal">ON UPDATE</code> or <code class="literal">ON
              DELETE</code> action in the child table.
            </p></li></ul></div></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-1591"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Table%20Operations"></a><h4 class="title"><a id="online-ddl-table-operations"></a>Table Operations</h4></div></div></div><p>
        The following table provides an overview of online DDL support
        for table operations. An asterisk indicates additional
        information, an exception, or a dependency. For details, see
        <a class="xref" href="innodb-online-ddl-operations.html#online-ddl-table-syntax-notes" title="Syntax and Usage Notes">Syntax and Usage Notes</a>.
      </p><div class="table"><a id="online-ddl-table-operations-table"></a><p class="title"><strong>Table&nbsp;15.21&nbsp;Online DDL Support for Table Operations</strong></p><div class="table-contents"><table summary="Online DDL support for table operations indicating whether the operation is performed in place, rebuilds the table, permits concurrent DML, or only modifies metadata."><colgroup><col style="width: 16%" align="left"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/></colgroup><thead><tr>
            <th scope="col">Operation</th>
            <th scope="col">Instant</th>
            <th scope="col">In Place</th>
            <th scope="col">Rebuilds Table</th>
            <th scope="col">Permits Concurrent DML</th>
            <th scope="col">Only Modifies Metadata</th>
          </tr></thead><tbody><tr>
            <th scope="row">Changing the <code class="literal">ROW_FORMAT</code></th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Changing the <code class="literal">KEY_BLOCK_SIZE</code></th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Setting persistent table statistics</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Specifying a character set</th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes*</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Converting a character set</th>
            <td>No</td>
            <td>No</td>
            <td>Yes*</td>
            <td>No</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Optimizing a table</th>
            <td>No</td>
            <td>Yes*</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Rebuilding with the <code class="literal">FORCE</code> option</th>
            <td>No</td>
            <td>Yes*</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Performing a null rebuild</th>
            <td>No</td>
            <td>Yes*</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Renaming a table</th>
            <td>Yes</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr></tbody></table></div></div><br class="table-break"/><h5><a id="online-ddl-table-syntax-notes"></a>Syntax and Usage Notes</h5><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Changing the <code class="literal">ROW_FORMAT</code>
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ROW_FORMAT = <em class="replaceable"><code>row_format</code></em>, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Data is reorganized substantially, making it an expensive
            operation.
          </p><p>
            For additional information about the
            <code class="literal">ROW_FORMAT</code> option, see
            <a class="xref" href="create-table.html#create-table-options" title="Table Options">Table Options</a>.
          </p></li><li class="listitem"><p>
            Changing the <code class="literal">KEY_BLOCK_SIZE</code>
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> KEY_BLOCK_SIZE = <em class="replaceable"><code>value</code></em>, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Data is reorganized substantially, making it an expensive
            operation.
          </p><p>
            For additional information about the
            <code class="literal">KEY_BLOCK_SIZE</code> option, see
            <a class="xref" href="create-table.html#create-table-options" title="Table Options">Table Options</a>.
          </p></li><li class="listitem"><p>
            Setting persistent table statistics options
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> STATS_PERSISTENT=0, STATS_SAMPLE_PAGES=20, STATS_AUTO_RECALC=1, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Only modifies table metadata.
          </p><p>
            Persistent statistics include
            <code class="literal">STATS_PERSISTENT</code>,
            <code class="literal">STATS_AUTO_RECALC</code>, and
            <code class="literal">STATS_SAMPLE_PAGES</code>. For more information,
            see <a class="xref" href="innodb-persistent-stats.html" title="15.8.10.1&nbsp;Configuring Persistent Optimizer Statistics Parameters">Section&nbsp;15.8.10.1, &ldquo;Configuring Persistent Optimizer Statistics Parameters&rdquo;</a>.
          </p></li><li class="listitem"><p>
            Specifying a character set
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> CHARACTER SET = <em class="replaceable"><code>charset_name</code></em>, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Rebuilds the table if the new character encoding is
            different.
          </p></li><li class="listitem"><p>
            Converting a character set
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> CONVERT TO CHARACTER SET <em class="replaceable"><code>charset_name</code></em>, ALGORITHM=COPY;
</pre><p>
            Rebuilds the table if the new character encoding is
            different.
          </p></li><li class="listitem"><p>
            Optimizing a table
          </p><pre class="programlisting">OPTIMIZE TABLE <em class="replaceable"><code>tbl_name</code></em>;
</pre><p>
            In-place operation is not supported for tables with
            <code class="literal">FULLTEXT</code> indexes. The operation uses the
            <code class="literal">INPLACE</code> algorithm, but
            <code class="literal">ALGORITHM</code> and <code class="literal">LOCK</code>
            syntax is not permitted.
          </p></li><li class="listitem"><p>
            Rebuilding a table with the <code class="literal">FORCE</code> option
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> FORCE, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Uses <code class="literal">ALGORITHM=INPLACE</code> as of MySQL
            5.6.17<code class="literal"></code>. <code class="literal">ALGORITHM=INPLACE</code> is
            not supported for tables with <code class="literal">FULLTEXT</code>
            indexes.
          </p></li><li class="listitem"><p>
            Performing a &#34;null&#34; rebuild
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ENGINE=InnoDB, ALGORITHM=INPLACE, LOCK=NONE;
</pre><p>
            Uses <code class="literal">ALGORITHM=INPLACE</code> as of MySQL
            5.6.17. <code class="literal">ALGORITHM=INPLACE</code> is not
            supported for tables with <code class="literal">FULLTEXT</code>
            indexes.
          </p></li><li class="listitem"><p>
            Renaming a table
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>old_tbl_name</code></em> RENAME TO <em class="replaceable"><code>new_tbl_name</code></em>, ALGORITHM=INSTANT;
</pre><p>
            Renaming a table can be performed instantly or in place.
            MySQL renames files that correspond to the table
            <em class="replaceable"><code>tbl_name</code></em> without making a copy.
            (You can also use the <a class="link" href="rename-table.html" title="13.1.36&nbsp;RENAME TABLE Statement"><code class="literal">RENAME
            TABLE</code></a> statement to rename tables. See
            <a class="xref" href="rename-table.html" title="13.1.36&nbsp;RENAME TABLE Statement">Section&nbsp;13.1.36, &ldquo;RENAME TABLE Statement&rdquo;</a>.) Privileges granted
            specifically for the renamed table are not migrated to the
            new name. They must be changed manually.
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-1592"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Tablespace%20Operations"></a><h4 class="title"><a id="online-ddl-tablespace-operations"></a>Tablespace Operations</h4></div></div></div><p>
        The following table provides an overview of online DDL support
        for tablespace operations. For details, see
        <a class="xref" href="innodb-online-ddl-operations.html#online-ddl-tablespace-syntax-notes" title="Syntax and Usage Notes">Syntax and Usage Notes</a>.
      </p><div class="table"><a id="online-ddl-tablespace-operations-table"></a><p class="title"><strong>Table&nbsp;15.22&nbsp;Online DDL Support for Tablespace Operations</strong></p><div class="table-contents"><table summary="Online DDL support for tablespace operations indicating whether the operation is performed in place, rebuilds tables within the tablespace, permits concurrent DML, or only modifies metadata."><colgroup><col style="width: 16%" align="left"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/><col style="width: 16%" align="center"/></colgroup><thead><tr>
            <th scope="col">Operation</th>
            <th scope="col">Instant</th>
            <th scope="col">In Place</th>
            <th scope="col">Rebuilds Table</th>
            <th scope="col">Permits Concurrent DML</th>
            <th scope="col">Only Modifies Metadata</th>
          </tr></thead><tbody><tr>
            <th scope="row">Renaming a general tablespace</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
          </tr><tr>
            <th scope="row">Enabling or disabling general tablespace encryption</th>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
          </tr><tr>
            <th scope="row">Enabling or disabling file-per-table tablespace encryption</th>
            <td>No</td>
            <td>No</td>
            <td>Yes</td>
            <td>No</td>
            <td>No</td>
          </tr></tbody></table></div></div><br class="table-break"/><h5><a id="online-ddl-tablespace-syntax-notes"></a>Syntax and Usage Notes</h5><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Renaming a general tablespace
          </p><pre class="programlisting">ALTER TABLESPACE <em class="replaceable"><code>tablespace_name</code></em> RENAME TO <em class="replaceable"><code>new_tablespace_name</code></em>;
</pre><p>
            <a class="link" href="alter-tablespace.html" title="13.1.10&nbsp;ALTER TABLESPACE Statement"><code class="literal">ALTER
            TABLESPACE ... RENAME TO</code></a> uses the
            <code class="literal">INPLACE</code> algorithm but does not support
            the <code class="literal">ALGORITHM</code> clause.
          </p></li><li class="listitem"><p>
            Enabling or disabling general tablespace encryption
          </p><pre class="programlisting">ALTER TABLESPACE <em class="replaceable"><code>tablespace_name</code></em> ENCRYPTION=&#39;Y&#39;;
</pre><p>
            <a class="link" href="alter-tablespace.html" title="13.1.10&nbsp;ALTER TABLESPACE Statement"><code class="literal">ALTER
            TABLESPACE ... ENCRYPTION</code></a> uses the
            <code class="literal">INPLACE</code> algorithm but does not support
            the <code class="literal">ALGORITHM</code> clause.
          </p><p>
            For related information, see
            <a class="xref" href="innodb-data-encryption.html" title="15.13&nbsp;InnoDB Data-at-Rest Encryption">Section&nbsp;15.13, &ldquo;InnoDB Data-at-Rest Encryption&rdquo;</a>.
          </p></li><li class="listitem"><p>
            Enabling or disabling file-per-table tablespace encryption
          </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ENCRYPTION=&#39;Y&#39;, ALGORITHM=COPY;
</pre><p>
            For related information, see
            <a class="xref" href="innodb-data-encryption.html" title="15.13&nbsp;InnoDB Data-at-Rest Encryption">Section&nbsp;15.13, &ldquo;InnoDB Data-at-Rest Encryption&rdquo;</a>.
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><a class="dashingAutolink" name="autolink-1593"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Partitioning%20Operations"></a><h4 class="title"><a id="online-ddl-partitioning"></a>Partitioning Operations</h4></div></div></div><p>
        With the exception of some <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER
        TABLE</code></a> partitioning clauses, online DDL operations for
        partitioned <code class="literal">InnoDB</code> tables follow the same
        rules that apply to regular <code class="literal">InnoDB</code> tables.
      </p><p>
        Some <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> partitioning
        clauses do not go through the same internal online DDL API as
        regular non-partitioned <code class="literal">InnoDB</code> tables. As a
        result, online support for <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER
        TABLE</code></a> partitioning clauses varies.
      </p><p>
        The following table shows the online status for each
        <code class="literal">ALTER TABLE</code> partitioning statement.
        Regardless of the online DDL API that is used, MySQL attempts to
        minimize data copying and locking where possible.
      </p><p>
        <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> partitioning options
        that use <code class="literal">ALGORITHM=COPY</code> or that only permit
        <span class="quote">&ldquo;<span class="quote"><code class="literal">ALGORITHM=DEFAULT,
        LOCK=DEFAULT</code></span>&rdquo;</span>, repartition the table using the
        <code class="literal">COPY</code> algorithm. In other words, a new
        partitioned table is created with the new partitioning scheme.
        The newly created table includes any changes applied by the
        <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> statement, and table
        data is copied into the new table structure.
      </p><div class="table"><a id="innodb-online-ddl-partitioning-clauses"></a><p class="title"><strong>Table&nbsp;15.23&nbsp;Online DDL Support for Partitioning Operations</strong></p><div class="table-contents"><table summary="Online DDL support for partitioning operations indicating whether the operation is performed in place and permits concurrent DML."><colgroup><col style="width: 24%" align="left"/><col style="width: 8%" align="center"/><col style="width: 8%" align="center"/><col style="width: 12%" align="center"/><col style="width: 32%" align="left"/></colgroup><thead><tr>
            <th scope="col">Partitioning Clause</th>
            <th scope="col">Instant</th>
            <th scope="col">In Place</th>
            <th scope="col">Permits DML</th>
            <th scope="col">Notes</th>
          </tr></thead><tbody><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">PARTITION BY</code></a></th>
            <td>No</td>
            <td>No</td>
            <td>No</td>
            <td>Permits <code class="literal">ALGORITHM=COPY</code>,
              <code class="literal">LOCK={DEFAULT|SHARED|EXCLUSIVE}</code></td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ADD PARTITION</code></a></th>
            <td>No</td>
            <td>Yes*</td>
            <td>Yes*</td>
            <td><code class="literal">ALGORITHM=INPLACE,
              LOCK={DEFAULT|NONE|SHARED|EXCLUSISVE}</code> is
              supported for <code class="literal">RANGE</code> and
              <code class="literal">LIST</code> partitions,
              <code class="literal">ALGORITHM=INPLACE,
              LOCK={DEFAULT|SHARED|EXCLUSISVE}</code> for
              <code class="literal">HASH</code> and <code class="literal">KEY</code>
              partitions, and <code class="literal">ALGORITHM=COPY,
              LOCK={SHARED|EXCLUSIVE}</code> for all partition types.
              Does not copy existing data for tables partitioned by
              <code class="literal">RANGE</code> or <code class="literal">LIST</code>.
              Concurrent queries are permitted with
              <code class="literal">ALGORITHM=COPY</code> for tables partitioned
              by <code class="literal">HASH</code> or <code class="literal">LIST</code>, as
              MySQL copies the data while holding a shared lock.</td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">DROP PARTITION</code></a></th>
            <td>No</td>
            <td>Yes*</td>
            <td>Yes*</td>
            <td><p>
                <code class="literal">ALGORITHM=INPLACE,
                LOCK={DEFAULT|NONE|SHARED|EXCLUSIVE}</code> is
                supported. Does not copy data for tables partitioned by
                <code class="literal">RANGE</code> or <code class="literal">LIST</code>.
              </p><p>
                <code class="literal">DROP PARTITION</code> with
                <code class="literal">ALGORITHM=INPLACE</code> deletes data stored
                in the partition and drops the partition. However,
                <code class="literal">DROP PARTITION</code> with
                <code class="literal">ALGORITHM=COPY</code> or
                <a class="link" href="server-system-variables.html#sysvar_old_alter_table"><code class="literal">old_alter_table=ON</code></a>
                rebuilds the partitioned table and attempts to move data
                from the dropped partition to another partition with a
                compatible <code class="literal">PARTITION ... VALUES</code>
                definition. Data that cannot be moved to another
                partition is deleted.
              </p></td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">DISCARD PARTITION</code></a></th>
            <td>No</td>
            <td>No</td>
            <td>No</td>
            <td>Only permits <code class="literal">ALGORITHM=DEFAULT</code>,
              <code class="literal">LOCK=DEFAULT</code></td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">IMPORT PARTITION</code></a></th>
            <td>No</td>
            <td>No</td>
            <td>No</td>
            <td>Only permits <code class="literal">ALGORITHM=DEFAULT</code>,
              <code class="literal">LOCK=DEFAULT</code></td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">TRUNCATE
              PARTITION</code></a></th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Does not copy existing data. It merely deletes rows; it does not alter
              the definition of the table itself, or of any of its
              partitions.</td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">COALESCE
              PARTITION</code></a></th>
            <td>No</td>
            <td>Yes*</td>
            <td>No</td>
            <td><code class="literal">ALGORITHM=INPLACE, LOCK={DEFAULT|SHARED|EXCLUSIVE}</code> is
              supported.</td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">REORGANIZE
              PARTITION</code></a></th>
            <td>No</td>
            <td>Yes*</td>
            <td>No</td>
            <td><code class="literal">ALGORITHM=INPLACE, LOCK={DEFAULT|SHARED|EXCLUSIVE}</code> is
              supported.</td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">EXCHANGE
              PARTITION</code></a></th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td></td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ANALYZE PARTITION</code></a></th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td></td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">CHECK PARTITION</code></a></th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td></td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">OPTIMIZE
              PARTITION</code></a></th>
            <td>No</td>
            <td>No</td>
            <td>No</td>
            <td><code class="literal">ALGORITHM</code> and <code class="literal">LOCK</code> clauses are
              ignored. Rebuilds the entire table. See
              <a class="xref" href="partitioning-maintenance.html" title="24.3.4&nbsp;Maintenance of Partitions">Section&nbsp;24.3.4, &ldquo;Maintenance of Partitions&rdquo;</a>.</td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">REBUILD PARTITION</code></a></th>
            <td>No</td>
            <td>Yes*</td>
            <td>No</td>
            <td><code class="literal">ALGORITHM=INPLACE, LOCK={DEFAULT|SHARED|EXCLUSIVE}</code> is
              supported.</td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">REPAIR PARTITION</code></a></th>
            <td>No</td>
            <td>Yes</td>
            <td>Yes</td>
            <td></td>
          </tr><tr>
            <th scope="row"><a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">REMOVE
              PARTITIONING</code></a></th>
            <td>No</td>
            <td>No</td>
            <td>No</td>
            <td>Permits <code class="literal">ALGORITHM=COPY</code>,
              <code class="literal">LOCK={DEFAULT|SHARED|EXCLUSIVE}</code></td>
          </tr></tbody></table></div></div><br class="table-break"/><p>
        Non-partitioning online <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER
        TABLE</code></a> operations on partitioned tables follow the same
        rules that apply to regular tables. However,
        <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER TABLE</code></a> performs online
        operations on each table partition, which causes increased
        demand on system resources due to operations being performed on
        multiple partitions.
      </p><p>
        For additional information about <a class="link" href="alter-table.html" title="13.1.9&nbsp;ALTER TABLE Statement"><code class="literal">ALTER
        TABLE</code></a> partitioning clauses, see
        <a class="xref" href="alter-table.html#alter-table-partition-options" title="Partitioning Options">Partitioning Options</a>, and
        <a class="xref" href="alter-table-partition-operations.html" title="13.1.9.1&nbsp;ALTER TABLE Partition Operations">Section&nbsp;13.1.9.1, &ldquo;ALTER TABLE Partition Operations&rdquo;</a>. For
        information about partitioning in general, see
        <a class="xref" href="partitioning.html" title="Chapter&nbsp;24&nbsp;Partitioning">Chapter&nbsp;24, <em>Partitioning</em></a>.
      </p></div></div><div class="navigation"><ul><li class="navLinkPrevious"><a title="Go To Previous Page" href="innodb-online-ddl.html">Previous <span class="navHint"> InnoDB and Online DDL </span></a></li><li class="navLinkHome"><a title="Go To Home Page" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a title="Go Up A Level In The Navigation" href="innodb-online-ddl.html">Up <span class="navHint"> InnoDB and Online DDL </span></a></li><li class="navLinkNext"><a title="Go To Next Page" href="innodb-online-ddl-performance.html">Next <span class="navHint"> Online DDL Performance and Concurrency </span></a></li></ul></div><div class="dochomelink-footer"><a title="Go to MySQL Doc Library" href="https://docs.oracle.com/cd/E17952_01/index.html">
        MySQL Documentation Library
      </a></div><div class="copyright-footer"></div></body></html>