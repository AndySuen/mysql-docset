<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><a class="dashingAutolink" name="autolink-1757"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/11.5%C2%A0The%20JSON%20Data%20Type"></a><title>11.5&nbsp;The JSON Data Type</title><link rel="stylesheet" type="text/css" href="mvl-otn.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/><link rel="home" href="performance-schema" title="MySQL 8.0 Reference Manual"/><link rel="up" href="data-types.html" title="Chapter&nbsp;11&nbsp;Data Types"/><link rel="prev" href="using-spatial-indexes.html" title="11.4.11&nbsp;Using Spatial Indexes"/><link rel="next" href="data-type-defaults.html" title="11.6&nbsp;Data Type Default Values"/><script>window.ohcglobal || document.write('<script src="../../../en/dcommon/js/global.js">\x3C/script>')</script></head><body><div class="skip-link"><a href="json.html#json">Skip to Main Content</a></div><div class="DocTitle"><p>MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0</p></div><div class="navigation"><ul><li class="navLinkPrevious"><a accesskey="p" title="Go To Previous Page&nbsp;[access key: p]" href="using-spatial-indexes.html">Previous <span class="navHint"> Using Spatial Indexes </span></a></li><li class="navLinkHome"><a accesskey="h" title="Go To Home Page&nbsp;[access key: h]" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a accesskey="u" title="Go Up A Level In The Navigation&nbsp;[access key: u]" href="data-types.html">Up <span class="navHint"> Data Types </span></a></li><li class="navLinkNext"><a accesskey="n" title="Go To Next Page&nbsp;[access key: n]" href="data-type-defaults.html">Next <span class="navHint"> Data Type Default Values </span></a></li></ul></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="json"></a>11.5&nbsp;The JSON Data Type</h2></div></div></div><a id="idm45828938303440" class="indexterm"></a><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="json.html#json-values" title="Creating JSON Values">Creating JSON Values</a></p></li><li class="listitem"><p><a class="xref" href="json.html#json-normalization" title="Normalization, Merging, and Autowrapping of JSON Values">Normalization, Merging, and Autowrapping of JSON Values</a></p></li><li class="listitem"><p><a class="xref" href="json.html#json-paths" title="Searching and Modifying JSON Values">Searching and Modifying JSON Values</a></p></li><li class="listitem"><p><a class="xref" href="json.html#json-path-syntax" title="JSON Path Syntax">JSON Path Syntax</a></p></li><li class="listitem"><p><a class="xref" href="json.html#json-comparison" title="Comparison and Ordering of JSON Values">Comparison and Ordering of JSON Values</a></p></li><li class="listitem"><p><a class="xref" href="json.html#json-converting-between-types" title="Converting between JSON and non-JSON values">Converting between JSON and non-JSON values</a></p></li><li class="listitem"><p><a class="xref" href="json.html#json-aggregation" title="Aggregation of JSON Values">Aggregation of JSON Values</a></p></li></ul></div><p>
      MySQL supports a native <code class="literal">JSON</code> data type defined
      by <a class="ulink" href="https://tools.ietf.org/html/rfc7159" target="_top">RFC
      7159</a> that enables efficient access to data in JSON
      (JavaScript Object Notation) documents. The
      <code class="literal">JSON</code> data type provides these advantages over
      storing JSON-format strings in a string column:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Automatic validation of JSON documents stored in
          <code class="literal">JSON</code> columns. Invalid documents produce an
          error.
        </p></li><li class="listitem"><p>
          Optimized storage format. JSON documents stored in
          <code class="literal">JSON</code> columns are converted to an internal
          format that permits quick read access to document elements.
          When the server later must read a JSON value stored in this
          binary format, the value need not be parsed from a text
          representation. The binary format is structured to enable the
          server to look up subobjects or nested values directly by key
          or array index without reading all values before or after them
          in the document.
        </p></li></ul></div><p>
      MySQL 8.0 also supports the <span class="emphasis"><em>JSON Merge
      Patch</em></span> format defined in
      <a class="ulink" href="https://tools.ietf.org/html/rfc7396" target="_top">RFC 7396</a>,
      using the <a class="link" href="json-modification-functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH()</code></a>
      function. See the description of this function, as well as
      <a class="xref" href="json.html#json-normalization" title="Normalization, Merging, and Autowrapping of JSON Values">Normalization, Merging, and Autowrapping of JSON Values</a>, for examples and further
      information.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
        This discussion uses <code class="literal">JSON</code> in monotype to
        indicate specifically the JSON data type and <span class="quote">&ldquo;<span class="quote">JSON</span>&rdquo;</span>
        in regular font to indicate JSON data in general.
      </p></div><p>
      The space required to store a <code class="literal">JSON</code> document is
      roughly the same as for <a class="link" href="blob.html" title="11.3.4&nbsp;The BLOB and TEXT Types"><code class="literal">LONGBLOB</code></a> or
      <a class="link" href="blob.html" title="11.3.4&nbsp;The BLOB and TEXT Types"><code class="literal">LONGTEXT</code></a>; see
      <a class="xref" href="storage-requirements.html" title="11.7&nbsp;Data Type Storage Requirements">Section&nbsp;11.7, &ldquo;Data Type Storage Requirements&rdquo;</a>, for more information. It
      is important to keep in mind that the size of any JSON document
      stored in a <code class="literal">JSON</code> column is limited to the value
      of the <a class="link" href="server-system-variables.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a> system
      variable. (When the server is manipulating a JSON value internally
      in memory, it can be larger than this; the limit applies when the
      server stores it.) You can obtain the amount of space required to
      store a JSON document using the
      <a class="link" href="json-utility-functions.html#function_json-storage-size"><code class="literal">JSON_STORAGE_SIZE()</code></a> function; note
      that for a <a class="link" href="json.html" title="11.5&nbsp;The JSON Data Type"><code class="literal">JSON</code></a> column, the storage
      size&mdash;and thus the value returned by this function&mdash;is
      that used by the column prior to any partial updates that may have
      been performed on it (see the discussion of the JSON partial
      update optimization later in this section).
    </p><p>
      Prior to MySQL 8.0.13, a <code class="literal">JSON</code> column cannot
      have a non-<code class="literal">NULL</code> default value.
    </p><p>
      Along with the <code class="literal">JSON</code> data type, a set of SQL
      functions is available to enable operations on JSON values, such
      as creation, manipulation, and searching. The following discussion
      shows examples of these operations. For details about individual
      functions, see <a class="xref" href="json-functions.html" title="12.17&nbsp;JSON Functions">Section&nbsp;12.17, &ldquo;JSON Functions&rdquo;</a>.
    </p><p>
      A set of spatial functions for operating on GeoJSON values is also
      available. See <a class="xref" href="spatial-geojson-functions.html" title="12.16.11&nbsp;Spatial GeoJSON Functions">Section&nbsp;12.16.11, &ldquo;Spatial GeoJSON Functions&rdquo;</a>.
    </p><p>
      <code class="literal">JSON</code> columns, like columns of other binary
      types, are not indexed directly; instead, you can create an index
      on a generated column that extracts a scalar value from the
      <code class="literal">JSON</code> column. See
      <a class="xref" href="create-table-secondary-indexes.html#json-column-indirect-index" title="Indexing a Generated Column to Provide a JSON Column Index">Indexing a Generated Column to Provide a JSON Column Index</a>, for a detailed
      example.
    </p><p>
      The MySQL optimizer also looks for compatible indexes on virtual
      columns that match JSON expressions.
    </p><p>
      In MySQL 8.0.17 and later, the <a class="link" href="innodb-storage-engine.html" title="Chapter&nbsp;15&nbsp;The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>
      storage engine supports multi-valued indexes on JSON arrays. See
      <a class="xref" href="create-index.html#create-index-multi-valued" title="Multi-Valued Indexes">Multi-Valued Indexes</a>.
    </p><p>
      MySQL NDB Cluster 8.0 supports <code class="literal">JSON</code> columns and
      MySQL JSON functions, including creation of an index on a column
      generated from a <code class="literal">JSON</code> column as a workaround
      for being unable to index a <code class="literal">JSON</code> column. A
      maximum of 3 <code class="literal">JSON</code> columns per
      <a class="link" href="mysql-cluster.html" title="Chapter&nbsp;23&nbsp;MySQL NDB Cluster 8.0"><code class="literal">NDB</code></a> table is supported.
    </p><h3><a id="json-partial-updates"></a>Partial Updates of JSON Values</h3><p>
      In MySQL 8.0, the optimizer can perform a partial,
      in-place update of a <code class="literal">JSON</code> column instead of
      removing the old document and writing the new document in its
      entirety to the column. This optimization can be performed for an
      update that meets the following conditions:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The column being updated was declared as
          <code class="literal">JSON</code>.
        </p></li><li class="listitem"><p>
          The <a class="link" href="update.html" title="13.2.17&nbsp;UPDATE Statement"><code class="literal">UPDATE</code></a> statement uses any
          of the three functions
          <a class="link" href="json-modification-functions.html#function_json-set"><code class="literal">JSON_SET()</code></a>,
          <a class="link" href="json-modification-functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a>, or
          <a class="link" href="json-modification-functions.html#function_json-remove"><code class="literal">JSON_REMOVE()</code></a> to update the
          column. A direct assignment of the column value (for example,
          <code class="literal">UPDATE mytable SET jcol = &#39;{&#34;a&#34;: 10, &#34;b&#34;:
          25}&#39;</code>) cannot be performed as a partial update.
        </p><p>
          Updates of multiple <code class="literal">JSON</code> columns in a
          single <code class="literal">UPDATE</code> statement can be optimized in
          this fashion; MySQL can perform partial updates of only those
          columns whose values are updated using the three functions
          just listed.
        </p></li><li class="listitem"><p>
          The input column and the target column must be the same
          column; a statement such as <code class="literal">UPDATE mytable SET jcol1
          = JSON_SET(jcol2, &#39;$.a&#39;, 100)</code> cannot be performed as
          a partial update.
        </p><p>
          The update can use nested calls to any of the functions listed
          in the previous item, in any combination, as long as the input
          and target columns are the same.
        </p></li><li class="listitem"><p>
          All changes replace existing array or object values with new
          ones, and do not add any new elements to the parent object or
          array.
        </p></li><li class="listitem"><p>
          The value being replaced must be at least as large as the
          replacement value. In other words, the new value cannot be any
          larger than the old one.
        </p><p>
          A possible exception to this requirement occurs when a
          previous partial update has left sufficient space for the
          larger value. You can use the function
          <a class="link" href="json-utility-functions.html#function_json-storage-free"><code class="literal">JSON_STORAGE_FREE()</code></a> see how
          much space has been freed by any partial updates of a
          <code class="literal">JSON</code> column.
        </p></li></ul></div><p>
      Such partial updates can be written to the binary log using a
      compact format that saves space; this can be enabled by setting
      the <a class="link" href="replication-options-binary-log.html#sysvar_binlog_row_value_options"><code class="literal">binlog_row_value_options</code></a>
      system variable to <code class="literal">PARTIAL_JSON</code>.
    </p><p>
      It is important to distinguish the partial update of a
      <code class="literal">JSON</code> column value stored in a table from
      writing the partial update of a row to the binary log. It is
      possible for the complete update of a <code class="literal">JSON</code>
      column to be recorded in the binary log as a partial update. This
      can happen when either (or both) of the last two conditions from
      the previous list is not met but the other conditions are
      satisfied.
    </p><p>
      See also the description of
      <a class="link" href="replication-options-binary-log.html#sysvar_binlog_row_value_options"><code class="literal">binlog_row_value_options</code></a>.
    </p><p>
      The next few sections provide basic information regarding the
      creation and manipulation of JSON values.
    </p><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="json-values"></a>Creating JSON Values</h3></div></div></div><a id="idm45828938228976" class="indexterm"></a><a id="idm45828938227488" class="indexterm"></a><a id="idm45828938226000" class="indexterm"></a><a id="idm45828938224512" class="indexterm"></a><a id="idm45828938223024" class="indexterm"></a><a id="idm45828938221536" class="indexterm"></a><a id="idm45828938220048" class="indexterm"></a><a id="idm45828938218560" class="indexterm"></a><a id="idm45828938217072" class="indexterm"></a><a id="idm45828938215584" class="indexterm"></a><a id="idm45828938214096" class="indexterm"></a><a id="idm45828938212608" class="indexterm"></a><a id="idm45828938211120" class="indexterm"></a><a id="idm45828938209632" class="indexterm"></a><a id="idm45828938208144" class="indexterm"></a><a id="idm45828938206656" class="indexterm"></a><p>
        A JSON array contains a list of values separated by commas and
        enclosed within <code class="literal">[</code> and <code class="literal">]</code>
        characters:
      </p><pre class="programlisting">[&#34;abc&#34;, 10, null, true, false]
</pre><p>
        A JSON object contains a set of key-value pairs separated by
        commas and enclosed within <code class="literal">{</code> and
        <code class="literal">}</code> characters:
      </p><pre class="programlisting">{&#34;k1&#34;: &#34;value&#34;, &#34;k2&#34;: 10}
</pre><p>
        As the examples illustrate, JSON arrays and objects can contain
        scalar values that are strings or numbers, the JSON null
        literal, or the JSON boolean true or false literals. Keys in
        JSON objects must be strings. Temporal (date, time, or datetime)
        scalar values are also permitted:
      </p><pre class="programlisting">[&#34;12:18:29.000000&#34;, &#34;2015-07-29&#34;, &#34;2015-07-29 12:18:29.000000&#34;]
</pre><p>
        Nesting is permitted within JSON array elements and JSON object
        key values:
      </p><pre class="programlisting">[99, {&#34;id&#34;: &#34;HK500&#34;, &#34;cost&#34;: 75.99}, [&#34;hot&#34;, &#34;cold&#34;]]
{&#34;k1&#34;: &#34;value&#34;, &#34;k2&#34;: [10, 20]}
</pre><p>
        You can also obtain JSON values from a number of functions
        supplied by MySQL for this purpose (see
        <a class="xref" href="json-creation-functions.html" title="12.17.2&nbsp;Functions That Create JSON Values">Section&nbsp;12.17.2, &ldquo;Functions That Create JSON Values&rdquo;</a>) as well as by casting
        values of other types to the <code class="literal">JSON</code> type using
        <a class="link" href="cast-functions.html#function_cast"><code class="literal">CAST(<em class="replaceable"><code>value</code></em> AS
        JSON)</code></a> (see
        <a class="xref" href="json.html#json-converting-between-types" title="Converting between JSON and non-JSON values">Converting between JSON and non-JSON values</a>). The next
        several paragraphs describe how MySQL handles JSON values
        provided as input.
      </p><a id="idm45828938191616" class="indexterm"></a><a id="idm45828938190544" class="indexterm"></a><p>
        In MySQL, JSON values are written as strings. MySQL parses any
        string used in a context that requires a JSON value, and
        produces an error if it is not valid as JSON. These contexts
        include inserting a value into a column that has the
        <code class="literal">JSON</code> data type and passing an argument to a
        function that expects a JSON value (usually shown as
        <em class="replaceable"><code>json_doc</code></em> or
        <em class="replaceable"><code>json_val</code></em> in the documentation for
        MySQL JSON functions), as the following examples demonstrate:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Attempting to insert a value into a <code class="literal">JSON</code>
            column succeeds if the value is a valid JSON value, but
            fails if it is not:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (jdoc JSON);</code></strong>
Query OK, 0 rows affected (0.20 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUES(&#39;{&#34;key1&#34;: &#34;value1&#34;, &#34;key2&#34;: &#34;value2&#34;}&#39;);</code></strong>
Query OK, 1 row affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUES(&#39;[1, 2,&#39;);</code></strong>
ERROR 3140 (22032) at line 2: Invalid JSON text:
&#34;Invalid value.&#34; at position 6 in value (or column) &#39;[1, 2,&#39;.
</pre><p>
            Positions for <span class="quote">&ldquo;<span class="quote">at position
            <em class="replaceable"><code>N</code></em></span>&rdquo;</span> in such error messages
            are 0-based, but should be considered rough indications of
            where the problem in a value actually occurs.
          </p></li><li class="listitem"><p>
            The <a class="link" href="json-attribute-functions.html#function_json-type"><code class="literal">JSON_TYPE()</code></a> function
            expects a JSON argument and attempts to parse it into a JSON
            value. It returns the value&#39;s JSON type if it is valid
            and produces an error otherwise:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_TYPE(&#39;[&#34;a&#34;, &#34;b&#34;, 1]&#39;);</code></strong>
+----------------------------+
| JSON_TYPE(&#39;[&#34;a&#34;, &#34;b&#34;, 1]&#39;) |
+----------------------------+
| ARRAY                      |
+----------------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_TYPE(&#39;&#34;hello&#34;&#39;);</code></strong>
+----------------------+
| JSON_TYPE(&#39;&#34;hello&#34;&#39;) |
+----------------------+
| STRING               |
+----------------------+

mysql&gt; <strong class="userinput"><code>SELECT JSON_TYPE(&#39;hello&#39;);</code></strong>
ERROR 3146 (22032): Invalid data type for JSON data in argument 1
to function json_type; a JSON string or JSON type is required.
</pre></li></ul></div><p>
        MySQL handles strings used in JSON context using the
        <code class="literal">utf8mb4</code> character set and
        <code class="literal">utf8mb4_bin</code> collation. Strings in other
        character sets are converted to <code class="literal">utf8mb4</code> as
        necessary. (For strings in the <code class="literal">ascii</code> or
        <code class="literal">utf8mb3</code> character sets, no conversion is
        needed because <code class="literal">ascii</code> and
        <code class="literal">utf8mb3</code> are subsets of
        <code class="literal">utf8mb4</code>.)
      </p><p>
        As an alternative to writing JSON values using literal strings,
        functions exist for composing JSON values from component
        elements. <a class="link" href="json-creation-functions.html#function_json-array"><code class="literal">JSON_ARRAY()</code></a> takes a
        (possibly empty) list of values and returns a JSON array
        containing those values:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY(&#39;a&#39;, 1, NOW());</code></strong>
+----------------------------------------+
| JSON_ARRAY(&#39;a&#39;, 1, NOW())              |
+----------------------------------------+
| [&#34;a&#34;, 1, &#34;2015-07-27 09:43:47.000000&#34;] |
+----------------------------------------+
</pre><p>
        <a class="link" href="json-creation-functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a> takes a (possibly
        empty) list of key-value pairs and returns a JSON object
        containing those pairs:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECT(&#39;key1&#39;, 1, &#39;key2&#39;, &#39;abc&#39;);</code></strong>
+---------------------------------------+
| JSON_OBJECT(&#39;key1&#39;, 1, &#39;key2&#39;, &#39;abc&#39;) |
+---------------------------------------+
| {&#34;key1&#34;: 1, &#34;key2&#34;: &#34;abc&#34;}            |
+---------------------------------------+
</pre><p>
        <a class="link" href="json-modification-functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a> takes two
        or more JSON documents and returns the combined result:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE(&#39;[&#34;a&#34;, 1]&#39;, &#39;{&#34;key&#34;: &#34;value&#34;}&#39;);</code></strong>
+-----------------------------------------------------+
| JSON_MERGE_PRESERVE(&#39;[&#34;a&#34;, 1]&#39;, &#39;{&#34;key&#34;: &#34;value&#34;}&#39;) |
+-----------------------------------------------------+
| [&#34;a&#34;, 1, {&#34;key&#34;: &#34;value&#34;}]                          |
+-----------------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
        For information about the merging rules, see
        <a class="xref" href="json.html#json-normalization" title="Normalization, Merging, and Autowrapping of JSON Values">Normalization, Merging, and Autowrapping of JSON Values</a>.
      </p><p>
        (MySQL 8.0.3 and later also support
        <a class="link" href="json-modification-functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH()</code></a>, which has
        somewhat different behavior. See
        <a class="xref" href="json-modification-functions.html#json-merge-patch-json-merge-preserve-compared" title="JSON_MERGE_PATCH() compared with JSON_MERGE_PRESERVE()">JSON_MERGE_PATCH() compared with JSON_MERGE_PRESERVE()</a>,
        for information about the differences between these two
        functions.)
      </p><p>
        JSON values can be assigned to user-defined variables:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @j = JSON_OBJECT(&#39;key&#39;, &#39;value&#39;);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @j;</code></strong>
+------------------+
| @j               |
+------------------+
| {&#34;key&#34;: &#34;value&#34;} |
+------------------+
</pre><p>
        However, user-defined variables cannot be of
        <code class="literal">JSON</code> data type, so although
        <code class="literal">@j</code> in the preceding example looks like a JSON
        value and has the same character set and collation as a JSON
        value, it does <span class="emphasis"><em>not</em></span> have the
        <code class="literal">JSON</code> data type. Instead, the result from
        <a class="link" href="json-creation-functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a> is converted to a
        string when assigned to the variable.
      </p><p>
        Strings produced by converting JSON values have a character set
        of <code class="literal">utf8mb4</code> and a collation of
        <code class="literal">utf8mb4_bin</code>:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CHARSET(@j), COLLATION(@j);</code></strong>
+-------------+---------------+
| CHARSET(@j) | COLLATION(@j) |
+-------------+---------------+
| utf8mb4     | utf8mb4_bin   |
+-------------+---------------+
</pre><p>
        Because <code class="literal">utf8mb4_bin</code> is a binary collation,
        comparison of JSON values is case-sensitive.
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_ARRAY(&#39;x&#39;) = JSON_ARRAY(&#39;X&#39;);</code></strong>
+-----------------------------------+
| JSON_ARRAY(&#39;x&#39;) = JSON_ARRAY(&#39;X&#39;) |
+-----------------------------------+
|                                 0 |
+-----------------------------------+
</pre><a id="idm45828938137936" class="indexterm"></a><p>
        Case sensitivity also applies to the JSON
        <code class="literal">null</code>, <code class="literal">true</code>, and
        <code class="literal">false</code> literals, which always must be written
        in lowercase:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_VALID(&#39;null&#39;), JSON_VALID(&#39;Null&#39;), JSON_VALID(&#39;NULL&#39;);</code></strong>
+--------------------+--------------------+--------------------+
| JSON_VALID(&#39;null&#39;) | JSON_VALID(&#39;Null&#39;) | JSON_VALID(&#39;NULL&#39;) |
+--------------------+--------------------+--------------------+
|                  1 |                  0 |                  0 |
+--------------------+--------------------+--------------------+

mysql&gt; <strong class="userinput"><code>SELECT CAST(&#39;null&#39; AS JSON);</code></strong>
+----------------------+
| CAST(&#39;null&#39; AS JSON) |
+----------------------+
| null                 |
+----------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT CAST(&#39;NULL&#39; AS JSON);</code></strong>
ERROR 3141 (22032): Invalid JSON text in argument 1 to function cast_as_json:
&#34;Invalid value.&#34; at position 0 in &#39;NULL&#39;.
</pre><p>
        Case sensitivity of the JSON literals differs from that of the
        SQL <code class="literal">NULL</code>, <code class="literal">TRUE</code>, and
        <code class="literal">FALSE</code> literals, which can be written in any
        lettercase:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ISNULL(null), ISNULL(Null), ISNULL(NULL);</code></strong>
+--------------+--------------+--------------+
| ISNULL(null) | ISNULL(Null) | ISNULL(NULL) |
+--------------+--------------+--------------+
|            1 |            1 |            1 |
+--------------+--------------+--------------+
</pre><a id="idm45828938124992" class="indexterm"></a><p>
        Sometimes it may be necessary or desirable to insert quote
        characters (<code class="literal">&#34;</code> or <code class="literal">&#39;</code>) into a
        JSON document. Assume for this example that you want to insert
        some JSON objects containing strings representing sentences that
        state some facts about MySQL, each paired with an appropriate
        keyword, into a table created using the SQL statement shown
        here:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE facts (sentence JSON);</code></strong>
</pre><p>
        Among these keyword-sentence pairs is this one:
      </p><pre class="programlisting">mascot: The MySQL mascot is a dolphin named &#34;Sakila&#34;.
</pre><p>
        One way to insert this as a JSON object into the
        <code class="literal">facts</code> table is to use the MySQL
        <a class="link" href="json-creation-functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a> function. In this
        case, you must escape each quote character using a backslash, as
        shown here:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>INSERT INTO facts VALUES</code></strong>
     &gt;   <strong class="userinput"><code>(JSON_OBJECT(&#34;mascot&#34;, &#34;Our mascot is a dolphin named \&#34;Sakila\&#34;.&#34;));</code></strong>
</pre><p>
        This does not work in the same way if you insert the value as a
        JSON object literal, in which case, you must use the double
        backslash escape sequence, like this:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>INSERT INTO facts VALUES</code></strong>
     &gt;   <strong class="userinput"><code>(&#39;{&#34;mascot&#34;: &#34;Our mascot is a dolphin named \\&#34;Sakila\\&#34;.&#34;}&#39;);</code></strong>
</pre><p>
        Using the double backslash keeps MySQL from performing escape
        sequence processing, and instead causes it to pass the string
        literal to the storage engine for processing. After inserting
        the JSON object in either of the ways just shown, you can see
        that the backslashes are present in the JSON column value by
        doing a simple <a class="link" href="select.html" title="13.2.13&nbsp;SELECT Statement"><code class="literal">SELECT</code></a>, like this:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT sentence FROM facts;</code></strong>
+---------------------------------------------------------+
| sentence                                                |
+---------------------------------------------------------+
| {&#34;mascot&#34;: &#34;Our mascot is a dolphin named \&#34;Sakila\&#34;.&#34;} |
+---------------------------------------------------------+
</pre><p>
        To look up this particular sentence employing
        <code class="literal">mascot</code> as the key, you can use the
        column-path operator
        <a class="link" href="json-search-functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a>,
        as shown here:
      </p><pre class="programlisting">mysql&gt; SELECT col-&gt;&#34;$.mascot&#34; FROM qtest;
+---------------------------------------------+
| col-&gt;&#34;$.mascot&#34;                             |
+---------------------------------------------+
| &#34;Our mascot is a dolphin named \&#34;Sakila\&#34;.&#34; |
+---------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
        This leaves the backslashes intact, along with the surrounding
        quote marks. To display the desired value using
        <code class="literal">mascot</code> as the key, but without including the
        surrounding quote marks or any escapes, use the inline path
        operator
        <a class="link" href="json-search-functions.html#operator_json-inline-path"><code class="literal">-&gt;&gt;</code></a>,
        like this:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT sentence-&gt;&gt;&#34;$.mascot&#34; FROM facts;</code></strong>
+-----------------------------------------+
| sentence-&gt;&gt;&#34;$.mascot&#34;                   |
+-----------------------------------------+
| Our mascot is a dolphin named &#34;Sakila&#34;. |
+-----------------------------------------+
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          The previous example does not work as shown if the
          <a class="link" href="sql-mode.html#sqlmode_no_backslash_escapes"><code class="literal">NO_BACKSLASH_ESCAPES</code></a> server
          SQL mode is enabled. If this mode is set, a single backslash
          instead of double backslashes can be used to insert the JSON
          object literal, and the backslashes are preserved. If you use
          the <code class="literal">JSON_OBJECT()</code> function when performing
          the insert and this mode is set, you must alternate single and
          double quotes, like this:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>INSERT INTO facts VALUES</code></strong>
     &gt; <strong class="userinput"><code>(JSON_OBJECT(&#39;mascot&#39;, &#39;Our mascot is a dolphin named &#34;Sakila&#34;.&#39;));</code></strong>
</pre><p>
          See the description of the
          <a class="link" href="json-modification-functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE()</code></a> function for
          more information about the effects of this mode on escaped
          characters in JSON values.
        </p></div></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="json-normalization"></a>Normalization, Merging, and Autowrapping of JSON Values</h3></div></div></div><a id="idm45828938088400" class="indexterm"></a><a id="idm45828938086944" class="indexterm"></a><a id="idm45828938085872" class="indexterm"></a><a id="idm45828938084384" class="indexterm"></a><a id="idm45828938083312" class="indexterm"></a><a id="idm45828938081824" class="indexterm"></a><p>
        When a string is parsed and found to be a valid JSON document,
        it is also normalized. This means that members with keys that
        duplicate a key found later in the document, reading from left
        to right, are discarded. The object value produced by the
        following <a class="link" href="json-creation-functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a> call
        includes only the second <code class="literal">key1</code> element because
        that key name occurs earlier in the value, as shown here:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECT(&#39;key1&#39;, 1, &#39;key2&#39;, &#39;abc&#39;, &#39;key1&#39;, &#39;def&#39;);</code></strong>
+------------------------------------------------------+
| JSON_OBJECT(&#39;key1&#39;, 1, &#39;key2&#39;, &#39;abc&#39;, &#39;key1&#39;, &#39;def&#39;) |
+------------------------------------------------------+
| {&#34;key1&#34;: &#34;def&#34;, &#34;key2&#34;: &#34;abc&#34;}                       |
+------------------------------------------------------+
</pre><p>
        Normalization is also performed when values are inserted into
        JSON columns, as shown here:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 JSON);</code></strong>

mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUES</code></strong>
     &gt;     <strong class="userinput"><code>(&#39;{&#34;x&#34;: 17, &#34;x&#34;: &#34;red&#34;}&#39;),</code></strong>
     &gt;     <strong class="userinput"><code>(&#39;{&#34;x&#34;: 17, &#34;x&#34;: &#34;red&#34;, &#34;x&#34;: [3, 5, 7]}&#39;);</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT c1 FROM t1;</code></strong>
+------------------+
| c1               |
+------------------+
| {&#34;x&#34;: &#34;red&#34;}     |
| {&#34;x&#34;: [3, 5, 7]} |
+------------------+
</pre><p>
        This <span class="quote">&ldquo;<span class="quote">last duplicate key wins</span>&rdquo;</span> behavior is
        suggested by
        <a class="ulink" href="https://tools.ietf.org/html/rfc7159" target="_top">RFC
        7159</a> and is implemented by most JavaScript parsers. (Bug
        #86866, Bug #26369555)
      </p><p>
        In versions of MySQL prior to 8.0.3, members with keys that
        duplicated a key found earlier in the document were discarded.
        The object value produced by the following
        <a class="link" href="json-creation-functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a> call does not
        include the second <code class="literal">key1</code> element because that
        key name occurs earlier in the value:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_OBJECT(&#39;key1&#39;, 1, &#39;key2&#39;, &#39;abc&#39;, &#39;key1&#39;, &#39;def&#39;);</code></strong>
+------------------------------------------------------+
| JSON_OBJECT(&#39;key1&#39;, 1, &#39;key2&#39;, &#39;abc&#39;, &#39;key1&#39;, &#39;def&#39;) |
+------------------------------------------------------+
| {&#34;key1&#34;: 1, &#34;key2&#34;: &#34;abc&#34;}                           |
+------------------------------------------------------+
</pre><p>
        Prior to MySQL 8.0.3, this <span class="quote">&ldquo;<span class="quote">first duplicate key
        wins</span>&rdquo;</span> normalization was also performed when inserting
        values into JSON columns.
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 JSON);</code></strong>

mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUES</code></strong>
     &gt;     <strong class="userinput"><code>(&#39;{&#34;x&#34;: 17, &#34;x&#34;: &#34;red&#34;}&#39;),</code></strong>
     &gt;     <strong class="userinput"><code>(&#39;{&#34;x&#34;: 17, &#34;x&#34;: &#34;red&#34;, &#34;x&#34;: [3, 5, 7]}&#39;);</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT c1 FROM t1;</code></strong>
+-----------+
| c1        |
+-----------+
| {&#34;x&#34;: 17} |
| {&#34;x&#34;: 17} |
+-----------+
</pre><p>
        MySQL also discards extra whitespace between keys, values, or
        elements in the original JSON document, and leaves (or inserts,
        when necessary) a single space following each comma
        (<code class="literal">,</code>) or colon (<code class="literal">:</code>) when
        displaying it. This is done to enhance readability.
      </p><p>
        MySQL functions that produce JSON values (see
        <a class="xref" href="json-creation-functions.html" title="12.17.2&nbsp;Functions That Create JSON Values">Section&nbsp;12.17.2, &ldquo;Functions That Create JSON Values&rdquo;</a>) always return
        normalized values.
      </p><p>
        To make lookups more efficient, MySQL also sorts the keys of a
        JSON object. <span class="emphasis"><em>You should be aware that the result of
        this ordering is subject to change and not guaranteed to be
        consistent across releases</em></span>.
      </p><a class="dashingAutolink" name="autolink-1758"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Merging%20JSON%20Values"></a><h4><a id="json-merging"></a>Merging JSON Values</h4><a id="idm45828938052608" class="indexterm"></a><a id="idm45828938051536" class="indexterm"></a><a id="idm45828938050464" class="indexterm"></a><a id="idm45828938049392" class="indexterm"></a><p>
        Two merging algorithms are supported in MySQL 8.0.3 (and later),
        implemented by the functions
        <a class="link" href="json-modification-functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a> and
        <a class="link" href="json-modification-functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH()</code></a>. These differ
        in how they handle duplicate keys:
        <a class="link" href="json-modification-functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a> retains
        values for duplicate keys, while
        <a class="link" href="json-modification-functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH()</code></a> discards all
        but the last value. The next few paragraphs explain how each of
        these two functions handles the merging of different
        combinations of JSON documents (that is, of objects and arrays).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          <a class="link" href="json-modification-functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a> is the
          same as the <code class="literal">JSON_MERGE()</code> function found in
          previous versions of MySQL (renamed in MySQL 8.0.3).
          <code class="literal">JSON_MERGE()</code> is still supported as an alias
          for <code class="literal">JSON_MERGE_PRESERVE()</code> in MySQL
          8.0, but is deprecated and subject to removal in
          a future release.
        </p></div><p><strong>Merging arrays.&nbsp;</strong>
          In contexts that combine multiple arrays, the arrays are
          merged into a single array.
          <code class="literal">JSON_MERGE_PRESERVE()</code> does this by
          concatenating arrays named later to the end of the first
          array. <code class="literal">JSON_MERGE_PATCH()</code> considers each
          argument as an array consisting of a single element (thus
          having 0 as its index) and then applies <span class="quote">&ldquo;<span class="quote">last duplicate
          key wins</span>&rdquo;</span> logic to select only the last argument. You
          can compare the results shown by this query:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_MERGE_PRESERVE(&#39;[1, 2]&#39;, &#39;[&#34;a&#34;, &#34;b&#34;, &#34;c&#34;]&#39;, &#39;[true, false]&#39;) AS Preserve,</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_MERGE_PATCH(&#39;[1, 2]&#39;, &#39;[&#34;a&#34;, &#34;b&#34;, &#34;c&#34;]&#39;, &#39;[true, false]&#39;) AS Patch\G</code></strong>
*************************** 1. row ***************************
Preserve: [1, 2, &#34;a&#34;, &#34;b&#34;, &#34;c&#34;, true, false]
   Patch: [true, false]
</pre><p>
        Multiple objects when merged produce a single object.
        <code class="literal">JSON_MERGE_PRESERVE()</code> handles multiple
        objects having the same key by combining all unique values for
        that key in an array; this array is then used as the value for
        that key in the result. <code class="literal">JSON_MERGE_PATCH()</code>
        discards values for which duplicate keys are found, working from
        left to right, so that the result contains only the last value
        for that key. The following query illustrates the difference in
        the results for the duplicate key <code class="literal">a</code>:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_MERGE_PRESERVE(&#39;{&#34;a&#34;: 1, &#34;b&#34;: 2}&#39;, &#39;{&#34;c&#34;: 3, &#34;a&#34;: 4}&#39;, &#39;{&#34;c&#34;: 5, &#34;d&#34;: 3}&#39;) AS Preserve,</code></strong>
    -&gt;   <strong class="userinput"><code>JSON_MERGE_PATCH(&#39;{&#34;a&#34;: 3, &#34;b&#34;: 2}&#39;, &#39;{&#34;c&#34;: 3, &#34;a&#34;: 4}&#39;, &#39;{&#34;c&#34;: 5, &#34;d&#34;: 3}&#39;) AS Patch\G</code></strong>
*************************** 1. row ***************************
Preserve: {&#34;a&#34;: [1, 4], &#34;b&#34;: 2, &#34;c&#34;: [3, 5], &#34;d&#34;: 3}
   Patch: {&#34;a&#34;: 4, &#34;b&#34;: 2, &#34;c&#34;: 5, &#34;d&#34;: 3}
</pre><p>
        Nonarray values used in a context that requires an array value
        are autowrapped: The value is surrounded by <code class="literal">[</code>
        and <code class="literal">]</code> characters to convert it to an array.
        In the following statement, each argument is autowrapped as an
        array (<code class="literal">[1]</code>, <code class="literal">[2]</code>). These
        are then merged to produce a single result array; as in the
        previous two cases, <code class="literal">JSON_MERGE_PRESERVE()</code>
        combines values having the same key while
        <code class="literal">JSON_MERGE_PATCH()</code> discards values for all
        duplicate keys except the last, as shown here:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
	  -&gt;   <strong class="userinput"><code>JSON_MERGE_PRESERVE(&#39;1&#39;, &#39;2&#39;) AS Preserve,</code></strong>
	  -&gt;   <strong class="userinput"><code>JSON_MERGE_PATCH(&#39;1&#39;, &#39;2&#39;) AS Patch\G</code></strong>
*************************** 1. row ***************************
Preserve: [1, 2]
   Patch: 2
</pre><p>
        Array and object values are merged by autowrapping the object as
        an array and merging the arrays by combining values or by
        <span class="quote">&ldquo;<span class="quote">last duplicate key wins</span>&rdquo;</span> according to the choice
        of merging function (<code class="literal">JSON_MERGE_PRESERVE()</code> or
        <code class="literal">JSON_MERGE_PATCH()</code>, respectively), as can be
        seen in this example:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
	  -&gt;   <strong class="userinput"><code>JSON_MERGE_PRESERVE(&#39;[10, 20]&#39;, &#39;{&#34;a&#34;: &#34;x&#34;, &#34;b&#34;: &#34;y&#34;}&#39;) AS Preserve,</code></strong>
	  -&gt;   <strong class="userinput"><code>JSON_MERGE_PATCH(&#39;[10, 20]&#39;, &#39;{&#34;a&#34;: &#34;x&#34;, &#34;b&#34;: &#34;y&#34;}&#39;) AS Patch\G</code></strong>
*************************** 1. row ***************************
Preserve: [10, 20, {&#34;a&#34;: &#34;x&#34;, &#34;b&#34;: &#34;y&#34;}]
   Patch: {&#34;a&#34;: &#34;x&#34;, &#34;b&#34;: &#34;y&#34;}
</pre></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="json-paths"></a>Searching and Modifying JSON Values</h3></div></div></div><p>
        A JSON path expression selects a value within a JSON document.
      </p><p>
        Path expressions are useful with functions that extract parts of
        or modify a JSON document, to specify where within that document
        to operate. For example, the following query extracts from a
        JSON document the value of the member with the
        <code class="literal">name</code> key:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT(&#39;{&#34;id&#34;: 14, &#34;name&#34;: &#34;Aztalan&#34;}&#39;, &#39;$.name&#39;);</code></strong>
+---------------------------------------------------------+
| JSON_EXTRACT(&#39;{&#34;id&#34;: 14, &#34;name&#34;: &#34;Aztalan&#34;}&#39;, &#39;$.name&#39;) |
+---------------------------------------------------------+
| &#34;Aztalan&#34;                                               |
+---------------------------------------------------------+
</pre><p>
        Path syntax uses a leading <code class="literal">$</code> character to
        represent the JSON document under consideration, optionally
        followed by selectors that indicate successively more specific
        parts of the document:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A period followed by a key name names the member in an
            object with the given key. The key name must be specified
            within double quotation marks if the name without quotes is
            not legal within path expressions (for example, if it
            contains a space).
          </p></li><li class="listitem"><p>
            <code class="literal">[<em class="replaceable"><code>N</code></em>]</code> appended
            to a <em class="replaceable"><code>path</code></em> that selects an array
            names the value at position <em class="replaceable"><code>N</code></em>
            within the array. Array positions are integers beginning
            with zero. If <em class="replaceable"><code>path</code></em> does not
            select an array value, <em class="replaceable"><code>path</code></em>[0]
            evaluates to the same value as
            <em class="replaceable"><code>path</code></em>:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_SET(&#39;&#34;x&#34;&#39;, &#39;$[0]&#39;, &#39;a&#39;);</code></strong>
+------------------------------+
| JSON_SET(&#39;&#34;x&#34;&#39;, &#39;$[0]&#39;, &#39;a&#39;) |
+------------------------------+
| &#34;a&#34;                          |
+------------------------------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><p>
            <code class="literal">[<em class="replaceable"><code>M</code></em> to
            <em class="replaceable"><code>N</code></em>]</code> specifies a subset
            or range of array values starting with the value at position
            <em class="replaceable"><code>M</code></em>, and ending with the value at
            position <em class="replaceable"><code>N</code></em>.
          </p><p>
            <code class="literal">last</code> is supported as a synonym for the
            index of the rightmost array element. Relative addressing of
            array elements is also supported. If
            <em class="replaceable"><code>path</code></em> does not select an array
            value, <em class="replaceable"><code>path</code></em>[last] evaluates to
            the same value as <em class="replaceable"><code>path</code></em>, as shown
            later in this section (see
            <a class="xref" href="json.html#json-paths-last" title="Rightmost array element">Rightmost array element</a>).
          </p></li><li class="listitem"><p>
            Paths can contain <code class="literal">*</code> or
            <code class="literal">**</code> wildcards:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">.[*]</code> evaluates to the values of all
                members in a JSON object.
              </p></li><li class="listitem"><p>
                <code class="literal">[*]</code> evaluates to the values of all
                elements in a JSON array.
              </p></li><li class="listitem"><p>
                <code class="literal"><em class="replaceable"><code>prefix</code></em>**<em class="replaceable"><code>suffix</code></em></code>
                evaluates to all paths that begin with the named prefix
                and end with the named suffix.
              </p></li></ul></div></li><li class="listitem"><p>
            A path that does not exist in the document (evaluates to
            nonexistent data) evaluates to <code class="literal">NULL</code>.
          </p></li></ul></div><p>
        Let <code class="literal">$</code> refer to this JSON array with three
        elements:
      </p><pre class="programlisting">[3, {&#34;a&#34;: [5, 6], &#34;b&#34;: 10}, [99, 100]]
</pre><p>
        Then:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">$[0]</code> evaluates to <code class="literal">3</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">$[1]</code> evaluates to <code class="literal">{&#34;a&#34;: [5, 6],
            &#34;b&#34;: 10}</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">$[2]</code> evaluates to <code class="literal">[99,
            100]</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">$[3]</code> evaluates to <code class="literal">NULL</code>
            (it refers to the fourth array element, which does not
            exist).
          </p></li></ul></div><p>
        Because <code class="literal">$[1]</code> and <code class="literal">$[2]</code>
        evaluate to nonscalar values, they can be used as the basis for
        more-specific path expressions that select nested values.
        Examples:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">$[1].a</code> evaluates to <code class="literal">[5,
            6]</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">$[1].a[1]</code> evaluates to
            <code class="literal">6</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">$[1].b</code> evaluates to
            <code class="literal">10</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">$[2][0]</code> evaluates to
            <code class="literal">99</code>.
          </p></li></ul></div><p>
        As mentioned previously, path components that name keys must be
        quoted if the unquoted key name is not legal in path
        expressions. Let <code class="literal">$</code> refer to this value:
      </p><pre class="programlisting">{&#34;a fish&#34;: &#34;shark&#34;, &#34;a bird&#34;: &#34;sparrow&#34;}
</pre><p>
        The keys both contain a space and must be quoted:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">$.&#34;a fish&#34;</code> evaluates to
            <code class="literal">shark</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">$.&#34;a bird&#34;</code> evaluates to
            <code class="literal">sparrow</code>.
          </p></li></ul></div><p>
        Paths that use wildcards evaluate to an array that can contain
        multiple values:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT(&#39;{&#34;a&#34;: 1, &#34;b&#34;: 2, &#34;c&#34;: [3, 4, 5]}&#39;, &#39;$.*&#39;);</code></strong>
+---------------------------------------------------------+
| JSON_EXTRACT(&#39;{&#34;a&#34;: 1, &#34;b&#34;: 2, &#34;c&#34;: [3, 4, 5]}&#39;, &#39;$.*&#39;) |
+---------------------------------------------------------+
| [1, 2, [3, 4, 5]]                                       |
+---------------------------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT(&#39;{&#34;a&#34;: 1, &#34;b&#34;: 2, &#34;c&#34;: [3, 4, 5]}&#39;, &#39;$.c[*]&#39;);</code></strong>
+------------------------------------------------------------+
| JSON_EXTRACT(&#39;{&#34;a&#34;: 1, &#34;b&#34;: 2, &#34;c&#34;: [3, 4, 5]}&#39;, &#39;$.c[*]&#39;) |
+------------------------------------------------------------+
| [3, 4, 5]                                                  |
+------------------------------------------------------------+
</pre><p>
        In the following example, the path <code class="literal">$**.b</code>
        evaluates to multiple paths (<code class="literal">$.a.b</code> and
        <code class="literal">$.c.b</code>) and produces an array of the matching
        path values:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT(&#39;{&#34;a&#34;: {&#34;b&#34;: 1}, &#34;c&#34;: {&#34;b&#34;: 2}}&#39;, &#39;$**.b&#39;);</code></strong>
+---------------------------------------------------------+
| JSON_EXTRACT(&#39;{&#34;a&#34;: {&#34;b&#34;: 1}, &#34;c&#34;: {&#34;b&#34;: 2}}&#39;, &#39;$**.b&#39;) |
+---------------------------------------------------------+
| [1, 2]                                                  |
+---------------------------------------------------------+
</pre><p><a id="json-paths-ranges"></a><strong>Ranges from JSON arrays.&nbsp;</strong>
          You can use ranges with the <code class="literal">to</code> keyword to
          specify subsets of JSON arrays. For example, <code class="literal">$[1 to
          3]</code> includes the second, third, and fourth elements
          of an array, as shown here:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT(&#39;[1, 2, 3, 4, 5]&#39;, &#39;$[1 to 3]&#39;);</code></strong>
+----------------------------------------------+
| JSON_EXTRACT(&#39;[1, 2, 3, 4, 5]&#39;, &#39;$[1 to 3]&#39;) |
+----------------------------------------------+
| [2, 3, 4]                                    |
+----------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
        The syntax is <code class="literal"><em class="replaceable"><code>M</code></em> to
        <em class="replaceable"><code>N</code></em></code>, where
        <em class="replaceable"><code>M</code></em> and <em class="replaceable"><code>N</code></em>
        are, respectively, the first and last indexes of a range of
        elements from a JSON array. <em class="replaceable"><code>N</code></em> must be
        greater than <em class="replaceable"><code>M</code></em>;
        <em class="replaceable"><code>M</code></em> must be greater than or equal to 0.
        Array elements are indexed beginning with 0.
      </p><p>
        You can use ranges in contexts where wildcards are supported.
      </p><p><a id="json-paths-last"></a><strong>Rightmost array element.&nbsp;</strong>
          The <code class="literal">last</code> keyword is supported as a synonym
          for the index of the last element in an array. Expressions of
          the form <code class="literal">last -
          <em class="replaceable"><code>N</code></em></code> can be used for
          relative addressing, and within range definitions, like this:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_EXTRACT(&#39;[1, 2, 3, 4, 5]&#39;, &#39;$[last-3 to last-1]&#39;);</code></strong>
+--------------------------------------------------------+
| JSON_EXTRACT(&#39;[1, 2, 3, 4, 5]&#39;, &#39;$[last-3 to last-1]&#39;) |
+--------------------------------------------------------+
| [2, 3, 4]                                              |
+--------------------------------------------------------+
1 row in set (0.01 sec)
</pre><p>
        If the path is evaluated against a value that is not an array,
        the result of the evaluation is the same as if the value had
        been wrapped in a single-element array:
      </p><pre class="programlisting">mysql&gt; SELECT JSON_REPLACE(&#39;&#34;Sakila&#34;&#39;, &#39;$[last]&#39;, 10);
+-----------------------------------------+
| JSON_REPLACE(&#39;&#34;Sakila&#34;&#39;, &#39;$[last]&#39;, 10) |
+-----------------------------------------+
| 10                                      |
+-----------------------------------------+
1 row in set (0.00 sec)
</pre><p>
        You can use
        <a class="link" href="json-search-functions.html#operator_json-column-path"><code class="literal"><em class="replaceable"><code>column</code></em>-&gt;<em class="replaceable"><code>path</code></em></code></a>
        with a JSON column identifier and JSON path expression as a
        synonym for
        <a class="link" href="json-search-functions.html#function_json-extract"><code class="literal">JSON_EXTRACT(<em class="replaceable"><code>column</code></em>,
        <em class="replaceable"><code>path</code></em>)</code></a>. See
        <a class="xref" href="json-search-functions.html" title="12.17.3&nbsp;Functions That Search JSON Values">Section&nbsp;12.17.3, &ldquo;Functions That Search JSON Values&rdquo;</a>, for more information.
        See also <a class="xref" href="create-table-secondary-indexes.html#json-column-indirect-index" title="Indexing a Generated Column to Provide a JSON Column Index">Indexing a Generated Column to Provide a JSON Column Index</a>.
      </p><p>
        Some functions take an existing JSON document, modify it in some
        way, and return the resulting modified document. Path
        expressions indicate where in the document to make changes. For
        example, the <a class="link" href="json-modification-functions.html#function_json-set"><code class="literal">JSON_SET()</code></a>,
        <a class="link" href="json-modification-functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a>, and
        <a class="link" href="json-modification-functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a> functions each
        take a JSON document, plus one or more path-value pairs that
        describe where to modify the document and the values to use. The
        functions differ in how they handle existing and nonexisting
        values within the document.
      </p><p>
        Consider this document:
      </p><pre class="programlisting">mysql&gt; SET @j = &#39;[&#34;a&#34;, {&#34;b&#34;: [true, false]}, [10, 20]]&#39;;
</pre><p>
        <a class="link" href="json-modification-functions.html#function_json-set"><code class="literal">JSON_SET()</code></a> replaces values for
        paths that exist and adds values for paths that do not exist:.
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_SET(@j, &#39;$[1].b[0]&#39;, 1, &#39;$[2][2]&#39;, 2);</code></strong>
+--------------------------------------------+
| JSON_SET(@j, &#39;$[1].b[0]&#39;, 1, &#39;$[2][2]&#39;, 2) |
+--------------------------------------------+
| [&#34;a&#34;, {&#34;b&#34;: [1, false]}, [10, 20, 2]]      |
+--------------------------------------------+
</pre><p>
        In this case, the path <code class="literal">$[1].b[0]</code> selects an
        existing value (<code class="literal">true</code>), which is replaced with
        the value following the path argument (<code class="literal">1</code>).
        The path <code class="literal">$[2][2]</code> does not exist, so the
        corresponding value (<code class="literal">2</code>) is added to the value
        selected by <code class="literal">$[2]</code>.
      </p><p>
        <a class="link" href="json-modification-functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a> adds new values but
        does not replace existing values:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_INSERT(@j, &#39;$[1].b[0]&#39;, 1, &#39;$[2][2]&#39;, 2);</code></strong>
+-----------------------------------------------+
| JSON_INSERT(@j, &#39;$[1].b[0]&#39;, 1, &#39;$[2][2]&#39;, 2) |
+-----------------------------------------------+
| [&#34;a&#34;, {&#34;b&#34;: [true, false]}, [10, 20, 2]]      |
+-----------------------------------------------+
</pre><p>
        <a class="link" href="json-modification-functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a> replaces existing
        values and ignores new values:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_REPLACE(@j, &#39;$[1].b[0]&#39;, 1, &#39;$[2][2]&#39;, 2);</code></strong>
+------------------------------------------------+
| JSON_REPLACE(@j, &#39;$[1].b[0]&#39;, 1, &#39;$[2][2]&#39;, 2) |
+------------------------------------------------+
| [&#34;a&#34;, {&#34;b&#34;: [1, false]}, [10, 20]]             |
+------------------------------------------------+
</pre><p>
        The path-value pairs are evaluated left to right. The document
        produced by evaluating one pair becomes the new value against
        which the next pair is evaluated.
      </p><p>
        <code class="literal">JSON_REMOVE()</code> takes a JSON document and one
        or more paths that specify values to be removed from the
        document. The return value is the original document minus the
        values selected by paths that exist within the document:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT JSON_REMOVE(@j, &#39;$[2]&#39;, &#39;$[1].b[1]&#39;, &#39;$[1].b[1]&#39;);</code></strong>
+---------------------------------------------------+
| JSON_REMOVE(@j, &#39;$[2]&#39;, &#39;$[1].b[1]&#39;, &#39;$[1].b[1]&#39;) |
+---------------------------------------------------+
| [&#34;a&#34;, {&#34;b&#34;: [true]}]                              |
+---------------------------------------------------+
</pre><p>
        The paths have these effects:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">$[2]</code> matches <code class="literal">[10, 20]</code>
            and removes it.
          </p></li><li class="listitem"><p>
            The first instance of <code class="literal">$[1].b[1]</code> matches
            <code class="literal">false</code> in the <code class="literal">b</code> element
            and removes it.
          </p></li><li class="listitem"><p>
            The second instance of <code class="literal">$[1].b[1]</code> matches
            nothing: That element has already been removed, the path no
            longer exists, and has no effect.
          </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="json-path-syntax"></a>JSON Path Syntax</h3></div></div></div><p>
        Many of the JSON functions supported by MySQL and described
        elsewhere in this Manual (see <a class="xref" href="json-functions.html" title="12.17&nbsp;JSON Functions">Section&nbsp;12.17, &ldquo;JSON Functions&rdquo;</a>)
        require a path expression in order to identify a specific
        element in a JSON document. A path consists of the path&#39;s
        scope followed by one or more path legs. For paths used in MySQL
        JSON functions, the scope is always the document being searched
        or otherwise operated on, represented by a leading
        <code class="literal">$</code> character. Path legs are separated by
        period characters (<code class="literal">.</code>). Cells in arrays are
        represented by
        <code class="literal">[<em class="replaceable"><code>N</code></em>]</code>, where
        <em class="replaceable"><code>N</code></em> is a non-negative integer. Names of
        keys must be double-quoted strings or valid ECMAScript
        identifiers (see
        <a class="ulink" href="http://www.ecma-international.org/ecma-262/5.1/#sec-7.6" target="_top"><em class="citetitle">Identifier
        Names and Identifiers</em></a>, in the
        <em class="citetitle">ECMAScript Language Specification</em>). Path
        expressions, like JSON text, should be encoded using the
        <code class="literal">ascii</code>, <code class="literal">utf8mb3</code>, or
        <code class="literal">utf8mb4</code> character set. Other character
        encodings are implicitly coerced to <code class="literal">utf8mb4</code>.
        The complete syntax is shown here:
      </p><pre class="programlisting"><em class="replaceable"><code>pathExpression</code></em>:
    <em class="replaceable"><code>scope</code></em>[(<em class="replaceable"><code>pathLeg</code></em>)*]

<em class="replaceable"><code>pathLeg</code></em>:
    <em class="replaceable"><code>member</code></em> | <em class="replaceable"><code>arrayLocation</code></em> | <em class="replaceable"><code>doubleAsterisk</code></em>

<em class="replaceable"><code>member</code></em>:
    <em class="replaceable"><code>period</code></em> ( <em class="replaceable"><code>keyName</code></em> | <em class="replaceable"><code>asterisk</code></em> )

<em class="replaceable"><code>arrayLocation</code></em>:
    <em class="replaceable"><code>leftBracket</code></em> ( <em class="replaceable"><code>nonNegativeInteger</code></em> | <em class="replaceable"><code>asterisk</code></em> ) <em class="replaceable"><code>rightBracket</code></em>

<em class="replaceable"><code>keyName</code></em>:
    <a class="ulink" href="http://www.ecma-international.org/ecma-262/5.1/#sec-7.6" target="_top"><em class="replaceable"><code>ESIdentifier</code></em></a> | <em class="replaceable"><code>doubleQuotedString</code></em>

<em class="replaceable"><code>doubleAsterisk</code></em>:
    &#39;**&#39;

<em class="replaceable"><code>period</code></em>:
    &#39;.&#39;

<em class="replaceable"><code>asterisk</code></em>:
    &#39;*&#39;

<em class="replaceable"><code>leftBracket</code></em>:
    &#39;[&#39;

<em class="replaceable"><code>rightBracket</code></em>:
    &#39;]&#39;
</pre><p>
        As noted previously, in MySQL, the scope of the path is always
        the document being operated on, represented as
        <code class="literal">$</code>. You can use <code class="literal">&#39;$&#39;</code> as a
        synonym for the document in JSON path expressions.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          Some implementations support column references for scopes of
          JSON paths; MySQL 8.0 does not support these.
        </p></div><p>
        The wildcard <code class="literal">*</code> and <code class="literal">**</code>
        tokens are used as follows:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">.*</code> represents the values of all members
            in the object.
          </p></li><li class="listitem"><p>
            <code class="literal">[*]</code> represents the values of all cells in
            the array.
          </p></li><li class="listitem"><p>
            <code class="literal">[<em class="replaceable"><code>prefix</code></em>]**<em class="replaceable"><code>suffix</code></em></code>
            represents all paths beginning with
            <em class="replaceable"><code>prefix</code></em> and ending with
            <em class="replaceable"><code>suffix</code></em>.
            <em class="replaceable"><code>prefix</code></em> is optional, while
            <em class="replaceable"><code>suffix</code></em> is required; in other
            words, a path may not end in <code class="literal">**</code>.
          </p><p>
            In addition, a path may not contain the sequence
            <code class="literal">***</code>.
          </p></li></ul></div><p>
        For path syntax examples, see the descriptions of the various
        JSON functions that take paths as arguments, such as
        <a class="link" href="json-search-functions.html#function_json-contains-path"><code class="literal">JSON_CONTAINS_PATH()</code></a>,
        <a class="link" href="json-modification-functions.html#function_json-set"><code class="literal">JSON_SET()</code></a>, and
        <a class="link" href="json-modification-functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a>. For examples
        which include the use of the <code class="literal">*</code> and
        <code class="literal">**</code> wildcards, see the description of the
        <a class="link" href="json-search-functions.html#function_json-search"><code class="literal">JSON_SEARCH()</code></a> function.
      </p><p>
        MySQL 8.0 also supports range notation for subsets of JSON
        arrays using the <code class="literal">to</code> keyword (such as
        <code class="literal">$[2 to 10]</code>), as well as the
        <code class="literal">last</code> keyword as a synonym for the rightmost
        element of an array. See <a class="xref" href="json.html#json-paths" title="Searching and Modifying JSON Values">Searching and Modifying JSON Values</a>, for more
        information and examples.
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="json-comparison"></a>Comparison and Ordering of JSON Values</h3></div></div></div><p>
        JSON values can be compared using the
        <a class="link" href="comparison-operators.html#operator_equal"><code class="literal">=</code></a>,
        <a class="link" href="comparison-operators.html#operator_less-than"><code class="literal">&lt;</code></a>,
        <a class="link" href="comparison-operators.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a>,
        <a class="link" href="comparison-operators.html#operator_greater-than"><code class="literal">&gt;</code></a>,
        <a class="link" href="comparison-operators.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a>,
        <a class="link" href="comparison-operators.html#operator_not-equal"><code class="literal">&lt;&gt;</code></a>,
        <a class="link" href="comparison-operators.html#operator_not-equal"><code class="literal">!=</code></a>, and
        <a class="link" href="comparison-operators.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a>
        operators.
      </p><p>
        The following comparison operators and functions are not yet
        supported with JSON values:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="comparison-operators.html#operator_between"><code class="literal">BETWEEN</code></a>
          </p></li><li class="listitem"><p>
            <a class="link" href="comparison-operators.html#operator_in"><code class="literal">IN()</code></a>
          </p></li><li class="listitem"><p>
            <a class="link" href="comparison-operators.html#function_greatest"><code class="literal">GREATEST()</code></a>
          </p></li><li class="listitem"><p>
            <a class="link" href="comparison-operators.html#function_least"><code class="literal">LEAST()</code></a>
          </p></li></ul></div><p>
        A workaround for the comparison operators and functions just
        listed is to cast JSON values to a native MySQL numeric or
        string data type so they have a consistent non-JSON scalar type.
      </p><p>
        Comparison of JSON values takes place at two levels. The first
        level of comparison is based on the JSON types of the compared
        values. If the types differ, the comparison result is determined
        solely by which type has higher precedence. If the two values
        have the same JSON type, a second level of comparison occurs
        using type-specific rules.
      </p><p>
        The following list shows the precedences of JSON types, from
        highest precedence to the lowest. (The type names are those
        returned by the <a class="link" href="json-attribute-functions.html#function_json-type"><code class="literal">JSON_TYPE()</code></a>
        function.) Types shown together on a line have the same
        precedence. Any value having a JSON type listed earlier in the
        list compares greater than any value having a JSON type listed
        later in the list.
      </p><pre class="programlisting">BLOB
BIT
OPAQUE
DATETIME
TIME
DATE
BOOLEAN
ARRAY
OBJECT
STRING
INTEGER, DOUBLE
NULL
</pre><p>
        For JSON values of the same precedence, the comparison rules are
        type specific:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">BLOB</code>
          </p><p>
            The first <em class="replaceable"><code>N</code></em> bytes of the two
            values are compared, where <em class="replaceable"><code>N</code></em> is
            the number of bytes in the shorter value. If the first
            <em class="replaceable"><code>N</code></em> bytes of the two values are
            identical, the shorter value is ordered before the longer
            value.
          </p></li><li class="listitem"><p>
            <code class="literal">BIT</code>
          </p><p>
            Same rules as for <code class="literal">BLOB</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">OPAQUE</code>
          </p><p>
            Same rules as for <code class="literal">BLOB</code>.
            <code class="literal">OPAQUE</code> values are values that are not
            classified as one of the other types.
          </p></li><li class="listitem"><p>
            <code class="literal">DATETIME</code>
          </p><p>
            A value that represents an earlier point in time is ordered
            before a value that represents a later point in time. If two
            values originally come from the MySQL
            <code class="literal">DATETIME</code> and <code class="literal">TIMESTAMP</code>
            types, respectively, they are equal if they represent the
            same point in time.
          </p></li><li class="listitem"><p>
            <code class="literal">TIME</code>
          </p><p>
            The smaller of two time values is ordered before the larger
            one.
          </p></li><li class="listitem"><p>
            <code class="literal">DATE</code>
          </p><p>
            The earlier date is ordered before the more recent date.
          </p></li><li class="listitem"><p>
            <code class="literal">ARRAY</code>
          </p><p>
            Two JSON arrays are equal if they have the same length and
            values in corresponding positions in the arrays are equal.
          </p><p>
            If the arrays are not equal, their order is determined by
            the elements in the first position where there is a
            difference. The array with the smaller value in that
            position is ordered first. If all values of the shorter
            array are equal to the corresponding values in the longer
            array, the shorter array is ordered first.
          </p><p>
            Example:
          </p><pre class="programlisting">[] &lt; [&#34;a&#34;] &lt; [&#34;ab&#34;] &lt; [&#34;ab&#34;, &#34;cd&#34;, &#34;ef&#34;] &lt; [&#34;ab&#34;, &#34;ef&#34;]
</pre></li><li class="listitem"><p>
            <code class="literal">BOOLEAN</code>
          </p><p>
            The JSON false literal is less than the JSON true literal.
          </p></li><li class="listitem"><p>
            <code class="literal">OBJECT</code>
          </p><p>
            Two JSON objects are equal if they have the same set of
            keys, and each key has the same value in both objects.
          </p><p>
            Example:
          </p><pre class="programlisting">{&#34;a&#34;: 1, &#34;b&#34;: 2} = {&#34;b&#34;: 2, &#34;a&#34;: 1}
</pre><p>
            The order of two objects that are not equal is unspecified
            but deterministic.
          </p></li><li class="listitem"><p>
            <code class="literal">STRING</code>
          </p><p>
            Strings are ordered lexically on the first
            <em class="replaceable"><code>N</code></em> bytes of the
            <code class="literal">utf8mb4</code> representation of the two strings
            being compared, where <em class="replaceable"><code>N</code></em> is the
            length of the shorter string. If the first
            <em class="replaceable"><code>N</code></em> bytes of the two strings are
            identical, the shorter string is considered smaller than the
            longer string.
          </p><p>
            Example:
          </p><pre class="programlisting">&#34;a&#34; &lt; &#34;ab&#34; &lt; &#34;b&#34; &lt; &#34;bc&#34;
</pre><p>
            This ordering is equivalent to the ordering of SQL strings
            with collation <code class="literal">utf8mb4_bin</code>. Because
            <code class="literal">utf8mb4_bin</code> is a binary collation,
            comparison of JSON values is case-sensitive:
          </p><pre class="programlisting">&#34;A&#34; &lt; &#34;a&#34;
</pre></li><li class="listitem"><p>
            <code class="literal">INTEGER</code>, <code class="literal">DOUBLE</code>
          </p><p>
            JSON values can contain exact-value numbers and
            approximate-value numbers. For a general discussion of these
            types of numbers, see <a class="xref" href="number-literals.html" title="9.1.2&nbsp;Numeric Literals">Section&nbsp;9.1.2, &ldquo;Numeric Literals&rdquo;</a>.
          </p><p>
            The rules for comparing native MySQL numeric types are
            discussed in <a class="xref" href="type-conversion.html" title="12.3&nbsp;Type Conversion in Expression Evaluation">Section&nbsp;12.3, &ldquo;Type Conversion in Expression Evaluation&rdquo;</a>, but the
            rules for comparing numbers within JSON values differ
            somewhat:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                In a comparison between two columns that use the native
                MySQL <a class="link" href="integer-types.html" title="11.1.2&nbsp;Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INT</code></a> and
                <a class="link" href="floating-point-types.html" title="11.1.4&nbsp;Floating-Point Types (Approximate Value) - FLOAT, DOUBLE"><code class="literal">DOUBLE</code></a> numeric types,
                respectively, it is known that all comparisons involve
                an integer and a double, so the integer is converted to
                double for all rows. That is, exact-value numbers are
                converted to approximate-value numbers.
              </p></li><li class="listitem"><p>
                On the other hand, if the query compares two JSON
                columns containing numbers, it cannot be known in
                advance whether numbers are integer or double. To
                provide the most consistent behavior across all rows,
                MySQL converts approximate-value numbers to exact-value
                numbers. The resulting ordering is consistent and does
                not lose precision for the exact-value numbers. For
                example, given the scalars 9223372036854775805,
                9223372036854775806, 9223372036854775807 and
                9.223372036854776e18, the order is such as this:
              </p><pre class="programlisting">9223372036854775805 &lt; 9223372036854775806 &lt; 9223372036854775807
&lt; 9.223372036854776e18 = 9223372036854776000 &lt; 9223372036854776001
</pre></li></ul></div><p>
            Were JSON comparisons to use the non-JSON numeric comparison
            rules, inconsistent ordering could occur. The usual MySQL
            comparison rules for numbers yield these orderings:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                Integer comparison:
              </p><pre class="programlisting">9223372036854775805 &lt; 9223372036854775806 &lt; 9223372036854775807
</pre><p>
                (not defined for 9.223372036854776e18)
              </p></li><li class="listitem"><p>
                Double comparison:
              </p><pre class="programlisting">9223372036854775805 = 9223372036854775806 = 9223372036854775807 = 9.223372036854776e18
</pre></li></ul></div></li></ul></div><p>
        For comparison of any JSON value to SQL <code class="literal">NULL</code>,
        the result is <code class="literal">UNKNOWN</code>.
      </p><p>
        For comparison of JSON and non-JSON values, the non-JSON value
        is converted to JSON according to the rules in the following
        table, then the values compared as described previously.
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="json-converting-between-types"></a>Converting between JSON and non-JSON values</h3></div></div></div><p>
        The following table provides a summary of the rules that MySQL
        follows when casting between JSON values and values of other
        types:
      </p><div class="oracle-all"><a id="json-conversion-rules"></a><p class="title"><strong>Table&nbsp;11.3&nbsp;JSON Conversion Rules</strong></p><div class="oracle-all-contents"><table summary="Conversion rules for the JSON data type"><colgroup><col style="width: 20%"/><col style="width: 40%"/><col style="width: 40%"/></colgroup><thead><tr>
            <th scope="col">other type</th>
            <th scope="col">CAST(other type AS JSON)</th>
            <th scope="col">CAST(JSON AS other type)</th>
          </tr></thead><tbody><tr>
            <th scope="row">JSON</th>
            <td>No change</td>
            <td>No change</td>
          </tr><tr>
            <th scope="row">utf8 character type (<code class="literal">utf8mb4</code>,
              <code class="literal">utf8mb3</code>, <code class="literal">ascii</code>)</th>
            <td>The string is parsed into a JSON value.</td>
            <td>The JSON value is serialized into a <code class="literal">utf8mb4</code> string.</td>
          </tr><tr>
            <th scope="row">Other character types</th>
            <td>Other character encodings are implicitly converted to
              <code class="literal">utf8mb4</code> and treated as described for
              this character type.</td>
            <td>The JSON value is serialized into a <code class="literal">utf8mb4</code> string,
              then cast to the other character encoding. The result may
              not be meaningful.</td>
          </tr><tr>
            <th scope="row"><code class="literal">NULL</code></th>
            <td>Results in a <code class="literal">NULL</code> value of type JSON.</td>
            <td>Not applicable.</td>
          </tr><tr>
            <th scope="row">Geometry types</th>
            <td>The geometry value is converted into a JSON document by calling
              <a class="link" href="spatial-geojson-functions.html#function_st-asgeojson"><code class="literal">ST_AsGeoJSON()</code></a>.</td>
            <td>Illegal operation. Workaround: Pass the result of
              <a class="link" href="cast-functions.html#function_cast"><code class="literal">CAST(<em class="replaceable"><code>json_val</code></em>
              AS CHAR)</code></a> to
              <a class="link" href="spatial-geojson-functions.html#function_st-geomfromgeojson"><code class="literal">ST_GeomFromGeoJSON()</code></a>.</td>
          </tr><tr>
            <th scope="row">All other types</th>
            <td>Results in a JSON document consisting of a single scalar value.</td>
            <td>Succeeds if the JSON document consists of a single scalar value of the
              target type and that scalar value can be cast to the
              target type. Otherwise, returns <code class="literal">NULL</code>
              and produces a warning.</td>
          </tr></tbody></table></div></div><br class="oracle-all-break"/><p>
        <code class="literal">ORDER BY</code> and <code class="literal">GROUP BY</code> for
        JSON values works according to these principles:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Ordering of scalar JSON values uses the same rules as in the
            preceding discussion.
          </p></li><li class="listitem"><p>
            For ascending sorts, SQL <code class="literal">NULL</code> orders
            before all JSON values, including the JSON null literal; for
            descending sorts, SQL <code class="literal">NULL</code> orders after
            all JSON values, including the JSON null literal.
          </p></li><li class="listitem"><p>
            Sort keys for JSON values are bound by the value of the
            <a class="link" href="server-system-variables.html#sysvar_max_sort_length"><code class="literal">max_sort_length</code></a> system
            variable, so keys that differ only after the first
            <a class="link" href="server-system-variables.html#sysvar_max_sort_length"><code class="literal">max_sort_length</code></a> bytes
            compare as equal.
          </p></li><li class="listitem"><p>
            Sorting of nonscalar values is not currently supported and a
            warning occurs.
          </p></li></ul></div><p>
        For sorting, it can be beneficial to cast a JSON scalar to some
        other native MySQL type. For example, if a column named
        <code class="literal">jdoc</code> contains JSON objects having a member
        consisting of an <code class="literal">id</code> key and a nonnegative
        value, use this expression to sort by <code class="literal">id</code>
        values:
      </p><pre class="programlisting">ORDER BY CAST(JSON_EXTRACT(jdoc, &#39;$.id&#39;) AS UNSIGNED)
</pre><p>
        If there happens to be a generated column defined to use the
        same expression as in the <code class="literal">ORDER BY</code>, the MySQL
        optimizer recognizes that and considers using the index for the
        query execution plan. See
        <a class="xref" href="generated-column-index-optimizations.html" title="8.3.11&nbsp;Optimizer Use of Generated Column Indexes">Section&nbsp;8.3.11, &ldquo;Optimizer Use of Generated Column Indexes&rdquo;</a>.
      </p></div><div class="simplesect"><div class="titlepage"><div><div><h3 class="title"><a id="json-aggregation"></a>Aggregation of JSON Values</h3></div></div></div><p>
        For aggregation of JSON values, SQL <code class="literal">NULL</code>
        values are ignored as for other data types.
        Non-<code class="literal">NULL</code> values are converted to a numeric
        type and aggregated, except for
        <a class="link" href="aggregate-functions.html#function_min"><code class="literal">MIN()</code></a>,
        <a class="link" href="aggregate-functions.html#function_max"><code class="literal">MAX()</code></a>, and
        <a class="link" href="aggregate-functions.html#function_group-concat"><code class="literal">GROUP_CONCAT()</code></a>. The conversion to
        number should produce a meaningful result for JSON values that
        are numeric scalars, although (depending on the values)
        truncation and loss of precision may occur. Conversion to number
        of other JSON values may not produce a meaningful result.
      </p></div></div><div class="navigation"><ul><li class="navLinkPrevious"><a title="Go To Previous Page" href="using-spatial-indexes.html">Previous <span class="navHint"> Using Spatial Indexes </span></a></li><li class="navLinkHome"><a title="Go To Home Page" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a title="Go Up A Level In The Navigation" href="data-types.html">Up <span class="navHint"> Data Types </span></a></li><li class="navLinkNext"><a title="Go To Next Page" href="data-type-defaults.html">Next <span class="navHint"> Data Type Default Values </span></a></li></ul></div><div class="dochomelink-footer"><a title="Go to MySQL Doc Library" href="https://docs.oracle.com/cd/E17952_01/index.html">
        MySQL Documentation Library
      </a></div><div class="copyright-footer"></div></body></html>