<!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><a class="dashingAutolink" name="autolink-1625"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/15.8.8%C2%A0Configuring%20Spin%20Lock%20Polling"></a><title>15.8.8&nbsp;Configuring Spin Lock Polling</title><link rel="stylesheet" type="text/css" href="mvl-otn.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/><link rel="home" href="performance-schema" title="MySQL 8.0 Reference Manual"/><link rel="up" href="innodb-configuration.html" title="15.8&nbsp;InnoDB Configuration"/><link rel="prev" href="innodb-configuring-io-capacity.html" title="15.8.7&nbsp;Configuring InnoDB I/O Capacity"/><link rel="next" href="innodb-purge-configuration.html" title="15.8.9&nbsp;Purge Configuration"/><script>window.ohcglobal || document.write('<script src="../../../en/dcommon/js/global.js">\x3C/script>')</script></head><body><div class="skip-link"><a href="innodb-performance-spin_lock_polling.html#innodb-performance-spin_lock_polling">Skip to Main Content</a></div><div class="DocTitle"><p>MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0</p></div><div class="navigation"><ul><li class="navLinkPrevious"><a accesskey="p" title="Go To Previous Page&nbsp;[access key: p]" href="innodb-configuring-io-capacity.html">Previous <span class="navHint"> Configuring InnoDB I/O Capacity </span></a></li><li class="navLinkHome"><a accesskey="h" title="Go To Home Page&nbsp;[access key: h]" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a accesskey="u" title="Go Up A Level In The Navigation&nbsp;[access key: u]" href="innodb-configuration.html">Up <span class="navHint"> InnoDB Configuration </span></a></li><li class="navLinkNext"><a accesskey="n" title="Go To Next Page&nbsp;[access key: n]" href="innodb-purge-configuration.html">Next <span class="navHint"> Purge Configuration </span></a></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="innodb-performance-spin_lock_polling"></a>15.8.8&nbsp;Configuring Spin Lock Polling</h3></div></div></div><a id="idm45828887651888" class="indexterm"></a><a id="idm45828887650816" class="indexterm"></a><a id="idm45828887649744" class="indexterm"></a><p>
      <code class="literal">InnoDB</code>
      <a class="link" href="glossary.html#glos_mutex" title="mutex">mutexes</a> and
      <a class="link" href="glossary.html#glos_rw_lock" title="rw-lock">rw-locks</a> are typically
      reserved for short intervals. On a multi-core system, it can be
      more efficient for a thread to continuously check if it can
      acquire a mutex or rw-lock for a period of time before it sleeps.
      If the mutex or rw-lock becomes available during this period, the
      thread can continue immediately, in the same time slice. However,
      too-frequent polling of a shared object such as a mutex or rw-lock
      by multiple threads can cause <span class="quote">&ldquo;<span class="quote">cache ping pong</span>&rdquo;</span>,
      which results in processors invalidating portions of each
      other&#39;s cache. <code class="literal">InnoDB</code> minimizes this issue
      by forcing a random delay between polls to desynchronize polling
      activity. The random delay is implemented as a spin-wait loop.
    </p><p>
      The duration of a spin-wait loop is determined by the number of
      PAUSE instructions that occur in the loop. That number is
      generated by randomly selecting an integer ranging from 0 up to
      but not including the
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_delay"><code class="literal">innodb_spin_wait_delay</code></a> value, and
      multiplying that value by 50. (The multiplier value, 50, is
      hardcoded before MySQL 8.0.16, and configurable thereafter.) For
      example, an integer is randomly selected from the following range
      for an <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_delay"><code class="literal">innodb_spin_wait_delay</code></a>
      setting of 6:
    </p><pre class="programlisting">{0,1,2,3,4,5}</pre><p>
      The selected integer is multiplied by 50, resulting in one of six
      possible PAUSE instruction values:
    </p><pre class="programlisting">{0,50,100,150,200,250}</pre><p>
      For that set of values, 250 is the maximum number of PAUSE
      instructions that can occur in a spin-wait loop. An
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_delay"><code class="literal">innodb_spin_wait_delay</code></a> setting of
      5 results in a set of five possible values
      <code class="literal">{0,50,100,150,200}</code>, where 200 is the maximum
      number of PAUSE instructions, and so on. In this way, the
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_delay"><code class="literal">innodb_spin_wait_delay</code></a> setting
      controls the maximum delay between spin lock polls.
    </p><p>
      On a system where all processor cores share a fast cache memory,
      you might reduce the maximum delay or disable the busy loop
      altogether by setting
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_delay"><code class="literal">innodb_spin_wait_delay=0</code></a>. On a
      system with multiple processor chips, the effect of cache
      invalidation can be more significant and you might increase the
      maximum delay.
    </p><p>
      In the 100MHz Pentium era, an
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_delay"><code class="literal">innodb_spin_wait_delay</code></a> unit was
      calibrated to be equivalent to one microsecond. That time
      equivalence did not hold, but PAUSE instruction duration remained
      fairly constant in terms of processor cycles relative to other CPU
      instructions until the introduction of the Skylake generation of
      processors, which have a comparatively longer PAUSE instruction.
      The
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_pause_multiplier"><code class="literal">innodb_spin_wait_pause_multiplier</code></a>
      variable was introduced in MySQL 8.0.16 to provide a way to
      account for differences in PAUSE instruction duration.
    </p><p>
      The
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_pause_multiplier"><code class="literal">innodb_spin_wait_pause_multiplier</code></a>
      variable controls the size of PAUSE instruction values. For
      example, assuming an
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_delay"><code class="literal">innodb_spin_wait_delay</code></a> setting of
      6, decreasing the
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_pause_multiplier"><code class="literal">innodb_spin_wait_pause_multiplier</code></a>
      value from 50 (the default and previously hardcoded value) to 5
      generates a set of smaller PAUSE instruction values:
    </p><pre class="programlisting">{0,5,10,15,20,25}</pre><p>
      The ability to increase or decrease PAUSE instruction values
      permits fine tuning <code class="literal">InnoDB</code> for different
      processor architectures. Smaller PAUSE instruction values would be
      appropriate for processor architectures with a comparatively
      longer PAUSE instruction, for example.
    </p><p>
      The <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_delay"><code class="literal">innodb_spin_wait_delay</code></a> and
      <a class="link" href="innodb-parameters.html#sysvar_innodb_spin_wait_pause_multiplier"><code class="literal">innodb_spin_wait_pause_multiplier</code></a>
      variables are dynamic. They can be specified in a MySQL option
      file or modified at runtime using a
      <a class="link" href="set-variable.html" title="13.7.6.1&nbsp;SET Syntax for Variable Assignment"><code class="literal">SET GLOBAL</code></a>
      statement. Modifying the variables at runtime requires privileges
      sufficient to set global system variables. See
      <a class="xref" href="system-variable-privileges.html" title="5.1.9.1&nbsp;System Variable Privileges">Section&nbsp;5.1.9.1, &ldquo;System Variable Privileges&rdquo;</a>.
    </p></div><div class="navigation"><ul><li class="navLinkPrevious"><a title="Go To Previous Page" href="innodb-configuring-io-capacity.html">Previous <span class="navHint"> Configuring InnoDB I/O Capacity </span></a></li><li class="navLinkHome"><a title="Go To Home Page" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a title="Go Up A Level In The Navigation" href="innodb-configuration.html">Up <span class="navHint"> InnoDB Configuration </span></a></li><li class="navLinkNext"><a title="Go To Next Page" href="innodb-purge-configuration.html">Next <span class="navHint"> Purge Configuration </span></a></li></ul></div><div class="dochomelink-footer"><a title="Go to MySQL Doc Library" href="https://docs.oracle.com/cd/E17952_01/index.html">
        MySQL Documentation Library
      </a></div><div class="copyright-footer"></div></body></html>