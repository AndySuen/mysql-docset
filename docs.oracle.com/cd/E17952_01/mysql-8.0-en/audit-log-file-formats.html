<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>6.4.5.4 Audit Log File Formats</title><link rel="stylesheet" type="text/css" href="mvl-otn.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="performance-schema" title="MySQL 8.0 Reference Manual" /><link rel="up" href="audit-log.html" title="6.4.5 MySQL Enterprise Audit" /><link rel="prev" href="audit-log-security.html" title="6.4.5.3 MySQL Enterprise Audit Security Considerations" /><link rel="next" href="audit-log-logging-configuration.html" title="6.4.5.5 Configuring Audit Logging Characteristics" /><script>window.ohcglobal || document.write('<script src="../../../en/dcommon/js/global.js">\x3C/script>')</script></head><body><div class="skip-link"><a href="audit-log-file-formats.html#audit-log-file-formats">Skip to Main Content</a></div><div class="DocTitle"><p>MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0</p></div><div class="navigation"><ul><li class="navLinkPrevious"><a accesskey="p" title="Go To Previous Page [access key: p]" href="audit-log-security.html">Previous <span class="navHint"> MySQL Enterprise Audit Security Considerations </span></a></li><li class="navLinkHome"><a accesskey="h" title="Go To Home Page [access key: h]" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a accesskey="u" title="Go Up A Level In The Navigation [access key: u]" href="audit-log.html">Up <span class="navHint"> MySQL Enterprise Audit </span></a></li><li class="navLinkNext"><a accesskey="n" title="Go To Next Page [access key: n]" href="audit-log-logging-configuration.html">Next <span class="navHint"> Configuring Audit Logging Characteristics </span></a></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="audit-log-file-formats"></a>6.4.5.4 Audit Log File Formats</h4></div></div></div><p>
        The MySQL server calls the audit log plugin to write an audit
        record to its log file whenever an auditable event occurs.
        Typically the first audit record written after plugin startup
        contains the server description and startup options. Elements
        following that one represent events such as client connect and
        disconnect events, executed SQL statements, and so forth. Only
        top-level statements are logged, not statements within stored
        programs such as triggers or stored procedures. Contents of
        files referenced by statements such as <a class="link" href="load-data.html" title="13.2.9 LOAD DATA Statement"><code class="literal">LOAD
        DATA</code></a> are not logged.
      </p><p>
        To select the log format that the audit log plugin uses to write
        its log file, set the
        <a class="link" href="audit-log-reference.html#sysvar_audit_log_format"><code class="literal">audit_log_format</code></a> system
        variable at server startup. These formats are available:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            New-style XML format
            (<a class="link" href="audit-log-reference.html#sysvar_audit_log_format"><code class="literal">audit_log_format=NEW</code></a>): An
            XML format that has better compatibility with Oracle Audit
            Vault than old-style XML format. MySQL 8.0 uses
            new-style XML format by default.
          </p></li><li class="listitem"><p>
            Old-style XML format
            (<a class="link" href="audit-log-reference.html#sysvar_audit_log_format"><code class="literal">audit_log_format=OLD</code></a>): The
            original audit log format used by default in older MySQL
            series.
          </p></li><li class="listitem"><p>
            JSON format
            (<a class="link" href="audit-log-reference.html#sysvar_audit_log_format"><code class="literal">audit_log_format=JSON</code></a>):
            Writes the audit log as a JSON array. Only this format
            supports the optional query time and size statistics, which
            are available from MySQL 8.0.30.
          </p></li></ul></div><p>
        By default, audit log file contents are written in new-style XML
        format, without compression or encryption.
      </p><p>
        If you change <a class="link" href="audit-log-reference.html#sysvar_audit_log_format"><code class="literal">audit_log_format</code></a>,
        it is recommended that you also change
        <a class="link" href="audit-log-reference.html#sysvar_audit_log_file"><code class="literal">audit_log_file</code></a>. For example, if
        you set <a class="link" href="audit-log-reference.html#sysvar_audit_log_format"><code class="literal">audit_log_format</code></a> to
        <code class="literal">JSON</code>, set
        <a class="link" href="audit-log-reference.html#sysvar_audit_log_file"><code class="literal">audit_log_file</code></a> to
        <code class="literal">audit.json</code>. Otherwise, newer log files will
        have a different format than older files, but they will all have
        the same base name with nothing to indicate when the format
        changed.
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="audit-log-file-formats.html#audit-log-file-new-style-xml-format" title="New-Style XML Audit Log File Format">New-Style XML Audit Log File Format</a></p></li><li class="listitem"><p><a class="xref" href="audit-log-file-formats.html#audit-log-file-old-style-xml-format" title="Old-Style XML Audit Log File Format">Old-Style XML Audit Log File Format</a></p></li><li class="listitem"><p><a class="xref" href="audit-log-file-formats.html#audit-log-file-json-format" title="JSON Audit Log File Format">JSON Audit Log File Format</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a id="audit-log-file-new-style-xml-format"></a>New-Style XML Audit Log File Format</h5></div></div></div><p>
          Here is a sample log file in new-style XML format
          (<a class="link" href="audit-log-reference.html#sysvar_audit_log_format"><code class="literal">audit_log_format=NEW</code></a>),
          reformatted slightly for readability:
        </p><pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;AUDIT&gt;
 &lt;AUDIT_RECORD&gt;
  &lt;TIMESTAMP&gt;2019-10-03T14:06:33 UTC&lt;/TIMESTAMP&gt;
  &lt;RECORD_ID&gt;1_2019-10-03T14:06:33&lt;/RECORD_ID&gt;
  &lt;NAME&gt;Audit&lt;/NAME&gt;
  &lt;SERVER_ID&gt;1&lt;/SERVER_ID&gt;
  &lt;VERSION&gt;1&lt;/VERSION&gt;
  &lt;STARTUP_OPTIONS&gt;/usr/local/mysql/bin/mysqld
    --socket=/usr/local/mysql/mysql.sock
    --port=3306&lt;/STARTUP_OPTIONS&gt;
  &lt;OS_VERSION&gt;i686-Linux&lt;/OS_VERSION&gt;
  &lt;MYSQL_VERSION&gt;5.7.21-log&lt;/MYSQL_VERSION&gt;
 &lt;/AUDIT_RECORD&gt;
 &lt;AUDIT_RECORD&gt;
  &lt;TIMESTAMP&gt;2019-10-03T14:09:38 UTC&lt;/TIMESTAMP&gt;
  &lt;RECORD_ID&gt;2_2019-10-03T14:06:33&lt;/RECORD_ID&gt;
  &lt;NAME&gt;Connect&lt;/NAME&gt;
  &lt;CONNECTION_ID&gt;5&lt;/CONNECTION_ID&gt;
  &lt;STATUS&gt;0&lt;/STATUS&gt;
  &lt;STATUS_CODE&gt;0&lt;/STATUS_CODE&gt;
  &lt;USER&gt;root&lt;/USER&gt;
  &lt;OS_LOGIN/&gt;
  &lt;HOST&gt;localhost&lt;/HOST&gt;
  &lt;IP&gt;127.0.0.1&lt;/IP&gt;
  &lt;COMMAND_CLASS&gt;connect&lt;/COMMAND_CLASS&gt;
  &lt;CONNECTION_TYPE&gt;SSL/TLS&lt;/CONNECTION_TYPE&gt;
  &lt;CONNECTION_ATTRIBUTES&gt;
   &lt;ATTRIBUTE&gt;
    &lt;NAME&gt;_pid&lt;/NAME&gt;
    &lt;VALUE&gt;42794&lt;/VALUE&gt;
   &lt;/ATTRIBUTE&gt;
   ...
   &lt;ATTRIBUTE&gt;
    &lt;NAME&gt;program_name&lt;/NAME&gt;
    &lt;VALUE&gt;mysqladmin&lt;/VALUE&gt;
   &lt;/ATTRIBUTE&gt;
  &lt;/CONNECTION_ATTRIBUTES&gt;
  &lt;PRIV_USER&gt;root&lt;/PRIV_USER&gt;
  &lt;PROXY_USER/&gt;
  &lt;DB&gt;test&lt;/DB&gt;
 &lt;/AUDIT_RECORD&gt;

...

 &lt;AUDIT_RECORD&gt;
  &lt;TIMESTAMP&gt;2019-10-03T14:09:38 UTC&lt;/TIMESTAMP&gt;
  &lt;RECORD_ID&gt;6_2019-10-03T14:06:33&lt;/RECORD_ID&gt;
  &lt;NAME&gt;Query&lt;/NAME&gt;
  &lt;CONNECTION_ID&gt;5&lt;/CONNECTION_ID&gt;
  &lt;STATUS&gt;0&lt;/STATUS&gt;
  &lt;STATUS_CODE&gt;0&lt;/STATUS_CODE&gt;
  &lt;USER&gt;root[root] @ localhost [127.0.0.1]&lt;/USER&gt;
  &lt;OS_LOGIN/&gt;
  &lt;HOST&gt;localhost&lt;/HOST&gt;
  &lt;IP&gt;127.0.0.1&lt;/IP&gt;
  &lt;COMMAND_CLASS&gt;drop_table&lt;/COMMAND_CLASS&gt;
  &lt;SQLTEXT&gt;DROP TABLE IF EXISTS t&lt;/SQLTEXT&gt;
 &lt;/AUDIT_RECORD&gt;

...

 &lt;AUDIT_RECORD&gt;
  &lt;TIMESTAMP&gt;2019-10-03T14:09:39 UTC&lt;/TIMESTAMP&gt;
  &lt;RECORD_ID&gt;8_2019-10-03T14:06:33&lt;/RECORD_ID&gt;
  &lt;NAME&gt;Quit&lt;/NAME&gt;
  &lt;CONNECTION_ID&gt;5&lt;/CONNECTION_ID&gt;
  &lt;STATUS&gt;0&lt;/STATUS&gt;
  &lt;STATUS_CODE&gt;0&lt;/STATUS_CODE&gt;
  &lt;USER&gt;root&lt;/USER&gt;
  &lt;OS_LOGIN/&gt;
  &lt;HOST&gt;localhost&lt;/HOST&gt;
  &lt;IP&gt;127.0.0.1&lt;/IP&gt;
  &lt;COMMAND_CLASS&gt;connect&lt;/COMMAND_CLASS&gt;
  &lt;CONNECTION_TYPE&gt;SSL/TLS&lt;/CONNECTION_TYPE&gt;
 &lt;/AUDIT_RECORD&gt;

...

 &lt;AUDIT_RECORD&gt;
  &lt;TIMESTAMP&gt;2019-10-03T14:09:43 UTC&lt;/TIMESTAMP&gt;
  &lt;RECORD_ID&gt;11_2019-10-03T14:06:33&lt;/RECORD_ID&gt;
  &lt;NAME&gt;Quit&lt;/NAME&gt;
  &lt;CONNECTION_ID&gt;6&lt;/CONNECTION_ID&gt;
  &lt;STATUS&gt;0&lt;/STATUS&gt;
  &lt;STATUS_CODE&gt;0&lt;/STATUS_CODE&gt;
  &lt;USER&gt;root&lt;/USER&gt;
  &lt;OS_LOGIN/&gt;
  &lt;HOST&gt;localhost&lt;/HOST&gt;
  &lt;IP&gt;127.0.0.1&lt;/IP&gt;
  &lt;COMMAND_CLASS&gt;connect&lt;/COMMAND_CLASS&gt;
  &lt;CONNECTION_TYPE&gt;SSL/TLS&lt;/CONNECTION_TYPE&gt;
 &lt;/AUDIT_RECORD&gt;
 &lt;AUDIT_RECORD&gt;
  &lt;TIMESTAMP&gt;2019-10-03T14:09:45 UTC&lt;/TIMESTAMP&gt;
  &lt;RECORD_ID&gt;12_2019-10-03T14:06:33&lt;/RECORD_ID&gt;
  &lt;NAME&gt;NoAudit&lt;/NAME&gt;
  &lt;SERVER_ID&gt;1&lt;/SERVER_ID&gt;
 &lt;/AUDIT_RECORD&gt;
&lt;/AUDIT&gt;
</pre><p>
          The audit log file is written as XML, using UTF-8 (up to 4
          bytes per character). The root element is
          <code class="literal">&lt;AUDIT&gt;</code>. The root element contains
          <code class="literal">&lt;AUDIT_RECORD&gt;</code> elements, each of
          which provides information about an audited event. When the
          audit log plugin begins writing a new log file, it writes the
          XML declaration and opening <code class="literal">&lt;AUDIT&gt;</code>
          root element tag. When the plugin closes a log file, it writes
          the closing <code class="literal">&lt;/AUDIT&gt;</code> root element
          tag. The closing tag is not present while the file is open.
        </p><p>
          Elements within <code class="literal">&lt;AUDIT_RECORD&gt;</code>
          elements have these characteristics:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Some elements appear in every
              <code class="literal">&lt;AUDIT_RECORD&gt;</code> element. Others
              are optional and may appear depending on the audit record
              type.
            </p></li><li class="listitem"><p>
              Order of elements within an
              <code class="literal">&lt;AUDIT_RECORD&gt;</code> element is not
              guaranteed.
            </p></li><li class="listitem"><p>
              Element values are not fixed length. Long values may be
              truncated as indicated in the element descriptions given
              later.
            </p></li><li class="listitem"><p>
              The <code class="literal">&lt;</code>, <code class="literal">&gt;</code>,
              <code class="literal">"</code>, and <code class="literal">&amp;</code>
              characters are encoded as <code class="literal">&amp;lt;</code>,
              <code class="literal">&amp;gt;</code>,
              <code class="literal">&amp;quot;</code>, and
              <code class="literal">&amp;amp;</code>, respectively. NUL bytes
              (U+00) are encoded as the <code class="literal">?</code> character.
            </p></li><li class="listitem"><p>
              Characters not valid as XML characters are encoded using
              numeric character references. Valid XML characters are:
            </p><pre class="programlisting">#x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]
</pre></li></ul></div><p>
          The following elements are mandatory in every
          <code class="literal">&lt;AUDIT_RECORD&gt;</code> element:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">&lt;NAME&gt;</code>
            </p><p>
              A string representing the type of instruction that
              generated the audit event, such as a command that the
              server received from a client.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;NAME&gt;Query&lt;/NAME&gt;
</pre><p>
              Some common <code class="literal">&lt;NAME&gt;</code> values:
            </p><pre class="programlisting">Audit    When auditing starts, which may be server startup time
Connect  When a client connects, also known as logging in
Query    An SQL statement (executed directly)
Prepare  Preparation of an SQL statement; usually followed by Execute
Execute  Execution of an SQL statement; usually follows Prepare
Shutdown Server shutdown
Quit     When a client disconnects
NoAudit  Auditing has been turned off
</pre><p>
              The possible values are <code class="literal">Audit</code>,
              <code class="literal">Binlog Dump</code>, <code class="literal">Change
              user</code>, <code class="literal">Close stmt</code>,
              <code class="literal">Connect Out</code>,
              <code class="literal">Connect</code>, <code class="literal">Create DB</code>,
              <code class="literal">Daemon</code>, <code class="literal">Debug</code>,
              <code class="literal">Delayed insert</code>, <code class="literal">Drop
              DB</code>, <code class="literal">Execute</code>,
              <code class="literal">Fetch</code>, <code class="literal">Field List</code>,
              <code class="literal">Init DB</code>, <code class="literal">Kill</code>,
              <code class="literal">Long Data</code>, <code class="literal">NoAudit</code>,
              <code class="literal">Ping</code>, <code class="literal">Prepare</code>,
              <code class="literal">Processlist</code>, <code class="literal">Query</code>,
              <code class="literal">Quit</code>, <code class="literal">Refresh</code>,
              <code class="literal">Register Slave</code>, <code class="literal">Reset
              stmt</code>, <code class="literal">Set option</code>,
              <code class="literal">Shutdown</code>, <code class="literal">Sleep</code>,
              <code class="literal">Statistics</code>, <code class="literal">Table
              Dump</code>, <code class="literal">TableDelete</code>,
              <code class="literal">TableInsert</code>,
              <code class="literal">TableRead</code>,
              <code class="literal">TableUpdate</code>, <code class="literal">Time</code>.
            </p><p>
              Many of these values correspond to the
              <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code>
              command values listed in the
              <code class="filename">my_command.h</code> header file. For
              example, <code class="literal">Create DB</code> and <code class="literal">Change
              user</code> correspond to
              <code class="literal">COM_CREATE_DB</code> and
              <code class="literal">COM_CHANGE_USER</code>, respectively.
            </p><p>
              Events having <code class="literal">&lt;NAME&gt;</code> values of
              <code class="literal">Table<em class="replaceable"><code>XXX</code></em></code>
              accompany <code class="literal">Query</code> events. For example,
              the following statement generates one
              <code class="literal">Query</code> event, two
              <code class="literal">TableRead</code> events, and a
              <code class="literal">TableInsert</code> events:
            </p><pre class="programlisting">INSERT INTO t3 SELECT t1.* FROM t1 JOIN t2;
</pre><p>
              Each
              <code class="literal">Table<em class="replaceable"><code>XXX</code></em></code>
              event contains <code class="literal">&lt;TABLE&gt;</code> and
              <code class="literal">&lt;DB&gt;</code> elements to identify the
              table to which the event refers and the database that
              contains the table.
            </p></li><li class="listitem"><p>
              <code class="literal">&lt;RECORD_ID&gt;</code>
            </p><p>
              A unique identifier for the audit record. The value is
              composed from a sequence number and timestamp, in the
              format
              <code class="literal"><em class="replaceable"><code>SEQ_TIMESTAMP</code></em></code>.
              When the audit log plugin opens the audit log file, it
              initializes the sequence number to the size of the audit
              log file, then increments the sequence by 1 for each
              record logged. The timestamp is a UTC value in
              <code class="literal"><em class="replaceable"><code>YYYY-MM-DD</code></em>T<em class="replaceable"><code>hh:mm:ss</code></em></code>
              format indicating the date and time when the audit log
              plugin opened the file.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;RECORD_ID&gt;12_2019-10-03T14:06:33&lt;/RECORD_ID&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;TIMESTAMP&gt;</code>
            </p><p>
              A string representing a UTC value in
              <code class="literal"><em class="replaceable"><code>YYYY-MM-DD</code></em>T<em class="replaceable"><code>hh:mm:ss</code></em>
              UTC</code> format indicating the date and time when the
              audit event was generated. For example, the event
              corresponding to execution of an SQL statement received
              from a client has a <code class="literal">&lt;TIMESTAMP&gt;</code>
              value occurring after the statement finishes, not when it
              was received.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;TIMESTAMP&gt;2019-10-03T14:09:45 UTC&lt;/TIMESTAMP&gt;
</pre></li></ul></div><p>
          The following elements are optional in
          <code class="literal">&lt;AUDIT_RECORD&gt;</code> elements. Many of them
          occur only with specific <code class="literal">&lt;NAME&gt;</code>
          element values.
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">&lt;COMMAND_CLASS&gt;</code>
            </p><p>
              A string that indicates the type of action performed.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;COMMAND_CLASS&gt;drop_table&lt;/COMMAND_CLASS&gt;
</pre><p>
              The values correspond to the
              <code class="literal">statement/sql/<em class="replaceable"><code>xxx</code></em></code>
              command counters. For example,
              <em class="replaceable"><code>xxx</code></em> is
              <code class="literal">drop_table</code> and
              <code class="literal">select</code> for <a class="link" href="drop-table.html" title="13.1.32 DROP TABLE Statement"><code class="literal">DROP
              TABLE</code></a> and <a class="link" href="select.html" title="13.2.13 SELECT Statement"><code class="literal">SELECT</code></a>
              statements, respectively. The following statement displays
              the possible names:
            </p><pre class="programlisting">SELECT REPLACE(EVENT_NAME, 'statement/sql/', '') AS name
FROM performance_schema.events_statements_summary_global_by_event_name
WHERE EVENT_NAME LIKE 'statement/sql/%'
ORDER BY name;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;CONNECTION_ATTRIBUTES&gt;</code>
            </p><p>
              As of MySQL 8.0.19, events with a
              <code class="literal">&lt;COMMAND_CLASS&gt;</code> value of
              <code class="literal">connect</code> may include a
              <code class="literal">&lt;CONNECTION_ATTRIBUTES&gt;</code> element
              to display the connection attributes passed by the client
              at connect time. (For information about these attributes,
              which are also exposed in Performance Schema tables, see
              <a class="xref" href="performance-schema-connection-attribute-tables.html" title="27.12.9 Performance Schema Connection Attribute Tables">Section 27.12.9, “Performance Schema Connection Attribute Tables”</a>.)
            </p><p>
              The <code class="literal">&lt;CONNECTION_ATTRIBUTES&gt;</code>
              element contains one <code class="literal">&lt;ATTRIBUTE&gt;</code>
              element per attribute, each of which contains
              <code class="literal">&lt;NAME&gt;</code> and
              <code class="literal">&lt;VALUE&gt;</code> elements to indicate the
              attribute name and value, respectively.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;CONNECTION_ATTRIBUTES&gt;
 &lt;ATTRIBUTE&gt;
  &lt;NAME&gt;_pid&lt;/NAME&gt;
  &lt;VALUE&gt;42794&lt;/VALUE&gt;
 &lt;/ATTRIBUTE&gt;
 &lt;ATTRIBUTE&gt;
  &lt;NAME&gt;_os&lt;/NAME&gt;
  &lt;VALUE&gt;macos0.14&lt;/VALUE&gt;
 &lt;/ATTRIBUTE&gt;
 &lt;ATTRIBUTE&gt;
  &lt;NAME&gt;_platform&lt;/NAME&gt;
  &lt;VALUE&gt;x86_64&lt;/VALUE&gt;
 &lt;/ATTRIBUTE&gt;
 &lt;ATTRIBUTE&gt;
  &lt;NAME&gt;_client_version&lt;/NAME&gt;
  &lt;VALUE&gt;8.0.19&lt;/VALUE&gt;
 &lt;/ATTRIBUTE&gt;
 &lt;ATTRIBUTE&gt;
  &lt;NAME&gt;_client_name&lt;/NAME&gt;
  &lt;VALUE&gt;libmysql&lt;/VALUE&gt;
 &lt;/ATTRIBUTE&gt;
 &lt;ATTRIBUTE&gt;
  &lt;NAME&gt;program_name&lt;/NAME&gt;
  &lt;VALUE&gt;mysqladmin&lt;/VALUE&gt;
 &lt;/ATTRIBUTE&gt;
&lt;/CONNECTION_ATTRIBUTES&gt;
</pre><p>
              If no connection attributes are present in the event, none
              are logged and no
              <code class="literal">&lt;CONNECTION_ATTRIBUTES&gt;</code> element
              appears. This can occur if the connection attempt is
              unsuccessful, the client passes no attributes, or the
              connection occurs internally such as during server startup
              or when initiated by a plugin.
            </p></li><li class="listitem"><p>
              <code class="literal">&lt;CONNECTION_ID&gt;</code>
            </p><p>
              An unsigned integer representing the client connection
              identifier. This is the same as the value returned by the
              <a class="link" href="information-functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a> function
              within the session.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;CONNECTION_ID&gt;127&lt;/CONNECTION_ID&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;CONNECTION_TYPE&gt;</code>
            </p><p>
              The security state of the connection to the server.
              Permitted values are <code class="literal">TCP/IP</code> (TCP/IP
              connection established without encryption),
              <code class="literal">SSL/TLS</code> (TCP/IP connection established
              with encryption), <code class="literal">Socket</code> (Unix socket
              file connection), <code class="literal">Named Pipe</code> (Windows
              named pipe connection), and <code class="literal">Shared
              Memory</code> (Windows shared memory connection).
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;CONNECTION_TYPE&gt;SSL/TLS&lt;/CONNECTION_TYPE&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;DB&gt;</code>
            </p><p>
              A string representing a database name.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;DB&gt;test&lt;/DB&gt;
</pre><p>
              For connect events, this element indicates the default
              database; the element is empty if there is no default
              database. For table-access events, the element indicates
              the database to which the accessed table belongs.
            </p></li><li class="listitem"><p>
              <code class="literal">&lt;HOST&gt;</code>
            </p><p>
              A string representing the client host name.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;HOST&gt;localhost&lt;/HOST&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;IP&gt;</code>
            </p><p>
              A string representing the client IP address.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;IP&gt;127.0.0.1&lt;/IP&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;MYSQL_VERSION&gt;</code>
            </p><p>
              A string representing the MySQL server version. This is
              the same as the value of the
              <a class="link" href="information-functions.html#function_version"><code class="literal">VERSION()</code></a> function or
              <a class="link" href="server-system-variables.html#sysvar_version"><code class="literal">version</code></a> system variable.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;MYSQL_VERSION&gt;5.7.21-log&lt;/MYSQL_VERSION&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;OS_LOGIN&gt;</code>
            </p><p>
              A string representing the external user name used during
              the authentication process, as set by the plugin used to
              authenticate the client. With native (built-in) MySQL
              authentication, or if the plugin does not set the value,
              this element is empty. The value is the same as that of
              the <a class="link" href="server-system-variables.html#sysvar_external_user"><code class="literal">external_user</code></a> system
              variable (see <a class="xref" href="proxy-users.html" title="6.2.19 Proxy Users">Section 6.2.19, “Proxy Users”</a>).
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;OS_LOGIN&gt;jeffrey&lt;/OS_LOGIN&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;OS_VERSION&gt;</code>
            </p><p>
              A string representing the operating system on which the
              server was built or is running.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;OS_VERSION&gt;x86_64-Linux&lt;/OS_VERSION&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;PRIV_USER&gt;</code>
            </p><p>
              A string representing the user that the server
              authenticated the client as. This is the user name that
              the server uses for privilege checking, and may differ
              from the <code class="literal">&lt;USER&gt;</code> value.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;PRIV_USER&gt;jeffrey&lt;/PRIV_USER&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;PROXY_USER&gt;</code>
            </p><p>
              A string representing the proxy user (see
              <a class="xref" href="proxy-users.html" title="6.2.19 Proxy Users">Section 6.2.19, “Proxy Users”</a>). The value is empty if user
              proxying is not in effect.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;PROXY_USER&gt;developer&lt;/PROXY_USER&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;SERVER_ID&gt;</code>
            </p><p>
              An unsigned integer representing the server ID. This is
              the same as the value of the
              <a class="link" href="replication-options.html#sysvar_server_id"><code class="literal">server_id</code></a> system
              variable.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;SERVER_ID&gt;1&lt;/SERVER_ID&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;SQLTEXT&gt;</code>
            </p><p>
              A string representing the text of an SQL statement. The
              value can be empty. Long values may be truncated. The
              string, like the audit log file itself, is written using
              UTF-8 (up to 4 bytes per character), so the value may be
              the result of conversion. For example, the original
              statement might have been received from the client as an
              SJIS string.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;SQLTEXT&gt;DELETE FROM t1&lt;/SQLTEXT&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;STARTUP_OPTIONS&gt;</code>
            </p><p>
              A string representing the options that were given on the
              command line or in option files when the MySQL server was
              started. The first option is the path to the server
              executable.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;STARTUP_OPTIONS&gt;/usr/local/mysql/bin/mysqld
  --port=3306 --log_output=FILE&lt;/STARTUP_OPTIONS&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;STATUS&gt;</code>
            </p><p>
              An unsigned integer representing the command status: 0 for
              success, nonzero if an error occurred. This is the same as
              the value of the
              <a class="ulink" href="https://docs.oracle.com/cd/E17952_01/c-api-8.0-en/mysql-errno.html" target="_top"><code class="literal">mysql_errno()</code></a> C API
              function. See the description for
              <code class="literal">&lt;STATUS_CODE&gt;</code> for information
              about how it differs from
              <code class="literal">&lt;STATUS&gt;</code>.
            </p><p>
              The audit log does not contain the SQLSTATE value or error
              message. To see the associations between error codes,
              SQLSTATE values, and messages, see
              <a class="ulink" href="https://docs.oracle.com/cd/E17952_01/mysql-errors-8.0-en/server-error-reference.html" target="_top">Server Error Message Reference</a>.
            </p><p>
              Warnings are not logged.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;STATUS&gt;1051&lt;/STATUS&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;STATUS_CODE&gt;</code>
            </p><p>
              An unsigned integer representing the command status: 0 for
              success, 1 if an error occurred.
            </p><p>
              The <code class="literal">STATUS_CODE</code> value differs from the
              <code class="literal">STATUS</code> value:
              <code class="literal">STATUS_CODE</code> is 0 for success and 1 for
              error, which is compatible with the EZ_collector consumer
              for Audit Vault. <code class="literal">STATUS</code> is the value of
              the <a class="ulink" href="https://docs.oracle.com/cd/E17952_01/c-api-8.0-en/mysql-errno.html" target="_top"><code class="literal">mysql_errno()</code></a> C API
              function. This is 0 for success and nonzero for error, and
              thus is not necessarily 1 for error.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;STATUS_CODE&gt;0&lt;/STATUS_CODE&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;TABLE&gt;</code>
            </p><p>
              A string representing a table name.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;TABLE&gt;t3&lt;/TABLE&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;USER&gt;</code>
            </p><p>
              A string representing the user name sent by the client.
              This may differ from the
              <code class="literal">&lt;PRIV_USER&gt;</code> value.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;USER&gt;root[root] @ localhost [127.0.0.1]&lt;/USER&gt;
</pre></li><li class="listitem"><p>
              <code class="literal">&lt;VERSION&gt;</code>
            </p><p>
              An unsigned integer representing the version of the audit
              log file format.
            </p><p>
              Example:
            </p><pre class="programlisting">&lt;VERSION&gt;1&lt;/VERSION&gt;
</pre></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a id="audit-log-file-old-style-xml-format"></a>Old-Style XML Audit Log File Format</h5></div></div></div><p>
          Here is a sample log file in old-style XML format
          (<a class="link" href="audit-log-reference.html#sysvar_audit_log_format"><code class="literal">audit_log_format=OLD</code></a>),
          reformatted slightly for readability:
        </p><pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;AUDIT&gt;
  &lt;AUDIT_RECORD
    TIMESTAMP="2019-10-03T14:25:00 UTC"
    RECORD_ID="1_2019-10-03T14:25:00"
    NAME="Audit"
    SERVER_ID="1"
    VERSION="1"
    STARTUP_OPTIONS="--port=3306"
    OS_VERSION="i686-Linux"
    MYSQL_VERSION="5.7.21-log"/&gt;
  &lt;AUDIT_RECORD
    TIMESTAMP="2019-10-03T14:25:24 UTC"
    RECORD_ID="2_2019-10-03T14:25:00"
    NAME="Connect"
    CONNECTION_ID="4"
    STATUS="0"
    STATUS_CODE="0"
    USER="root"
    OS_LOGIN=""
    HOST="localhost"
    IP="127.0.0.1"
    COMMAND_CLASS="connect"
    CONNECTION_TYPE="SSL/TLS"
    PRIV_USER="root"
    PROXY_USER=""
    DB="test"/&gt;

...

  &lt;AUDIT_RECORD
    TIMESTAMP="2019-10-03T14:25:24 UTC"
    RECORD_ID="6_2019-10-03T14:25:00"
    NAME="Query"
    CONNECTION_ID="4"
    STATUS="0"
    STATUS_CODE="0"
    USER="root[root] @ localhost [127.0.0.1]"
    OS_LOGIN=""
    HOST="localhost"
    IP="127.0.0.1"
    COMMAND_CLASS="drop_table"
    SQLTEXT="DROP TABLE IF EXISTS t"/&gt;

...

  &lt;AUDIT_RECORD
    TIMESTAMP="2019-10-03T14:25:24 UTC"
    RECORD_ID="8_2019-10-03T14:25:00"
    NAME="Quit"
    CONNECTION_ID="4"
    STATUS="0"
    STATUS_CODE="0"
    USER="root"
    OS_LOGIN=""
    HOST="localhost"
    IP="127.0.0.1"
    COMMAND_CLASS="connect"
    CONNECTION_TYPE="SSL/TLS"/&gt;
  &lt;AUDIT_RECORD
    TIMESTAMP="2019-10-03T14:25:32 UTC"
    RECORD_ID="12_2019-10-03T14:25:00"
    NAME="NoAudit"
    SERVER_ID="1"/&gt;
&lt;/AUDIT&gt;
</pre><p>
          The audit log file is written as XML, using UTF-8 (up to 4
          bytes per character). The root element is
          <code class="literal">&lt;AUDIT&gt;</code>. The root element contains
          <code class="literal">&lt;AUDIT_RECORD&gt;</code> elements, each of
          which provides information about an audited event. When the
          audit log plugin begins writing a new log file, it writes the
          XML declaration and opening <code class="literal">&lt;AUDIT&gt;</code>
          root element tag. When the plugin closes a log file, it writes
          the closing <code class="literal">&lt;/AUDIT&gt;</code> root element
          tag. The closing tag is not present while the file is open.
        </p><p>
          Attributes of <code class="literal">&lt;AUDIT_RECORD&gt;</code> elements
          have these characteristics:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Some attributes appear in every
              <code class="literal">&lt;AUDIT_RECORD&gt;</code> element. Others
              are optional and may appear depending on the audit record
              type.
            </p></li><li class="listitem"><p>
              Order of attributes within an
              <code class="literal">&lt;AUDIT_RECORD&gt;</code> element is not
              guaranteed.
            </p></li><li class="listitem"><p>
              Attribute values are not fixed length. Long values may be
              truncated as indicated in the attribute descriptions given
              later.
            </p></li><li class="listitem"><p>
              The <code class="literal">&lt;</code>, <code class="literal">&gt;</code>,
              <code class="literal">"</code>, and <code class="literal">&amp;</code>
              characters are encoded as <code class="literal">&amp;lt;</code>,
              <code class="literal">&amp;gt;</code>,
              <code class="literal">&amp;quot;</code>, and
              <code class="literal">&amp;amp;</code>, respectively. NUL bytes
              (U+00) are encoded as the <code class="literal">?</code> character.
            </p></li><li class="listitem"><p>
              Characters not valid as XML characters are encoded using
              numeric character references. Valid XML characters are:
            </p><pre class="programlisting">#x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]
</pre></li></ul></div><p>
          The following attributes are mandatory in every
          <code class="literal">&lt;AUDIT_RECORD&gt;</code> element:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              A string representing the type of instruction that
              generated the audit event, such as a command that the
              server received from a client.
            </p><p>
              Example: <code class="literal">NAME="Query"</code>
            </p><p>
              Some common <code class="literal">NAME</code> values:
            </p><pre class="programlisting">Audit    When auditing starts, which may be server startup time
Connect  When a client connects, also known as logging in
Query    An SQL statement (executed directly)
Prepare  Preparation of an SQL statement; usually followed by Execute
Execute  Execution of an SQL statement; usually follows Prepare
Shutdown Server shutdown
Quit     When a client disconnects
NoAudit  Auditing has been turned off
</pre><p>
              The possible values are <code class="literal">Audit</code>,
              <code class="literal">Binlog Dump</code>, <code class="literal">Change
              user</code>, <code class="literal">Close stmt</code>,
              <code class="literal">Connect Out</code>,
              <code class="literal">Connect</code>, <code class="literal">Create DB</code>,
              <code class="literal">Daemon</code>, <code class="literal">Debug</code>,
              <code class="literal">Delayed insert</code>, <code class="literal">Drop
              DB</code>, <code class="literal">Execute</code>,
              <code class="literal">Fetch</code>, <code class="literal">Field List</code>,
              <code class="literal">Init DB</code>, <code class="literal">Kill</code>,
              <code class="literal">Long Data</code>, <code class="literal">NoAudit</code>,
              <code class="literal">Ping</code>, <code class="literal">Prepare</code>,
              <code class="literal">Processlist</code>, <code class="literal">Query</code>,
              <code class="literal">Quit</code>, <code class="literal">Refresh</code>,
              <code class="literal">Register Slave</code>, <code class="literal">Reset
              stmt</code>, <code class="literal">Set option</code>,
              <code class="literal">Shutdown</code>, <code class="literal">Sleep</code>,
              <code class="literal">Statistics</code>, <code class="literal">Table
              Dump</code>, <code class="literal">TableDelete</code>,
              <code class="literal">TableInsert</code>,
              <code class="literal">TableRead</code>,
              <code class="literal">TableUpdate</code>, <code class="literal">Time</code>.
            </p><p>
              Many of these values correspond to the
              <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code>
              command values listed in the
              <code class="filename">my_command.h</code> header file. For
              example, <code class="literal">"Create DB"</code> and
              <code class="literal">"Change user"</code> correspond to
              <code class="literal">COM_CREATE_DB</code> and
              <code class="literal">COM_CHANGE_USER</code>, respectively.
            </p><p>
              Events having <code class="literal">NAME</code> values of
              <code class="literal">Table<em class="replaceable"><code>XXX</code></em></code>
              accompany <code class="literal">Query</code> events. For example,
              the following statement generates one
              <code class="literal">Query</code> event, two
              <code class="literal">TableRead</code> events, and a
              <code class="literal">TableInsert</code> events:
            </p><pre class="programlisting">INSERT INTO t3 SELECT t1.* FROM t1 JOIN t2;
</pre><p>
              Each
              <code class="literal">Table<em class="replaceable"><code>XXX</code></em></code>
              event has <code class="literal">TABLE</code> and
              <code class="literal">DB</code> attributes to identify the table to
              which the event refers and the database that contains the
              table.
            </p><p>
              <code class="literal">Connect</code> events for old-style XML audit
              log format do not include connection attributes.
            </p></li><li class="listitem"><p>
              <code class="literal">RECORD_ID</code>
            </p><p>
              A unique identifier for the audit record. The value is
              composed from a sequence number and timestamp, in the
              format
              <code class="literal"><em class="replaceable"><code>SEQ_TIMESTAMP</code></em></code>.
              When the audit log plugin opens the audit log file, it
              initializes the sequence number to the size of the audit
              log file, then increments the sequence by 1 for each
              record logged. The timestamp is a UTC value in
              <code class="literal"><em class="replaceable"><code>YYYY-MM-DD</code></em>T<em class="replaceable"><code>hh:mm:ss</code></em></code>
              format indicating the date and time when the audit log
              plugin opened the file.
            </p><p>
              Example:
              <code class="literal">RECORD_ID="12_2019-10-03T14:25:00"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">TIMESTAMP</code>
            </p><p>
              A string representing a UTC value in
              <code class="literal"><em class="replaceable"><code>YYYY-MM-DD</code></em>T<em class="replaceable"><code>hh:mm:ss</code></em>
              UTC</code> format indicating the date and time when the
              audit event was generated. For example, the event
              corresponding to execution of an SQL statement received
              from a client has a <code class="literal">TIMESTAMP</code> value
              occurring after the statement finishes, not when it was
              received.
            </p><p>
              Example: <code class="literal">TIMESTAMP="2019-10-03T14:25:32
              UTC"</code>
            </p></li></ul></div><p>
          The following attributes are optional in
          <code class="literal">&lt;AUDIT_RECORD&gt;</code> elements. Many of them
          occur only for elements with specific values of the
          <code class="literal">NAME</code> attribute.
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COMMAND_CLASS</code>
            </p><p>
              A string that indicates the type of action performed.
            </p><p>
              Example: <code class="literal">COMMAND_CLASS="drop_table"</code>
            </p><p>
              The values correspond to the
              <code class="literal">statement/sql/<em class="replaceable"><code>xxx</code></em></code>
              command counters. For example,
              <em class="replaceable"><code>xxx</code></em> is
              <code class="literal">drop_table</code> and
              <code class="literal">select</code> for <a class="link" href="drop-table.html" title="13.1.32 DROP TABLE Statement"><code class="literal">DROP
              TABLE</code></a> and <a class="link" href="select.html" title="13.2.13 SELECT Statement"><code class="literal">SELECT</code></a>
              statements, respectively. The following statement displays
              the possible names:
            </p><pre class="programlisting">SELECT REPLACE(EVENT_NAME, 'statement/sql/', '') AS name
FROM performance_schema.events_statements_summary_global_by_event_name
WHERE EVENT_NAME LIKE 'statement/sql/%'
ORDER BY name;
</pre></li><li class="listitem"><p>
              <code class="literal">CONNECTION_ID</code>
            </p><p>
              An unsigned integer representing the client connection
              identifier. This is the same as the value returned by the
              <a class="link" href="information-functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a> function
              within the session.
            </p><p>
              Example: <code class="literal">CONNECTION_ID="127"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CONNECTION_TYPE</code>
            </p><p>
              The security state of the connection to the server.
              Permitted values are <code class="literal">TCP/IP</code> (TCP/IP
              connection established without encryption),
              <code class="literal">SSL/TLS</code> (TCP/IP connection established
              with encryption), <code class="literal">Socket</code> (Unix socket
              file connection), <code class="literal">Named Pipe</code> (Windows
              named pipe connection), and <code class="literal">Shared
              Memory</code> (Windows shared memory connection).
            </p><p>
              Example: <code class="literal">CONNECTION_TYPE="SSL/TLS"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">DB</code>
            </p><p>
              A string representing a database name.
            </p><p>
              Example: <code class="literal">DB="test"</code>
            </p><p>
              For connect events, this attribute indicates the default
              database; the attribute is empty if there is no default
              database. For table-access events, the attribute indicates
              the database to which the accessed table belongs.
            </p></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              A string representing the client host name.
            </p><p>
              Example: <code class="literal">HOST="localhost"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">IP</code>
            </p><p>
              A string representing the client IP address.
            </p><p>
              Example: <code class="literal">IP="127.0.0.1"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_VERSION</code>
            </p><p>
              A string representing the MySQL server version. This is
              the same as the value of the
              <a class="link" href="information-functions.html#function_version"><code class="literal">VERSION()</code></a> function or
              <a class="link" href="server-system-variables.html#sysvar_version"><code class="literal">version</code></a> system variable.
            </p><p>
              Example: <code class="literal">MYSQL_VERSION="5.7.21-log"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">OS_LOGIN</code>
            </p><p>
              A string representing the external user name used during
              the authentication process, as set by the plugin used to
              authenticate the client. With native (built-in) MySQL
              authentication, or if the plugin does not set the value,
              this attribute is empty. The value is the same as that of
              the <a class="link" href="server-system-variables.html#sysvar_external_user"><code class="literal">external_user</code></a> system
              variable (see <a class="xref" href="proxy-users.html" title="6.2.19 Proxy Users">Section 6.2.19, “Proxy Users”</a>).
            </p><p>
              Example: <code class="literal">OS_LOGIN="jeffrey"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">OS_VERSION</code>
            </p><p>
              A string representing the operating system on which the
              server was built or is running.
            </p><p>
              Example: <code class="literal">OS_VERSION="x86_64-Linux"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">PRIV_USER</code>
            </p><p>
              A string representing the user that the server
              authenticated the client as. This is the user name that
              the server uses for privilege checking, and it may differ
              from the <code class="literal">USER</code> value.
            </p><p>
              Example: <code class="literal">PRIV_USER="jeffrey"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">PROXY_USER</code>
            </p><p>
              A string representing the proxy user (see
              <a class="xref" href="proxy-users.html" title="6.2.19 Proxy Users">Section 6.2.19, “Proxy Users”</a>). The value is empty if user
              proxying is not in effect.
            </p><p>
              Example: <code class="literal">PROXY_USER="developer"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">SERVER_ID</code>
            </p><p>
              An unsigned integer representing the server ID. This is
              the same as the value of the
              <a class="link" href="replication-options.html#sysvar_server_id"><code class="literal">server_id</code></a> system
              variable.
            </p><p>
              Example: <code class="literal">SERVER_ID="1"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">SQLTEXT</code>
            </p><p>
              A string representing the text of an SQL statement. The
              value can be empty. Long values may be truncated. The
              string, like the audit log file itself, is written using
              UTF-8 (up to 4 bytes per character), so the value may be
              the result of conversion. For example, the original
              statement might have been received from the client as an
              SJIS string.
            </p><p>
              Example: <code class="literal">SQLTEXT="DELETE FROM t1"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">STARTUP_OPTIONS</code>
            </p><p>
              A string representing the options that were given on the
              command line or in option files when the MySQL server was
              started.
            </p><p>
              Example: <code class="literal">STARTUP_OPTIONS="--port=3306
              --log_output=FILE"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">STATUS</code>
            </p><p>
              An unsigned integer representing the command status: 0 for
              success, nonzero if an error occurred. This is the same as
              the value of the
              <a class="ulink" href="https://docs.oracle.com/cd/E17952_01/c-api-8.0-en/mysql-errno.html" target="_top"><code class="literal">mysql_errno()</code></a> C API
              function. See the description for
              <code class="literal">STATUS_CODE</code> for information about how
              it differs from <code class="literal">STATUS</code>.
            </p><p>
              The audit log does not contain the SQLSTATE value or error
              message. To see the associations between error codes,
              SQLSTATE values, and messages, see
              <a class="ulink" href="https://docs.oracle.com/cd/E17952_01/mysql-errors-8.0-en/server-error-reference.html" target="_top">Server Error Message Reference</a>.
            </p><p>
              Warnings are not logged.
            </p><p>
              Example: <code class="literal">STATUS="1051"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">STATUS_CODE</code>
            </p><p>
              An unsigned integer representing the command status: 0 for
              success, 1 if an error occurred.
            </p><p>
              The <code class="literal">STATUS_CODE</code> value differs from the
              <code class="literal">STATUS</code> value:
              <code class="literal">STATUS_CODE</code> is 0 for success and 1 for
              error, which is compatible with the EZ_collector consumer
              for Audit Vault. <code class="literal">STATUS</code> is the value of
              the <a class="ulink" href="https://docs.oracle.com/cd/E17952_01/c-api-8.0-en/mysql-errno.html" target="_top"><code class="literal">mysql_errno()</code></a> C API
              function. This is 0 for success and nonzero for error, and
              thus is not necessarily 1 for error.
            </p><p>
              Example: <code class="literal">STATUS_CODE="0"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">TABLE</code>
            </p><p>
              A string representing a table name.
            </p><p>
              Example: <code class="literal">TABLE="t3"</code>
            </p></li><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              A string representing the user name sent by the client.
              This may differ from the <code class="literal">PRIV_USER</code>
              value.
            </p></li><li class="listitem"><p>
              <code class="literal">VERSION</code>
            </p><p>
              An unsigned integer representing the version of the audit
              log file format.
            </p><p>
              Example: <code class="literal">VERSION="1"</code>
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a id="audit-log-file-json-format"></a>JSON Audit Log File Format</h5></div></div></div><p>
          For JSON-format audit logging
          (<a class="link" href="audit-log-reference.html#sysvar_audit_log_format"><code class="literal">audit_log_format=JSON</code></a>), the
          log file contents form a <a class="link" href="json.html" title="11.5 The JSON Data Type"><code class="literal">JSON</code></a>
          array with each array element representing an audited event as
          a <a class="link" href="json.html" title="11.5 The JSON Data Type"><code class="literal">JSON</code></a> hash of key-value pairs.
          Examples of complete event records appear later in this
          section. The following is an excerpt of partial events:
        </p><pre class="programlisting">[
  {
    "timestamp": "2019-10-03 13:50:01",
    "id": 0,
    "class": "audit",
    "event": "startup",
    ...
  },
  {
    "timestamp": "2019-10-03 15:02:32",
    "id": 0,
    "class": "connection",
    "event": "connect",
    ...
  },
  ...
  {
    "timestamp": "2019-10-03 17:37:26",
    "id": 0,
    "class": "table_access",
    "event": "insert",
      ...
  }
  ...
]
</pre><p>
          The audit log file is written using UTF-8 (up to 4 bytes per
          character). When the audit log plugin begins writing a new log
          file, it writes the opening <code class="literal">[</code> array marker.
          When the plugin closes a log file, it writes the closing
          <code class="literal">]</code> array marker. The closing marker is not
          present while the file is open.
        </p><p>
          Items within audit records have these characteristics:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Some items appear in every audit record. Others are
              optional and may appear depending on the audit record
              type.
            </p></li><li class="listitem"><p>
              Order of items within an audit record is not guaranteed.
            </p></li><li class="listitem"><p>
              Item values are not fixed length. Long values may be
              truncated as indicated in the item descriptions given
              later.
            </p></li><li class="listitem"><p>
              The <code class="literal">"</code> and <code class="literal">\</code>
              characters are encoded as <code class="literal">\"</code> and
              <code class="literal">\\</code>, respectively.
            </p></li></ul></div><p>
          JSON format is the only audit log file format that supports
          the optional query time and size statistics, which are
          available from MySQL 8.0.30. This data is available in the
          slow query log for qualifying queries, and in the context of
          the audit log it similarly helps to detect outliers for
          activity analysis.
        </p><p>
          To add the query statistics to the log file, you must set them
          up as a filter using the
          <a class="link" href="audit-log-reference.html#function_audit-log-filter-set-filter"><code class="literal">audit_log_filter_set_filter()</code></a>
          audit log function as the service element of the JSON
          filtering syntax. For instructions to do this, see
          <a class="xref" href="audit-log-logging-configuration.html#audit-log-query-statistics" title="Adding Query Statistics for Outlier Detection">Adding Query Statistics for Outlier Detection</a>. For the
          <code class="literal">bytes_sent</code> and
          <code class="literal">bytes_received</code> fields to be populated, the
          system variable
          <a class="link" href="server-system-variables.html#sysvar_log_slow_extra"><code class="literal">log_slow_extra</code></a>
          must be set to ON.
        </p><p>
          The following examples show the JSON object formats for
          different event types (as indicated by the
          <code class="literal">class</code> and <code class="literal">event</code> items),
          reformatted slightly for readability:
        </p><p>
          Auditing startup event:
        </p><pre class="programlisting">{ "timestamp": "2019-10-03 14:21:56",
  "id": 0,
  "class": "audit",
  "event": "startup",
  "connection_id": 0,
  "startup_data": { "server_id": 1,
                    "os_version": "i686-Linux",
                    "mysql_version": "5.7.21-log",
                    "args": ["/usr/local/mysql/bin/mysqld",
                             "--loose-audit-log-format=JSON",
                             "--log-error=log.err",
                             "--pid-file=mysqld.pid",
                             "--port=3306" ] } }
</pre><p>
          When the audit log plugin starts as a result of server startup
          (as opposed to being enabled at runtime),
          <code class="literal">connection_id</code> is set to 0, and
          <code class="literal">account</code> and <code class="literal">login</code> are
          not present.
        </p><p>
          Auditing shutdown event:
        </p><pre class="programlisting">{ "timestamp": "2019-10-03 14:28:20",
  "id": 3,
  "class": "audit",
  "event": "shutdown",
  "connection_id": 0,
  "shutdown_data": { "server_id": 1 } }
</pre><p>
          When the audit log plugin is uninstalled as a result of server
          shutdown (as opposed to being disabled at runtime),
          <code class="literal">connection_id</code> is set to 0, and
          <code class="literal">account</code> and <code class="literal">login</code> are
          not present.
        </p><p>
          Connect or change-user event:
        </p><pre class="programlisting">{ "timestamp": "2019-10-03 14:23:18",
  "id": 1,
  "class": "connection",
  "event": "connect",
  "connection_id": 5,
  "account": { "user": "root", "host": "localhost" },
  "login": { "user": "root", "os": "", "ip": "::1", "proxy": "" },
  "connection_data": { "connection_type": "ssl",
                       "status": 0,
                       "db": "test",
                       "connection_attributes": {
                         "_pid": "43236",
                         ...
                         "program_name": "mysqladmin"
                       } }
}
</pre><p>
          Disconnect event:
        </p><pre class="programlisting">{ "timestamp": "2019-10-03 14:24:45",
  "id": 3,
  "class": "connection",
  "event": "disconnect",
  "connection_id": 5,
  "account": { "user": "root", "host": "localhost" },
  "login": { "user": "root", "os": "", "ip": "::1", "proxy": "" },
  "connection_data": { "connection_type": "ssl" } }
</pre><p>
          Query event:
        </p><pre class="programlisting">{ "timestamp": "2019-10-03 14:23:35",
  "id": 2,
  "class": "general",
  "event": "status",
  "connection_id": 5,
  "account": { "user": "root", "host": "localhost" },
  "login": { "user": "root", "os": "", "ip": "::1", "proxy": "" },
  "general_data": { "command": "Query",
                    "sql_command": "show_variables",
                    "query": "SHOW VARIABLES",
                    "status": 0 } }
</pre><p>
          Query event with optional query statistics for outlier
          detection:
        </p><pre class="programlisting">{ "timestamp": "2022-01-28 13:09:30", 
  "id": 0, 
  "class": "general", 
  "event": "status", 
  "connection_id": 46, 
  "account": { "user": "user", "host": "localhost" }, 
  "login": { "user": "user", “os": "", “ip": "127.0.0.1", “proxy": "" }, 
  "general_data": { "command": "Query", 
                    "sql_command": "insert",
	            "query": "INSERT INTO audit_table VALUES(4)",
	            "status": 1146 }
  "query_statistics": { "query_time": 0.116250,
                        "bytes_sent": 18384,
                        "bytes_received": 78858,
                        "rows_sent": 3,
                        "rows_examined": 20878 } }
</pre><p>
          Table access event (read, delete, insert, update):
        </p><pre class="programlisting">{ "timestamp": "2019-10-03 14:23:41",
  "id": 0,
  "class": "table_access",
  "event": "insert",
  "connection_id": 5,
  "account": { "user": "root", "host": "localhost" },
  "login": { "user": "root", "os": "", "ip": "127.0.0.1", "proxy": "" },
  "table_access_data": { "db": "test",
                         "table": "t1",
                         "query": "INSERT INTO t1 (i) VALUES(1),(2),(3)",
                         "sql_command": "insert" } }
</pre><p>
          The items in the following list appear at the top level of
          JSON-format audit records: Each item value is either a scalar
          or a <a class="link" href="json.html" title="11.5 The JSON Data Type"><code class="literal">JSON</code></a> hash. For items that
          have a hash value, the description lists only the item names
          within that hash. For more complete descriptions of
          second-level hash items, see later in this section.
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">account</code>
            </p><p>
              The MySQL account associated with the event. The value is
              a hash containing these items equivalent to the value of
              the <a class="link" href="information-functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a> function
              within the section: <code class="literal">user</code>,
              <code class="literal">host</code>.
            </p><p>
              Example:
            </p><pre class="programlisting">"account": { "user": "root", "host": "localhost" }
</pre></li><li class="listitem"><p>
              <code class="literal">class</code>
            </p><p>
              A string representing the event class. The class defines
              the type of event, when taken together with the
              <code class="literal">event</code> item that specifies the event
              subclass.
            </p><p>
              Example:
            </p><pre class="programlisting">"class": "connection"
</pre><p>
              The following table shows the permitted combinations of
              <code class="literal">class</code> and <code class="literal">event</code>
              values.
            </p><div class="table"><a id="audit-log-class-event-combinations"></a><p class="title"><strong>Table 6.34 Audit Log Class and Event Combinations</strong></p><div class="table-contents"><table summary="Permitted combinations of audit log class and event values."><col style="width: 30%" /><col style="width: 40%" /><thead><tr>
                  <th>Class Value</th>
                  <th>Permitted Event Values</th>
                </tr></thead><tbody><tr>
                  <td><code class="literal">audit</code></td>
                  <td><code class="literal">startup</code>, <code class="literal">shutdown</code></td>
                </tr><tr>
                  <td><code class="literal">connection</code></td>
                  <td><code class="literal">connect</code>, <code class="literal">change_user</code>,
                    <code class="literal">disconnect</code></td>
                </tr><tr>
                  <td><code class="literal">general</code></td>
                  <td><code class="literal">status</code></td>
                </tr><tr>
                  <td><code class="literal">table_access_data</code></td>
                  <td><code class="literal">read</code>, <code class="literal">delete</code>,
                    <code class="literal">insert</code>, <code class="literal">update</code></td>
                </tr></tbody></table></div></div><br class="table-break" /></li><li class="listitem"><p>
              <code class="literal">connection_data</code>
            </p><p>
              Information about a client connection. The value is a hash
              containing these items:
              <code class="literal">connection_type</code>,
              <code class="literal">status</code>, <code class="literal">db</code>, and
              possibly <code class="literal">connection_attributes</code>. This
              item occurs only for audit records with a
              <code class="literal">class</code> value of
              <code class="literal">connection</code>.
            </p><p>
              Example:
            </p><pre class="programlisting">"connection_data": { "connection_type": "ssl",
                     "status": 0,
                     "db": "test" }
</pre><p>
              As of MySQL 8.0.19, events with a <code class="literal">class</code>
              value of <code class="literal">connection</code> and
              <code class="literal">event</code> value of
              <code class="literal">connect</code> may include a
              <code class="literal">connection_attributes</code> item to display
              the connection attributes passed by the client at connect
              time. (For information about these attributes, which are
              also exposed in Performance Schema tables, see
              <a class="xref" href="performance-schema-connection-attribute-tables.html" title="27.12.9 Performance Schema Connection Attribute Tables">Section 27.12.9, “Performance Schema Connection Attribute Tables”</a>.)
            </p><p>
              The <code class="literal">connection_attributes</code> value is a
              hash that represents each attribute by its name and value.
            </p><p>
              Example:
            </p><pre class="programlisting">"connection_attributes": {
  "_pid": "43236",
  "_os": "macos0.14",
  "_platform": "x86_64",
  "_client_version": "8.0.19",
  "_client_name": "libmysql",
  "program_name": "mysqladmin"
}
</pre><p>
              If no connection attributes are present in the event, none
              are logged and no <code class="literal">connection_attributes</code>
              item appears. This can occur if the connection attempt is
              unsuccessful, the client passes no attributes, or the
              connection occurs internally such as during server startup
              or when initiated by a plugin.
            </p></li><li class="listitem"><p>
              <code class="literal">connection_id</code>
            </p><p>
              An unsigned integer representing the client connection
              identifier. This is the same as the value returned by the
              <a class="link" href="information-functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a> function
              within the session.
            </p><p>
              Example:
            </p><pre class="programlisting">"connection_id": 5
</pre></li><li class="listitem"><p>
              <code class="literal">event</code>
            </p><p>
              A string representing the subclass of the event class. The
              subclass defines the type of event, when taken together
              with the <code class="literal">class</code> item that specifies the
              event class. For more information, see the
              <code class="literal">class</code> item description.
            </p><p>
              Example:
            </p><pre class="programlisting">"event": "connect"
</pre></li><li class="listitem"><p>
              <code class="literal">general_data</code>
            </p><p>
              Information about an executed statement or command. The
              value is a hash containing these items:
              <code class="literal">command</code>,
              <code class="literal">sql_command</code>, <code class="literal">query</code>,
              <code class="literal">status</code>. This item occurs only for audit
              records with a <code class="literal">class</code> value of
              <code class="literal">general</code>.
            </p><p>
              Example:
            </p><pre class="programlisting">"general_data": { "command": "Query",
                  "sql_command": "show_variables",
                  "query": "SHOW VARIABLES",
                  "status": 0 }
</pre></li><li class="listitem"><p>
              <code class="literal">id</code>
            </p><p>
              An unsigned integer representing an event ID.
            </p><p>
              Example:
            </p><pre class="programlisting">"id": 2
</pre><p>
              For audit records that have the same
              <code class="literal">timestamp</code> value, their
              <code class="literal">id</code> values distinguish them and form a
              sequence. Within the audit log,
              <code class="literal">timestamp</code>/<code class="literal">id</code> pairs
              are unique. These pairs are bookmarks that identify event
              locations within the log.
            </p></li><li class="listitem"><p>
              <code class="literal">login</code>
            </p><p>
              Information indicating how a client connected to the
              server. The value is a hash containing these items:
              <code class="literal">user</code>, <code class="literal">os</code>,
              <code class="literal">ip</code>, <code class="literal">proxy</code>.
            </p><p>
              Example:
            </p><pre class="programlisting">"login": { "user": "root", "os": "", "ip": "::1", "proxy": "" }
</pre></li><li class="listitem"><p>
              <code class="literal">query_statistics</code>
            </p><p>
              Optional query statistics for outlier detection. The value
              is a hash containing these items:
              <code class="literal">query_time</code>,
              <code class="literal">rows_sent</code>,
              <code class="literal">rows_examined</code>,
              <code class="literal">bytes_received</code>,
              <code class="literal">bytes_sent</code>. For instructions to set up
              the query statistics, see
              <a class="xref" href="audit-log-logging-configuration.html#audit-log-query-statistics" title="Adding Query Statistics for Outlier Detection">Adding Query Statistics for Outlier Detection</a>.
            </p><p>
              Example:
            </p><pre class="programlisting">"query_statistics": { "query_time": 0.116250,
                      "bytes_sent": 18384,
                      "bytes_received": 78858,
                      "rows_sent": 3,
                      "rows_examined": 20878 }
</pre></li><li class="listitem"><p>
              <code class="literal">shutdown_data</code>
            </p><p>
              Information pertaining to audit log plugin termination.
              The value is a hash containing these items:
              <code class="literal">server_id</code> This item occurs only for
              audit records with <code class="literal">class</code> and
              <code class="literal">event</code> values of
              <code class="literal">audit</code> and <code class="literal">shutdown</code>,
              respectively.
            </p><p>
              Example:
            </p><pre class="programlisting">"shutdown_data": { "server_id": 1 }
</pre></li><li class="listitem"><p>
              <code class="literal">startup_data</code>
            </p><p>
              Information pertaining to audit log plugin initialization.
              The value is a hash containing these items:
              <code class="literal">server_id</code>,
              <code class="literal">os_version</code>,
              <code class="literal">mysql_version</code>, <code class="literal">args</code>.
              This item occurs only for audit records with
              <code class="literal">class</code> and <code class="literal">event</code>
              values of <code class="literal">audit</code> and
              <code class="literal">startup</code>, respectively.
            </p><p>
              Example:
            </p><pre class="programlisting">"startup_data": { "server_id": 1,
                  "os_version": "i686-Linux",
                  "mysql_version": "5.7.21-log",
                  "args": ["/usr/local/mysql/bin/mysqld",
                           "--loose-audit-log-format=JSON",
                           "--log-error=log.err",
                           "--pid-file=mysqld.pid",
                           "--port=3306" ] }
</pre></li><li class="listitem"><p>
              <code class="literal">table_access_data</code>
            </p><p>
              Information about an access to a table. The value is a
              hash containing these items: <code class="literal">db</code>,
              <code class="literal">table</code>, <code class="literal">query</code>,
              <code class="literal">sql_command</code>, This item occurs only for
              audit records with a <code class="literal">class</code> value of
              <code class="literal">table_access</code>.
            </p><p>
              Example:
            </p><pre class="programlisting">"table_access_data": { "db": "test",
                       "table": "t1",
                       "query": "INSERT INTO t1 (i) VALUES(1),(2),(3)",
                       "sql_command": "insert" }
</pre></li><li class="listitem"><p>
              <code class="literal">time</code>
            </p><p>
              This field is similar to that in the
              <code class="literal">timestamp</code> field, but the value is an
              integer and represents the UNIX timestamp value indicating
              the date and time when the audit event was generated.
            </p><p>
              Example:
            </p><pre class="programlisting">"time" : 1618498687
</pre><p>
              The <code class="literal">time</code> field occurs in JSON-format
              log files only if the
              <a class="link" href="audit-log-reference.html#sysvar_audit_log_format_unix_timestamp"><code class="literal">audit_log_format_unix_timestamp</code></a>
              system variable is enabled.
            </p></li><li class="listitem"><p>
              <code class="literal">timestamp</code>
            </p><p>
              A string representing a UTC value in
              <em class="replaceable"><code>YYYY-MM-DD hh:mm:ss</code></em> format
              indicating the date and time when the audit event was
              generated. For example, the event corresponding to
              execution of an SQL statement received from a client has a
              <code class="literal">timestamp</code> value occurring after the
              statement finishes, not when it was received.
            </p><p>
              Example:
            </p><pre class="programlisting">"timestamp": "2019-10-03 13:50:01"
</pre><p>
              For audit records that have the same
              <code class="literal">timestamp</code> value, their
              <code class="literal">id</code> values distinguish them and form a
              sequence. Within the audit log,
              <code class="literal">timestamp</code>/<code class="literal">id</code> pairs
              are unique. These pairs are bookmarks that identify event
              locations within the log.
            </p></li></ul></div><p>
          These items appear within hash values associated with
          top-level items of JSON-format audit records:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">args</code>
            </p><p>
              An array of options that were given on the command line or
              in option files when the MySQL server was started. The
              first option is the path to the server executable.
            </p><p>
              Example:
            </p><pre class="programlisting">"args": ["/usr/local/mysql/bin/mysqld",
         "--loose-audit-log-format=JSON",
         "--log-error=log.err",
         "--pid-file=mysqld.pid",
         "--port=3306" ]
</pre></li><li class="listitem"><p>
              <code class="literal">bytes_received</code>
            </p><p>
              The number of bytes received from the client. This item is
              part of the optional query statistics. For this field to
              be populated, the system variable
              <a class="link" href="server-system-variables.html#sysvar_log_slow_extra"><code class="literal">log_slow_extra</code></a> must be
              set to <code class="literal">ON</code>.
            </p><p>
              Example:
            </p><pre class="programlisting">"bytes_received": 78858
</pre></li><li class="listitem"><p>
              <code class="literal">bytes_sent</code>
            </p><p>
              The number of bytes sent to the client. This item is part
              of the optional query statistics. For this field to be
              populated, the system variable
              <a class="link" href="server-system-variables.html#sysvar_log_slow_extra"><code class="literal">log_slow_extra</code></a> must be
              set to <code class="literal">ON</code>.
            </p><p>
              Example:
            </p><pre class="programlisting">"bytes_sent": 18384
</pre></li><li class="listitem"><p>
              <code class="literal">command</code>
            </p><p>
              A string representing the type of instruction that
              generated the audit event, such as a command that the
              server received from a client.
            </p><p>
              Example:
            </p><pre class="programlisting">"command": "Query"
</pre></li><li class="listitem"><p>
              <code class="literal">connection_type</code>
            </p><p>
              The security state of the connection to the server.
              Permitted values are <code class="literal">tcp/ip</code> (TCP/IP
              connection established without encryption),
              <code class="literal">ssl</code> (TCP/IP connection established with
              encryption), <code class="literal">socket</code> (Unix socket file
              connection), <code class="literal">named_pipe</code> (Windows named
              pipe connection), and <code class="literal">shared_memory</code>
              (Windows shared memory connection).
            </p><p>
              Example:
            </p><pre class="programlisting">"connection_type": "tcp/tcp"
</pre></li><li class="listitem"><p>
              <code class="literal">db</code>
            </p><p>
              A string representing a database name. For
              <code class="literal">connection_data</code>, it is the default
              database. For <code class="literal">table_access_data</code>, it is
              the table database.
            </p><p>
              Example:
            </p><pre class="programlisting">"db": "test"
</pre></li><li class="listitem"><p>
              <code class="literal">host</code>
            </p><p>
              A string representing the client host name.
            </p><p>
              Example:
            </p><pre class="programlisting">"host": "localhost"
</pre></li><li class="listitem"><p>
              <code class="literal">ip</code>
            </p><p>
              A string representing the client IP address.
            </p><p>
              Example:
            </p><pre class="programlisting">"ip": "::1"
</pre></li><li class="listitem"><p>
              <code class="literal">mysql_version</code>
            </p><p>
              A string representing the MySQL server version. This is
              the same as the value of the
              <a class="link" href="information-functions.html#function_version"><code class="literal">VERSION()</code></a> function or
              <a class="link" href="server-system-variables.html#sysvar_version"><code class="literal">version</code></a> system variable.
            </p><p>
              Example:
            </p><pre class="programlisting">"mysql_version": "5.7.21-log"
</pre></li><li class="listitem"><p>
              <code class="literal">os</code>
            </p><p>
              A string representing the external user name used during
              the authentication process, as set by the plugin used to
              authenticate the client. With native (built-in) MySQL
              authentication, or if the plugin does not set the value,
              this attribute is empty. The value is the same as that of
              the <a class="link" href="server-system-variables.html#sysvar_external_user"><code class="literal">external_user</code></a> system
              variable. See <a class="xref" href="proxy-users.html" title="6.2.19 Proxy Users">Section 6.2.19, “Proxy Users”</a>.
            </p><p>
              Example:
            </p><pre class="programlisting">"os": "jeffrey"
</pre></li><li class="listitem"><p>
              <code class="literal">os_version</code>
            </p><p>
              A string representing the operating system on which the
              server was built or is running.
            </p><p>
              Example:
            </p><pre class="programlisting">"os_version": "i686-Linux"
</pre></li><li class="listitem"><p>
              <code class="literal">proxy</code>
            </p><p>
              A string representing the proxy user (see
              <a class="xref" href="proxy-users.html" title="6.2.19 Proxy Users">Section 6.2.19, “Proxy Users”</a>). The value is empty if user
              proxying is not in effect.
            </p><p>
              Example:
            </p><pre class="programlisting">"proxy": "developer"
</pre></li><li class="listitem"><p>
              <code class="literal">query</code>
            </p><p>
              A string representing the text of an SQL statement. The
              value can be empty. Long values may be truncated. The
              string, like the audit log file itself, is written using
              UTF-8 (up to 4 bytes per character), so the value may be
              the result of conversion. For example, the original
              statement might have been received from the client as an
              SJIS string.
            </p><p>
              Example:
            </p><pre class="programlisting">"query": "DELETE FROM t1"
</pre></li><li class="listitem"><p>
              <code class="literal">query_time</code>
            </p><p>
              The query execution time in microseconds (if the
              <code class="literal">longlong</code> data type is selected) or
              seconds (if the <code class="literal">double</code> data type is
              selected). This item is part of the optional query
              statistics.
            </p><p>
              Example:
            </p><pre class="programlisting">"query_time": 0.116250
</pre></li><li class="listitem"><p>
              <code class="literal">rows_examined</code>
            </p><p>
              The number of rows accessed during the query. This item is
              part of the optional query statistics.
            </p><p>
              Example:
            </p><pre class="programlisting">"rows_examined": 20878</pre></li><li class="listitem"><p>
              <code class="literal">rows_sent</code>
            </p><p>
              The number of rows sent to the client as a result. This
              item is part of the optional query statistics.
            </p><p>
              Example:
            </p><pre class="programlisting">"rows_sent": 3
</pre></li><li class="listitem"><p>
              <code class="literal">server_id</code>
            </p><p>
              An unsigned integer representing the server ID. This is
              the same as the value of the
              <a class="link" href="replication-options.html#sysvar_server_id"><code class="literal">server_id</code></a> system
              variable.
            </p><p>
              Example:
            </p><pre class="programlisting">"server_id": 1
</pre></li><li class="listitem"><p>
              <code class="literal">sql_command</code>
            </p><p>
              A string that indicates the SQL statement type.
            </p><p>
              Example:
            </p><pre class="programlisting">"sql_command": "insert"
</pre><p>
              The values correspond to the
              <code class="literal">statement/sql/<em class="replaceable"><code>xxx</code></em></code>
              command counters. For example,
              <em class="replaceable"><code>xxx</code></em> is
              <code class="literal">drop_table</code> and
              <code class="literal">select</code> for <a class="link" href="drop-table.html" title="13.1.32 DROP TABLE Statement"><code class="literal">DROP
              TABLE</code></a> and <a class="link" href="select.html" title="13.2.13 SELECT Statement"><code class="literal">SELECT</code></a>
              statements, respectively. The following statement displays
              the possible names:
            </p><pre class="programlisting">SELECT REPLACE(EVENT_NAME, 'statement/sql/', '') AS name
FROM performance_schema.events_statements_summary_global_by_event_name
WHERE EVENT_NAME LIKE 'statement/sql/%'
ORDER BY name;
</pre></li><li class="listitem"><p>
              <code class="literal">status</code>
            </p><p>
              An unsigned integer representing the command status: 0 for
              success, nonzero if an error occurred. This is the same as
              the value of the
              <a class="ulink" href="https://docs.oracle.com/cd/E17952_01/c-api-8.0-en/mysql-errno.html" target="_top"><code class="literal">mysql_errno()</code></a> C API
              function.
            </p><p>
              The audit log does not contain the SQLSTATE value or error
              message. To see the associations between error codes,
              SQLSTATE values, and messages, see
              <a class="ulink" href="https://docs.oracle.com/cd/E17952_01/mysql-errors-8.0-en/server-error-reference.html" target="_top">Server Error Message Reference</a>.
            </p><p>
              Warnings are not logged.
            </p><p>
              Example:
            </p><pre class="programlisting">"status": 1051
</pre></li><li class="listitem"><p>
              <code class="literal">table</code>
            </p><p>
              A string representing a table name.
            </p><p>
              Example:
            </p><pre class="programlisting">"table": "t1"
</pre></li><li class="listitem"><p>
              <code class="literal">user</code>
            </p><p>
              A string representing a user name. The meaning differs
              depending on the item within which <code class="literal">user</code>
              occurs:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  Within <code class="literal">account</code> items,
                  <code class="literal">user</code> is a string representing the
                  user that the server authenticated the client as. This
                  is the user name that the server uses for privilege
                  checking.
                </p></li><li class="listitem"><p>
                  Within <code class="literal">login</code> items,
                  <code class="literal">user</code> is a string representing the
                  user name sent by the client.
                </p></li></ul></div><p>
              Example:
            </p><pre class="programlisting">"user": "root"
</pre></li></ul></div></div></div><div class="navigation"><ul><li class="navLinkPrevious"><a title="Go To Previous Page" href="audit-log-security.html">Previous <span class="navHint"> MySQL Enterprise Audit Security Considerations </span></a></li><li class="navLinkHome"><a title="Go To Home Page" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a title="Go Up A Level In The Navigation" href="audit-log.html">Up <span class="navHint"> MySQL Enterprise Audit </span></a></li><li class="navLinkNext"><a title="Go To Next Page" href="audit-log-logging-configuration.html">Next <span class="navHint"> Configuring Audit Logging Characteristics </span></a></li></ul></div><div class="dochomelink-footer"><a title="Go to MySQL Doc Library" href="https://docs.oracle.com/cd/E17952_01/index.html">
        MySQL Documentation Library
      </a></div><div class="copyright-footer"></div></body></html>