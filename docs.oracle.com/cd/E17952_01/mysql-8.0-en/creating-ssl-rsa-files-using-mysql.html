<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>6.3.3.1 Creating SSL and RSA Certificates and Keys using MySQL</title><link rel="stylesheet" type="text/css" href="mvl-otn.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="performance-schema" title="MySQL 8.0 Reference Manual" /><link rel="up" href="creating-ssl-rsa-files.html" title="6.3.3 Creating SSL and RSA Certificates and Keys" /><link rel="prev" href="creating-ssl-rsa-files.html" title="6.3.3 Creating SSL and RSA Certificates and Keys" /><link rel="next" href="creating-ssl-files-using-openssl.html" title="6.3.3.2 Creating SSL Certificates and Keys Using openssl" /><script>window.ohcglobal || document.write('<script src="../../../en/dcommon/js/global.js">\x3C/script>')</script></head><body><div class="skip-link"><a href="creating-ssl-rsa-files-using-mysql.html#creating-ssl-rsa-files-using-mysql">Skip to Main Content</a></div><div class="DocTitle"><p>MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0</p></div><div class="navigation"><ul><li class="navLinkPrevious"><a accesskey="p" title="Go To Previous Page [access key: p]" href="creating-ssl-rsa-files.html">Previous <span class="navHint"> Creating SSL and RSA Certificates and Keys </span></a></li><li class="navLinkHome"><a accesskey="h" title="Go To Home Page [access key: h]" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a accesskey="u" title="Go Up A Level In The Navigation [access key: u]" href="creating-ssl-rsa-files.html">Up <span class="navHint"> Creating SSL and RSA Certificates and Keys </span></a></li><li class="navLinkNext"><a accesskey="n" title="Go To Next Page [access key: n]" href="creating-ssl-files-using-openssl.html">Next <span class="navHint"> Creating SSL Certificates and Keys Using openssl </span></a></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="creating-ssl-rsa-files-using-mysql"></a>6.3.3.1 Creating SSL and RSA Certificates and Keys using MySQL</h4></div></div></div><p>
        MySQL provides these ways to create the SSL certificate and key
        files and RSA key-pair files required to support encrypted
        connections using SSL and secure password exchange using RSA
        over unencrypted connections, if those files are missing:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The server can autogenerate these files at startup, for
            MySQL distributions.
          </p></li><li class="listitem"><p>
            Users can invoke the <a class="link" href="mysql-ssl-rsa-setup.html" title="4.4.3 mysql_ssl_rsa_setup — Create SSL/RSA Files"><span class="command"><strong>mysql_ssl_rsa_setup</strong></span></a>
            utility manually (deprecated as of MySQL 8.0.34).
          </p></li><li class="listitem"><p>
            For some distribution types, such as RPM and DEB packages,
            <a class="link" href="mysql-ssl-rsa-setup.html" title="4.4.3 mysql_ssl_rsa_setup — Create SSL/RSA Files"><span class="command"><strong>mysql_ssl_rsa_setup</strong></span></a> invocation occurs
            during data directory initialization. In this case, the
            MySQL distribution need not have been compiled using OpenSSL
            as long as the <span class="command"><strong>openssl</strong></span> command is
            available.
          </p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Important</div><p>
          Server autogeneration and
          <a class="link" href="mysql-ssl-rsa-setup.html" title="4.4.3 mysql_ssl_rsa_setup — Create SSL/RSA Files"><span class="command"><strong>mysql_ssl_rsa_setup</strong></span></a> help lower the barrier
          to using SSL by making it easier to generate the required
          files. However, certificates generated by these methods are
          self-signed, which may not be very secure. After you gain
          experience using such files, consider obtaining
          certificate/key material from a registered certificate
          authority.
        </p></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Important</div><p>
          If a client connecting to a MySQL server instance uses an SSL
          certificate with the <code class="literal">extendedKeyUsage</code>
          extension (an X.509 v3 extension), the extended key usage must
          include client authentication (<code class="literal">clientAuth</code>).
          If the SSL certificate is only specified for server
          authentication (<code class="literal">serverAuth</code>) and other
          non-client certificate purposes, certificate verification
          fails and the client connection to the MySQL server instance
          fails. There is no <code class="literal">extendedKeyUsage</code>
          extension in SSL certificates generated by MySQL Server. If
          you use your own client certificate created in another way,
          ensure any <code class="literal">extendedKeyUsage</code> extension
          includes client authentication.
        </p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="creating-ssl-rsa-files-using-mysql.html#creating-ssl-rsa-files-using-mysql-automatic" title="Automatic SSL and RSA File Generation">Automatic SSL and RSA File Generation</a></p></li><li class="listitem"><p><a class="xref" href="creating-ssl-rsa-files-using-mysql.html#creating-ssl-rsa-files-using-mysql-manual-using-mysql-ssl-rsa-setup" title="Manual SSL and RSA File Generation Using mysql_ssl_rsa_setup">Manual SSL and RSA File Generation Using mysql_ssl_rsa_setup</a></p></li><li class="listitem"><p><a class="xref" href="creating-ssl-rsa-files-using-mysql.html#creating-ssl-rsa-files-using-mysql-ssl-and-rsa-file-characteristics" title="SSL and RSA File Characteristics">SSL and RSA File Characteristics</a></p></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a id="creating-ssl-rsa-files-using-mysql-automatic"></a>Automatic SSL and RSA File Generation</h5></div></div></div><p>
          For MySQL distributions compiled using OpenSSL, the MySQL
          server has the capability of automatically generating missing
          SSL and RSA files at startup. The
          <a class="link" href="server-system-variables.html#sysvar_auto_generate_certs"><code class="literal">auto_generate_certs</code></a>,
          <a class="link" href="server-system-variables.html#sysvar_sha256_password_auto_generate_rsa_keys"><code class="literal">sha256_password_auto_generate_rsa_keys</code></a>,
          and
          <a class="link" href="server-system-variables.html#sysvar_caching_sha2_password_auto_generate_rsa_keys"><code class="literal">caching_sha2_password_auto_generate_rsa_keys</code></a>
          system variables control automatic generation of these files.
          These variables are enabled by default. They can be enabled at
          startup and inspected but not set at runtime.
        </p><p>
          At startup, the server automatically generates server-side and
          client-side SSL certificate and key files in the data
          directory if the
          <a class="link" href="server-system-variables.html#sysvar_auto_generate_certs"><code class="literal">auto_generate_certs</code></a> system
          variable is enabled, no SSL options other than
          <a class="link" href="server-options.html#option_mysqld_ssl"><code class="option">--ssl</code></a> are specified, and the
          server-side SSL files are missing from the data directory.
          These files enable encrypted client connections using SSL; see
          <a class="xref" href="using-encrypted-connections.html" title="6.3.1 Configuring MySQL to Use Encrypted Connections">Section 6.3.1, “Configuring MySQL to Use Encrypted Connections”</a>.
        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
              The server checks the data directory for SSL files with
              the following names:
            </p><pre class="programlisting">ca.pem
server-cert.pem
server-key.pem
</pre></li><li class="listitem"><p>
              If any of those files are present, the server creates no
              SSL files. Otherwise, it creates them, plus some
              additional files:
            </p><pre class="programlisting">ca.pem               Self-signed CA certificate
ca-key.pem           CA private key
server-cert.pem      Server certificate
server-key.pem       Server private key
client-cert.pem      Client certificate
client-key.pem       Client private key
</pre></li><li class="listitem"><p>
              If the server autogenerates SSL files, it uses the names
              of the <code class="filename">ca.pem</code>,
              <code class="filename">server-cert.pem</code>, and
              <code class="filename">server-key.pem</code> files to set the
              corresponding system variables
              (<a class="link" href="server-system-variables.html#sysvar_ssl_ca"><code class="literal">ssl_ca</code></a>,
              <a class="link" href="server-system-variables.html#sysvar_ssl_cert"><code class="literal">ssl_cert</code></a>,
              <a class="link" href="server-system-variables.html#sysvar_ssl_key"><code class="literal">ssl_key</code></a>).
            </p></li></ol></div><p>
          At startup, the server automatically generates RSA
          private/public key-pair files in the data directory if all of
          these conditions are true: The
          <a class="link" href="server-system-variables.html#sysvar_sha256_password_auto_generate_rsa_keys"><code class="literal">sha256_password_auto_generate_rsa_keys</code></a>
          or
          <a class="link" href="server-system-variables.html#sysvar_caching_sha2_password_auto_generate_rsa_keys"><code class="literal">caching_sha2_password_auto_generate_rsa_keys</code></a>
          system variable is enabled; no RSA options are specified; the
          RSA files are missing from the data directory. These key-pair
          files enable secure password exchange using RSA over
          unencrypted connections for accounts authenticated by the
          <code class="literal">sha256_password</code> or
          <code class="literal">caching_sha2_password</code> plugin; see
          <a class="xref" href="sha256-pluggable-authentication.html" title="6.4.1.3 SHA-256 Pluggable Authentication">Section 6.4.1.3, “SHA-256 Pluggable Authentication”</a>, and
          <a class="xref" href="caching-sha2-pluggable-authentication.html" title="6.4.1.2 Caching SHA-2 Pluggable Authentication">Section 6.4.1.2, “Caching SHA-2 Pluggable Authentication”</a>.
        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
              The server checks the data directory for RSA files with
              the following names:
            </p><pre class="programlisting">private_key.pem      Private member of private/public key pair
public_key.pem       Public member of private/public key pair
</pre></li><li class="listitem"><p>
              If any of these files are present, the server creates no
              RSA files. Otherwise, it creates them.
            </p></li><li class="listitem"><p>
              If the server autogenerates the RSA files, it uses their
              names to set the corresponding system variables
              (<a class="link" href="server-system-variables.html#sysvar_sha256_password_private_key_path"><code class="literal">sha256_password_private_key_path</code></a>
              and
              <a class="link" href="server-system-variables.html#sysvar_sha256_password_public_key_path"><code class="literal">sha256_password_public_key_path</code></a>;
              <a class="link" href="server-system-variables.html#sysvar_caching_sha2_password_private_key_path"><code class="literal">caching_sha2_password_private_key_path</code></a>
              and
              <a class="link" href="server-system-variables.html#sysvar_caching_sha2_password_public_key_path"><code class="literal">caching_sha2_password_public_key_path</code></a>).
            </p></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a id="creating-ssl-rsa-files-using-mysql-manual-using-mysql-ssl-rsa-setup"></a>Manual SSL and RSA File Generation Using mysql_ssl_rsa_setup</h5></div></div></div><p>
          MySQL distributions include a
          <a class="link" href="mysql-ssl-rsa-setup.html" title="4.4.3 mysql_ssl_rsa_setup — Create SSL/RSA Files"><span class="command"><strong>mysql_ssl_rsa_setup</strong></span></a> utility (deprecated as
          of MySQL 8.0.34) that can be invoked manually to generate SSL
          and RSA files. This utility is included with all MySQL
          distributions, but it does require that the
          <span class="command"><strong>openssl</strong></span> command be available. For usage
          instructions, see <a class="xref" href="mysql-ssl-rsa-setup.html" title="4.4.3 mysql_ssl_rsa_setup — Create SSL/RSA Files">Section 4.4.3, “mysql_ssl_rsa_setup — Create SSL/RSA Files”</a>.
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h5 class="title"><a id="creating-ssl-rsa-files-using-mysql-ssl-and-rsa-file-characteristics"></a>SSL and RSA File Characteristics</h5></div></div></div><p>
          SSL and RSA files created automatically by the server or by
          invoking <a class="link" href="mysql-ssl-rsa-setup.html" title="4.4.3 mysql_ssl_rsa_setup — Create SSL/RSA Files"><span class="command"><strong>mysql_ssl_rsa_setup</strong></span></a> have these
          characteristics:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              SSL and RSA keys are have a size of 2048 bits.
            </p></li><li class="listitem"><p>
              The SSL CA certificate is self signed.
            </p></li><li class="listitem"><p>
              The SSL server and client certificates are signed with the
              CA certificate and key, using the
              <code class="literal">sha256WithRSAEncryption</code> signature
              algorithm.
            </p></li><li class="listitem"><p>
              SSL certificates use these Common Name (CN) values, with
              the appropriate certificate type (CA, Server, Client):
            </p><pre class="programlisting">ca.pem:         MySQL_Server_<em class="replaceable"><code>suffix</code></em>_Auto_Generated_CA_Certificate
server-cert.pm: MySQL_Server_<em class="replaceable"><code>suffix</code></em>_Auto_Generated_Server_Certificate
client-cert.pm: MySQL_Server_<em class="replaceable"><code>suffix</code></em>_Auto_Generated_Client_Certificate
</pre><p>
              The <em class="replaceable"><code>suffix</code></em> value is based on
              the MySQL version number. For files generated by
              <a class="link" href="mysql-ssl-rsa-setup.html" title="4.4.3 mysql_ssl_rsa_setup — Create SSL/RSA Files"><span class="command"><strong>mysql_ssl_rsa_setup</strong></span></a>, the suffix can be
              specified explicitly using the
              <a class="link" href="mysql-ssl-rsa-setup.html#option_mysql_ssl_rsa_setup_suffix"><code class="option">--suffix</code></a>
              option.
            </p><p>
              For files generated by the server, if the resulting CN
              values exceed 64 characters, the
              <code class="literal">_<em class="replaceable"><code>suffix</code></em></code>
              portion of the name is omitted.
            </p></li><li class="listitem"><p>
              SSL files have blank values for Country (C), State or
              Province (ST), Organization (O), Organization Unit Name
              (OU) and email address.
            </p></li><li class="listitem"><p>
              SSL files created by the server or by
              <a class="link" href="mysql-ssl-rsa-setup.html" title="4.4.3 mysql_ssl_rsa_setup — Create SSL/RSA Files"><span class="command"><strong>mysql_ssl_rsa_setup</strong></span></a> are valid for ten
              years from the time of generation.
            </p></li><li class="listitem"><p>
              RSA files do not expire.
            </p></li><li class="listitem"><p>
              SSL files have different serial numbers for each
              certificate/key pair (1 for CA, 2 for Server, 3 for
              Client).
            </p></li><li class="listitem"><p>
              Files created automatically by the server are owned by the
              account that runs the server. Files created using
              <a class="link" href="mysql-ssl-rsa-setup.html" title="4.4.3 mysql_ssl_rsa_setup — Create SSL/RSA Files"><span class="command"><strong>mysql_ssl_rsa_setup</strong></span></a> are owned by the
              user who invoked that program. This can be changed on
              systems that support the <code class="literal">chown()</code> system
              call if the program is invoked by <code class="literal">root</code>
              and the <a class="link" href="mysql-ssl-rsa-setup.html#option_mysql_ssl_rsa_setup_uid"><code class="option">--uid</code></a>
              option is given to specify the user who should own the
              files.
            </p></li><li class="listitem"><p>
              On Unix and Unix-like systems, the file access mode is 644
              for certificate files (that is, world readable) and 600
              for key files (that is, accessible only by the account
              that runs the server).
            </p></li></ul></div><p>
          To see the contents of an SSL certificate (for example, to
          check the range of dates over which it is valid), invoke
          <span class="command"><strong>openssl</strong></span> directly:
        </p><pre class="programlisting">openssl x509 -text -in ca.pem
openssl x509 -text -in server-cert.pem
openssl x509 -text -in client-cert.pem
</pre><p>
          It is also possible to check SSL certificate expiration
          information using this SQL statement:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'Ssl_server_not%';</code></strong>
+-----------------------+--------------------------+
| Variable_name         | Value                    |
+-----------------------+--------------------------+
| Ssl_server_not_after  | Apr 28 14:16:39 2027 GMT |
| Ssl_server_not_before | May  1 14:16:39 2017 GMT |
+-----------------------+--------------------------+
</pre></div></div><div class="navigation"><ul><li class="navLinkPrevious"><a title="Go To Previous Page" href="creating-ssl-rsa-files.html">Previous <span class="navHint"> Creating SSL and RSA Certificates and Keys </span></a></li><li class="navLinkHome"><a title="Go To Home Page" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a title="Go Up A Level In The Navigation" href="creating-ssl-rsa-files.html">Up <span class="navHint"> Creating SSL and RSA Certificates and Keys </span></a></li><li class="navLinkNext"><a title="Go To Next Page" href="creating-ssl-files-using-openssl.html">Next <span class="navHint"> Creating SSL Certificates and Keys Using openssl </span></a></li></ul></div><div class="dochomelink-footer"><a title="Go to MySQL Doc Library" href="https://docs.oracle.com/cd/E17952_01/index.html">
        MySQL Documentation Library
      </a></div><div class="copyright-footer"></div></body></html>