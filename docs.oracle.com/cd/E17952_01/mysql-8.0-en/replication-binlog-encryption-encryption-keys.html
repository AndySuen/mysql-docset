<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>17.3.2.2 Binary Log Encryption Keys</title><link rel="stylesheet" type="text/css" href="mvl-otn.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="performance-schema" title="MySQL 8.0 Reference Manual" /><link rel="up" href="replication-binlog-encryption.html" title="17.3.2 Encrypting Binary Log Files and Relay Log Files" /><link rel="prev" href="replication-binlog-encryption-scope.html" title="17.3.2.1 Scope of Binary Log Encryption" /><link rel="next" href="replication-binlog-encryption-key-rotation.html" title="17.3.2.3 Binary Log Master Key Rotation" /><script>window.ohcglobal || document.write('<script src="../../../en/dcommon/js/global.js">\x3C/script>')</script></head><body><div class="skip-link"><a href="replication-binlog-encryption-encryption-keys.html#replication-binlog-encryption-encryption-keys">Skip to Main Content</a></div><div class="DocTitle"><p>MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0</p></div><div class="navigation"><ul><li class="navLinkPrevious"><a accesskey="p" title="Go To Previous Page [access key: p]" href="replication-binlog-encryption-scope.html">Previous <span class="navHint"> Scope of Binary Log Encryption </span></a></li><li class="navLinkHome"><a accesskey="h" title="Go To Home Page [access key: h]" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a accesskey="u" title="Go Up A Level In The Navigation [access key: u]" href="replication-binlog-encryption.html">Up <span class="navHint"> Encrypting Binary Log Files and Relay Log Files </span></a></li><li class="navLinkNext"><a accesskey="n" title="Go To Next Page [access key: n]" href="replication-binlog-encryption-key-rotation.html">Next <span class="navHint"> Binary Log Master Key Rotation </span></a></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="replication-binlog-encryption-encryption-keys"></a>17.3.2.2 Binary Log Encryption Keys</h4></div></div></div><p>
        The binary log encryption keys used to encrypt the file
        passwords for the log files are 256-bit keys that are generated
        specifically for each MySQL server instance using MySQL Server's
        keyring service (see <a class="xref" href="keyring.html" title="6.4.4 The MySQL Keyring">Section 6.4.4, “The MySQL Keyring”</a>). The keyring
        service handles the creation, retrieval, and deletion of the
        binary log encryption keys. A server instance only creates and
        removes keys generated for itself, but it can read keys
        generated for other instances if they are stored in the keyring,
        as in the case of a server instance that has been cloned by file
        copying.
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Important</div><p>
          The binary log encryption keys for a MySQL server instance
          must be included in your backup and recovery procedures,
          because if the keys required to decrypt the file passwords for
          current and retained binary log files or relay log files are
          lost, it might not be possible to start the server.
        </p></div><p>
        The format of binary log encryption keys in the keyring is as
        follows:
      </p><pre class="programlisting">MySQLReplicationKey_{UUID}_{SEQ_NO}</pre><p>
        For example:
      </p><pre class="programlisting">MySQLReplicationKey_00508583-b5ce-11e8-a6a5-0010e0734796_1 </pre><p>
        <code class="literal">{UUID}</code> is the true UUID generated by the
        MySQL server (the value of the
        <a class="link" href="replication-options.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a> system variable).
        <code class="literal">{SEQ_NO}</code> is the sequence number for the
        binary log encryption key, which is incremented by 1 for each
        new key that is generated on the server.
      </p><p>
        The binary log encryption key that is currently in use on the
        server is called the binary log master key. The sequence number
        for the current binary log master key is stored in the keyring.
        The binary log master key is used to encrypt each new log file's
        file password, which is a randomly generated 32-byte file
        password specific to the log file that is used to encrypt the
        file data. The file password is encrypted using AES-CBC (AES
        Cipher Block Chaining mode) with the 256-bit binary log
        encryption key and a random initialization vector (IV), and is
        stored in the log file's file header. The file data is encrypted
        using AES-CTR (AES Counter mode) with a 256-bit key generated
        from the file password and a nonce also generated from the file
        password. It is technically possible to decrypt an encrypted
        file offline, if the binary log encryption key used to encrypt
        the file password is known, by using tools available in the
        OpenSSL cryptography toolkit.
      </p><p>
        If you use file copying to clone a MySQL server instance that
        has encryption active so its binary log files and relay log
        files are encrypted, ensure that the keyring is also copied, so
        that the clone server can read the binary log encryption keys
        from the source server. When encryption is activated on the
        clone server (either at startup or subsequently), the clone
        server recognizes that the binary log encryption keys used with
        the copied files include the generated UUID of the source
        server. It automatically generates a new binary log encryption
        key using its own generated UUID, and uses this to encrypt the
        file passwords for subsequent binary log files and relay log
        files. The copied files continue to be read using the source
        server's keys.
      </p></div><div class="navigation"><ul><li class="navLinkPrevious"><a title="Go To Previous Page" href="replication-binlog-encryption-scope.html">Previous <span class="navHint"> Scope of Binary Log Encryption </span></a></li><li class="navLinkHome"><a title="Go To Home Page" href="performance-schema">Home <span class="navHint"> MySQL 8.0 Reference Manual Including MySQL NDB Cluster 8.0 </span></a></li><li class="navLinkUp"><a title="Go Up A Level In The Navigation" href="replication-binlog-encryption.html">Up <span class="navHint"> Encrypting Binary Log Files and Relay Log Files </span></a></li><li class="navLinkNext"><a title="Go To Next Page" href="replication-binlog-encryption-key-rotation.html">Next <span class="navHint"> Binary Log Master Key Rotation </span></a></li></ul></div><div class="dochomelink-footer"><a title="Go to MySQL Doc Library" href="https://docs.oracle.com/cd/E17952_01/index.html">
        MySQL Documentation Library
      </a></div><div class="copyright-footer"></div></body></html>